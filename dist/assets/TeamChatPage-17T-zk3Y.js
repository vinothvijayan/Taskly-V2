import{c as xt,r as o,bv as Jt,bw as Js,j as e,b3 as Zt,bx as Zs,by as ea,br as ue,b4 as X,bz as ta,bA as sa,bB as aa,bC as na,bD as ra,bE as oa,bF as ia,bG as la,bH as ca,bI as da,bJ as ua,bK as ma,bL as ha,D as M,am as es,bp as ts,aS as fa,W as ss,Y as as,Z as xa,_ as pa,B as k,a2 as lt,v as we,X as ns,a1 as ga,Q as ct,S as ve,f as ba,bM as wa,bN as va,b1 as me,bO as ja,bP as rs,bQ as Na,bR as ya,aU as Ca,aV as dt,A as je,aL as Ne,q as ye,bS as Sa,a7 as ka,aM as Ra,bT as Ma,a8 as Ia,V as Pa,bU as _a,bV as Mt,bW as Aa,bX as Ea,bY as Da,aa as Z,ag as It,bZ as tt,al as Pt,U as _t,w as At,L as ee,M as st,p as Et,aP as Dt,y as Tt,z as $t,E as Lt,b_ as Te,b$ as Ut,ab as te,c0 as $e,ac as Le,bk as Ue,bl as ze,c1 as Oe,c2 as Be,c3 as at,ak as zt,c4 as nt,c5 as rt,c6 as ot,c7 as it,ad as Fe,c8 as Ot,c9 as Ta}from"./index-CIyudF9t.js";import{T as Bt}from"./textarea-D92HBPlJ.js";import{u as Ft,a as $a}from"./useTouchGestures-Ch9nyX4t.js";import{D as La}from"./download-oltLK3aY.js";import{A as Ua}from"./index-FV4twmxk.js";import{C as za}from"./chevron-left-D9T-5X23.js";import{S as Vt}from"./smile-CA1EGhCs.js";import{C as Gt}from"./copy-Bj6ngxQ0.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Kt=xt("image",Oa);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],Ht=xt("paperclip",Ba);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]],Yt=xt("reply",Fa);var pt="ContextMenu",[Va]=Zt(pt,[Jt]),O=Jt(),[Ga,os]=Va(pt),is=s=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:l,modal:x=!0}=s,[d,f]=o.useState(!1),b=O(t),j=Js(r),v=o.useCallback(u=>{f(u),j(u)},[j]);return e.jsx(Ga,{scope:t,open:d,onOpenChange:v,modal:x,children:e.jsx(Zs,{...b,dir:l,open:d,onOpenChange:v,modal:x,children:n})})};is.displayName=pt;var ls="ContextMenuTrigger",cs=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...l}=s,x=os(ls,n),d=O(n),f=o.useRef({x:0,y:0}),b=o.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...f.current})}),j=o.useRef(0),v=o.useCallback(()=>window.clearTimeout(j.current),[]),u=p=>{f.current={x:p.clientX,y:p.clientY},x.onOpenChange(!0)};return o.useEffect(()=>v,[v]),o.useEffect(()=>void(r&&v()),[r,v]),e.jsxs(e.Fragment,{children:[e.jsx(ea,{...d,virtualRef:b}),e.jsx(ue.span,{"data-state":x.open?"open":"closed","data-disabled":r?"":void 0,...l,ref:t,style:{WebkitTouchCallout:"none",...s.style},onContextMenu:r?s.onContextMenu:X(s.onContextMenu,p=>{v(),u(p),p.preventDefault()}),onPointerDown:r?s.onPointerDown:X(s.onPointerDown,Ve(p=>{v(),j.current=window.setTimeout(()=>u(p),700)})),onPointerMove:r?s.onPointerMove:X(s.onPointerMove,Ve(v)),onPointerCancel:r?s.onPointerCancel:X(s.onPointerCancel,Ve(v)),onPointerUp:r?s.onPointerUp:X(s.onPointerUp,Ve(v))})]})});cs.displayName=ls;var Ka="ContextMenuPortal",ds=s=>{const{__scopeContextMenu:t,...n}=s,r=O(t);return e.jsx(ta,{...r,...n})};ds.displayName=Ka;var us="ContextMenuContent",ms=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,...r}=s,l=os(us,n),x=O(n),d=o.useRef(!1);return e.jsx(sa,{...x,...r,ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:f=>{var b;(b=s.onCloseAutoFocus)==null||b.call(s,f),!f.defaultPrevented&&d.current&&f.preventDefault(),d.current=!1},onInteractOutside:f=>{var b;(b=s.onInteractOutside)==null||b.call(s,f),!f.defaultPrevented&&!l.modal&&(d.current=!0)},style:{...s.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});ms.displayName=us;var Ha="ContextMenuGroup",Ya=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,...r}=s,l=O(n);return e.jsx(na,{...l,...r,ref:t})});Ya.displayName=Ha;var Wa="ContextMenuLabel",hs=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,...r}=s,l=O(n);return e.jsx(ra,{...l,...r,ref:t})});hs.displayName=Wa;var Xa="ContextMenuItem",fs=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,...r}=s,l=O(n);return e.jsx(aa,{...l,...r,ref:t})});fs.displayName=Xa;var qa="ContextMenuCheckboxItem",xs=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,...r}=s,l=O(n);return e.jsx(oa,{...l,...r,ref:t})});xs.displayName=qa;var Qa="ContextMenuRadioGroup",Ja=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,...r}=s,l=O(n);return e.jsx(ia,{...l,...r,ref:t})});Ja.displayName=Qa;var Za="ContextMenuRadioItem",ps=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,...r}=s,l=O(n);return e.jsx(la,{...l,...r,ref:t})});ps.displayName=Za;var en="ContextMenuItemIndicator",gs=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,...r}=s,l=O(n);return e.jsx(ca,{...l,...r,ref:t})});gs.displayName=en;var tn="ContextMenuSeparator",bs=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,...r}=s,l=O(n);return e.jsx(da,{...l,...r,ref:t})});bs.displayName=tn;var sn="ContextMenuArrow",an=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,...r}=s,l=O(n);return e.jsx(ua,{...l,...r,ref:t})});an.displayName=sn;var nn="ContextMenuSubTrigger",ws=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,...r}=s,l=O(n);return e.jsx(ma,{...l,...r,ref:t})});ws.displayName=nn;var rn="ContextMenuSubContent",vs=o.forwardRef((s,t)=>{const{__scopeContextMenu:n,...r}=s,l=O(n);return e.jsx(ha,{...l,...r,ref:t,style:{...s.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});vs.displayName=rn;function Ve(s){return t=>t.pointerType!=="mouse"?s(t):void 0}var on=is,ln=cs,cn=ds,js=ms,Ns=hs,ys=fs,Cs=xs,Ss=ps,ks=gs,Rs=bs,Ms=ws,Is=vs;const Wt=on,Xt=ln,dn=o.forwardRef(({className:s,inset:t,children:n,...r},l)=>e.jsxs(Ms,{ref:l,className:M("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t&&"pl-8",s),...r,children:[n,e.jsx(es,{className:"ml-auto h-4 w-4"})]}));dn.displayName=Ms.displayName;const un=o.forwardRef(({className:s,...t},n)=>e.jsx(Is,{ref:n,className:M("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t}));un.displayName=Is.displayName;const ut=o.forwardRef(({className:s,...t},n)=>e.jsx(cn,{children:e.jsx(js,{ref:n,className:M("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...t})}));ut.displayName=js.displayName;const ie=o.forwardRef(({className:s,inset:t,...n},r)=>e.jsx(ys,{ref:r,className:M("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",s),...n}));ie.displayName=ys.displayName;const mn=o.forwardRef(({className:s,children:t,checked:n,...r},l)=>e.jsxs(Cs,{ref:l,className:M("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:n,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ks,{children:e.jsx(ts,{className:"h-4 w-4"})})}),t]}));mn.displayName=Cs.displayName;const hn=o.forwardRef(({className:s,children:t,...n},r)=>e.jsxs(Ss,{ref:r,className:M("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ks,{children:e.jsx(fa,{className:"h-2 w-2 fill-current"})})}),t]}));hn.displayName=Ss.displayName;const fn=o.forwardRef(({className:s,inset:t,...n},r)=>e.jsx(Ns,{ref:r,className:M("px-2 py-1.5 text-sm font-semibold text-foreground",t&&"pl-8",s),...n}));fn.displayName=Ns.displayName;const xn=o.forwardRef(({className:s,...t},n)=>e.jsx(Rs,{ref:n,className:M("-mx-1 my-1 h-px bg-border",s),...t}));xn.displayName=Rs.displayName;function pn({open:s,onOpenChange:t,files:n,onSend:r}){const[l,x]=o.useState(""),[d,f]=o.useState([]),[b,j]=o.useState([]),[v,u]=o.useState(0),p=o.useRef(null);o.useEffect(()=>{if(s&&n.length>0){f(n);const h=n.map(C=>URL.createObjectURL(C));j(h),u(0)}return()=>{b.forEach(h=>URL.revokeObjectURL(h))}},[s,n]);const D=()=>{d.length!==0&&(r(d,l),t(!1))},m=h=>{h||(x(""),f([]),j(C=>(C.forEach(S=>URL.revokeObjectURL(S)),[])),u(0)),t(h)},A=h=>{URL.revokeObjectURL(b[h]);const C=d.filter((I,$)=>$!==h),S=b.filter((I,$)=>$!==h);f(C),j(S),C.length===0?t(!1):v>=h&&u(Math.max(0,v-1))},w=h=>{const C=h.target.files?Array.from(h.target.files):[];if(C.length>0){const S=[...d,...C],I=C.map($=>URL.createObjectURL($));f(S),j($=>[...$,...I])}h.target&&(h.target.value="")};return e.jsx(ss,{open:s,onOpenChange:m,children:e.jsxs(as,{className:"sm:max-w-2xl p-0 bg-muted dark:bg-background flex flex-col h-[90vh] max-h-[700px] gap-0",children:[e.jsx(xa,{className:"p-4 bg-background dark:bg-muted/50 flex-shrink-0",children:e.jsxs(pa,{children:["Send Image",d.length>1&&"s"]})}),e.jsx("div",{className:"flex-1 flex items-center justify-center bg-black/80 p-4 relative overflow-hidden",children:b[v]&&e.jsx("img",{src:b[v],alt:"Preview",className:"max-h-full max-w-full rounded-lg object-contain"})}),e.jsxs("div",{className:"p-4 bg-background dark:bg-muted/50 space-y-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",ref:p,onChange:w,accept:"image/*",multiple:!0,className:"hidden"}),e.jsx(k,{variant:"outline",size:"icon",className:"h-16 w-16 flex-shrink-0",onClick:()=>{var h;return(h=p.current)==null?void 0:h.click()},children:e.jsx(lt,{className:"h-6 w-6"})}),e.jsxs(we,{className:"whitespace-nowrap",children:[e.jsx("div",{className:"flex gap-2 pb-2",children:b.map((h,C)=>e.jsxs("div",{className:"relative h-16 w-16 flex-shrink-0 cursor-pointer group",onClick:()=>u(C),children:[e.jsx("img",{src:h,alt:`Thumbnail ${C+1}`,className:M("h-full w-full object-cover rounded-md border-2 transition-all",v===C?"border-primary":"border-transparent group-hover:border-muted-foreground/50")}),e.jsx(k,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 rounded-full",onClick:S=>{S.stopPropagation(),A(C)},children:e.jsx(ns,{className:"h-3 w-3"})})]},C))}),e.jsx(ga,{orientation:"horizontal"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{placeholder:"Add a caption...",value:l,onChange:h=>x(h.target.value),className:"flex-1 bg-muted dark:bg-background border-border h-10"}),e.jsx(k,{onClick:D,disabled:d.length===0,size:"icon",className:"h-10 w-10 bg-[#25D366] hover:bg-[#20B358] text-white flex-shrink-0 rounded-full",children:e.jsx(ve,{className:"h-4 w-4"})})]})]})]})})}const gn={enter:s=>({x:s>0?"100%":"-100%",opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:s=>({zIndex:0,x:s<0?"100%":"-100%",opacity:0})};function bn({open:s,onOpenChange:t,images:n,startIndex:r=0}){const[l,x]=o.useState(r),[d,f]=o.useState(0);o.useEffect(()=>{s&&x(r)},[s,r]);const b=u=>{f(u),u>0?x(p=>(p+1)%n.length):x(p=>(p-1+n.length)%n.length)},j=()=>{const u=n[l];if(u!=null&&u.url){const p=document.createElement("a");p.href=u.url,p.download=`image_${l+1}.png`,document.body.appendChild(p),p.click(),document.body.removeChild(p)}},v=n[l];return e.jsx(ss,{open:s,onOpenChange:t,children:e.jsxs(as,{className:"p-0 bg-black/80 border-0 max-w-[95vw] max-h-[95vh] h-full w-full flex flex-col gap-0 backdrop-blur-sm [&>button]:hidden",children:[e.jsxs("header",{className:"absolute top-0 left-0 right-0 z-10 flex items-center justify-between p-4 bg-gradient-to-b from-black/50 to-transparent",children:[e.jsxs("div",{className:"text-white font-medium",children:[l+1," / ",n.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{variant:"ghost",size:"icon",className:"text-white hover:bg-white/20",onClick:j,children:e.jsx(La,{className:"h-5 w-5"})}),e.jsx(k,{variant:"ghost",size:"icon",className:"text-white hover:bg-white/20",onClick:()=>t(!1),children:e.jsx(ns,{className:"h-6 w-6"})})]})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center relative overflow-hidden",children:e.jsx(Ua,{initial:!1,custom:d,children:e.jsx(ba.img,{src:v==null?void 0:v.url,alt:`Image ${l+1}`,className:"absolute max-h-full max-w-full object-contain",custom:d,variants:gn,initial:"enter",animate:"center",exit:"exit",transition:{x:{type:"tween",ease:"easeInOut",duration:.4},opacity:{duration:.3}}},l)})}),n.length>1&&e.jsxs("div",{children:[e.jsx(k,{variant:"ghost",size:"icon",className:"absolute left-4 top-1/2 -translate-y-1/2 text-white bg-black/30 hover:bg-black/50 h-10 w-10",onClick:()=>b(-1),children:e.jsx(za,{className:"h-6 w-6"})}),e.jsx(k,{variant:"ghost",size:"icon",className:"absolute right-4 top-1/2 -translate-y-1/2 text-white bg-black/30 hover:bg-black/50 h-10 w-10",onClick:()=>b(1),children:e.jsx(es,{className:"h-6 w-6"})})]}),n.length>1&&e.jsx("footer",{className:"absolute bottom-0 left-0 right-0 z-10 p-4 flex justify-center bg-gradient-to-t from-black/50 to-transparent",children:e.jsx("div",{className:"flex gap-2 p-2 bg-black/30 rounded-lg",children:n.map((u,p)=>e.jsx("div",{className:M("h-14 w-14 rounded-md cursor-pointer border-2 transition-all",l===p?"border-primary":"border-transparent hover:border-white/50"),onClick:()=>x(p),children:e.jsx("img",{src:u.url,alt:`Thumbnail ${p+1}`,className:"h-full w-full object-cover rounded"})},u.id||p))})})]})})}var Ps=["PageUp","PageDown"],_s=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],As={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},he="Slider",[mt,wn,vn]=va(he),[Es]=Zt(he,[vn]),[jn,Ge]=Es(he),Ds=o.forwardRef((s,t)=>{const{name:n,min:r=0,max:l=100,step:x=1,orientation:d="horizontal",disabled:f=!1,minStepsBetweenThumbs:b=0,defaultValue:j=[r],value:v,onValueChange:u=()=>{},onValueCommit:p=()=>{},inverted:D=!1,form:m,...A}=s,w=o.useRef(new Set),h=o.useRef(0),S=d==="horizontal"?Nn:yn,[I=[],$]=wa({prop:v,defaultProp:j,onChange:L=>{var oe;(oe=[...w.current][h.current])==null||oe.focus(),u(L)}}),G=o.useRef(I);function re(L){const se=Mn(I,L);K(L,se)}function Ke(L){K(L,h.current)}function Ce(){const L=G.current[h.current];I[h.current]!==L&&p(I)}function K(L,se,{commit:oe}={commit:!1}){const fe=An(x),le=En(Math.round((L-r)/x)*x+r,fe),ae=rs(le,[r,l]);$((q=[])=>{const Q=kn(q,ae,se);if(_n(Q,b*x)){h.current=Q.indexOf(ae);const xe=String(Q)!==String(q);return xe&&oe&&p(Q),xe?Q:q}else return q})}return e.jsx(jn,{scope:s.__scopeSlider,name:n,disabled:f,min:r,max:l,valueIndexToChangeRef:h,thumbs:w.current,values:I,orientation:d,form:m,children:e.jsx(mt.Provider,{scope:s.__scopeSlider,children:e.jsx(mt.Slot,{scope:s.__scopeSlider,children:e.jsx(S,{"aria-disabled":f,"data-disabled":f?"":void 0,...A,ref:t,onPointerDown:X(A.onPointerDown,()=>{f||(G.current=I)}),min:r,max:l,inverted:D,onSlideStart:f?void 0:re,onSlideMove:f?void 0:Ke,onSlideEnd:f?void 0:Ce,onHomeKeyDown:()=>!f&&K(r,0,{commit:!0}),onEndKeyDown:()=>!f&&K(l,I.length-1,{commit:!0}),onStepKeyDown:({event:L,direction:se})=>{if(!f){const le=Ps.includes(L.key)||L.shiftKey&&_s.includes(L.key)?10:1,ae=h.current,q=I[ae],Q=x*le*se;K(q+Q,ae,{commit:!0})}}})})})})});Ds.displayName=he;var[Ts,$s]=Es(he,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Nn=o.forwardRef((s,t)=>{const{min:n,max:r,dir:l,inverted:x,onSlideStart:d,onSlideMove:f,onSlideEnd:b,onStepKeyDown:j,...v}=s,[u,p]=o.useState(null),D=me(t,S=>p(S)),m=o.useRef(void 0),A=ja(l),w=A==="ltr",h=w&&!x||!w&&x;function C(S){const I=m.current||u.getBoundingClientRect(),$=[0,I.width],re=gt($,h?[n,r]:[r,n]);return m.current=I,re(S-I.left)}return e.jsx(Ts,{scope:s.__scopeSlider,startEdge:h?"left":"right",endEdge:h?"right":"left",direction:h?1:-1,size:"width",children:e.jsx(Ls,{dir:A,"data-orientation":"horizontal",...v,ref:D,style:{...v.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const I=C(S.clientX);d==null||d(I)},onSlideMove:S=>{const I=C(S.clientX);f==null||f(I)},onSlideEnd:()=>{m.current=void 0,b==null||b()},onStepKeyDown:S=>{const $=As[h?"from-left":"from-right"].includes(S.key);j==null||j({event:S,direction:$?-1:1})}})})}),yn=o.forwardRef((s,t)=>{const{min:n,max:r,inverted:l,onSlideStart:x,onSlideMove:d,onSlideEnd:f,onStepKeyDown:b,...j}=s,v=o.useRef(null),u=me(t,v),p=o.useRef(void 0),D=!l;function m(A){const w=p.current||v.current.getBoundingClientRect(),h=[0,w.height],S=gt(h,D?[r,n]:[n,r]);return p.current=w,S(A-w.top)}return e.jsx(Ts,{scope:s.__scopeSlider,startEdge:D?"bottom":"top",endEdge:D?"top":"bottom",size:"height",direction:D?1:-1,children:e.jsx(Ls,{"data-orientation":"vertical",...j,ref:u,style:{...j.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:A=>{const w=m(A.clientY);x==null||x(w)},onSlideMove:A=>{const w=m(A.clientY);d==null||d(w)},onSlideEnd:()=>{p.current=void 0,f==null||f()},onStepKeyDown:A=>{const h=As[D?"from-bottom":"from-top"].includes(A.key);b==null||b({event:A,direction:h?-1:1})}})})}),Ls=o.forwardRef((s,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:l,onSlideEnd:x,onHomeKeyDown:d,onEndKeyDown:f,onStepKeyDown:b,...j}=s,v=Ge(he,n);return e.jsx(ue.span,{...j,ref:t,onKeyDown:X(s.onKeyDown,u=>{u.key==="Home"?(d(u),u.preventDefault()):u.key==="End"?(f(u),u.preventDefault()):Ps.concat(_s).includes(u.key)&&(b(u),u.preventDefault())}),onPointerDown:X(s.onPointerDown,u=>{const p=u.target;p.setPointerCapture(u.pointerId),u.preventDefault(),v.thumbs.has(p)?p.focus():r(u)}),onPointerMove:X(s.onPointerMove,u=>{u.target.hasPointerCapture(u.pointerId)&&l(u)}),onPointerUp:X(s.onPointerUp,u=>{const p=u.target;p.hasPointerCapture(u.pointerId)&&(p.releasePointerCapture(u.pointerId),x(u))})})}),Us="SliderTrack",zs=o.forwardRef((s,t)=>{const{__scopeSlider:n,...r}=s,l=Ge(Us,n);return e.jsx(ue.span,{"data-disabled":l.disabled?"":void 0,"data-orientation":l.orientation,...r,ref:t})});zs.displayName=Us;var ht="SliderRange",Os=o.forwardRef((s,t)=>{const{__scopeSlider:n,...r}=s,l=Ge(ht,n),x=$s(ht,n),d=o.useRef(null),f=me(t,d),b=l.values.length,j=l.values.map(p=>Vs(p,l.min,l.max)),v=b>1?Math.min(...j):0,u=100-Math.max(...j);return e.jsx(ue.span,{"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,...r,ref:f,style:{...s.style,[x.startEdge]:v+"%",[x.endEdge]:u+"%"}})});Os.displayName=ht;var ft="SliderThumb",Bs=o.forwardRef((s,t)=>{const n=wn(s.__scopeSlider),[r,l]=o.useState(null),x=me(t,f=>l(f)),d=o.useMemo(()=>r?n().findIndex(f=>f.ref.current===r):-1,[n,r]);return e.jsx(Cn,{...s,ref:x,index:d})}),Cn=o.forwardRef((s,t)=>{const{__scopeSlider:n,index:r,name:l,...x}=s,d=Ge(ft,n),f=$s(ft,n),[b,j]=o.useState(null),v=me(t,C=>j(C)),u=b?d.form||!!b.closest("form"):!0,p=Na(b),D=d.values[r],m=D===void 0?0:Vs(D,d.min,d.max),A=Rn(r,d.values.length),w=p==null?void 0:p[f.size],h=w?In(w,m,f.direction):0;return o.useEffect(()=>{if(b)return d.thumbs.add(b),()=>{d.thumbs.delete(b)}},[b,d.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[f.startEdge]:`calc(${m}% + ${h}px)`},children:[e.jsx(mt.ItemSlot,{scope:s.__scopeSlider,children:e.jsx(ue.span,{role:"slider","aria-label":s["aria-label"]||A,"aria-valuemin":d.min,"aria-valuenow":D,"aria-valuemax":d.max,"aria-orientation":d.orientation,"data-orientation":d.orientation,"data-disabled":d.disabled?"":void 0,tabIndex:d.disabled?void 0:0,...x,ref:v,style:D===void 0?{display:"none"}:s.style,onFocus:X(s.onFocus,()=>{d.valueIndexToChangeRef.current=r})})}),u&&e.jsx(Fs,{name:l??(d.name?d.name+(d.values.length>1?"[]":""):void 0),form:d.form,value:D},r)]})});Bs.displayName=ft;var Sn="RadioBubbleInput",Fs=o.forwardRef(({__scopeSlider:s,value:t,...n},r)=>{const l=o.useRef(null),x=me(l,r),d=ya(t);return o.useEffect(()=>{const f=l.current;if(!f)return;const b=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(b,"value").set;if(d!==t&&v){const u=new Event("input",{bubbles:!0});v.call(f,t),f.dispatchEvent(u)}},[d,t]),e.jsx(ue.input,{style:{display:"none"},...n,ref:x,defaultValue:t})});Fs.displayName=Sn;function kn(s=[],t,n){const r=[...s];return r[n]=t,r.sort((l,x)=>l-x)}function Vs(s,t,n){const x=100/(n-t)*(s-t);return rs(x,[0,100])}function Rn(s,t){return t>2?`Value ${s+1} of ${t}`:t===2?["Minimum","Maximum"][s]:void 0}function Mn(s,t){if(s.length===1)return 0;const n=s.map(l=>Math.abs(l-t)),r=Math.min(...n);return n.indexOf(r)}function In(s,t,n){const r=s/2,x=gt([0,50],[0,r]);return(r-x(t)*n)*n}function Pn(s){return s.slice(0,-1).map((t,n)=>s[n+1]-t)}function _n(s,t){if(t>0){const n=Pn(s);return Math.min(...n)>=t}return!0}function gt(s,t){return n=>{if(s[0]===s[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(s[1]-s[0]);return t[0]+r*(n-s[0])}}function An(s){return(String(s).split(".")[1]||"").length}function En(s,t){const n=Math.pow(10,t);return Math.round(s*n)/n}var Gs=Ds,Dn=zs,Tn=Os,$n=Bs;const Ks=o.forwardRef(({className:s,...t},n)=>e.jsxs(Gs,{ref:n,className:M("relative flex w-full touch-none select-none items-center",s),...t,children:[e.jsx(Dn,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(Tn,{className:"absolute h-full bg-primary"})}),e.jsx($n,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Ks.displayName=Gs.displayName;const Ln=s=>{if(isNaN(s)||s===1/0)return"0:00";const t=Math.floor(s/60),n=Math.floor(s%60);return`${t}:${n.toString().padStart(2,"0")}`};function qt({attachment:s,isMyMessage:t,senderAvatar:n,senderName:r}){const l=o.useRef(null),[x,d]=o.useState(!1),[f,b]=o.useState(0),[j,v]=o.useState(s.duration||0),[u,p]=o.useState(0),D=w=>w?w.split(" ").map(h=>h[0]).join("").toUpperCase():"";o.useEffect(()=>{const w=l.current;if(!w)return;const h=()=>{w.duration&&w.duration!==1/0&&(p(w.currentTime),b(w.currentTime/w.duration*100))},C=()=>{w.duration!==1/0&&v(w.duration)},S=()=>{d(!1),b(0)};return w.addEventListener("timeupdate",h),w.addEventListener("loadedmetadata",C),w.addEventListener("ended",S),()=>{w.removeEventListener("timeupdate",h),w.removeEventListener("loadedmetadata",C),w.removeEventListener("ended",S)}},[]);const m=w=>{w.stopPropagation();const h=l.current;h&&(x?h.pause():h.play().catch(C=>console.error("Audio play failed:",C)),d(!x))},A=w=>{const h=l.current;if(h&&j){const C=w[0]/100*j;h.currentTime=C}};return e.jsxs("div",{className:"flex items-center gap-2 w-[250px] sm:w-[280px]",children:[e.jsx("audio",{ref:l,src:s.url,preload:"metadata"}),e.jsx(k,{variant:"ghost",size:"icon",className:M("h-10 w-10 rounded-full flex-shrink-0",t?"bg-green-200/50 hover:bg-green-300/50":"bg-gray-200 hover:bg-gray-300","dark:bg-white/10 dark:hover:bg-white/20"),onClick:m,children:x?e.jsx(Ca,{className:"h-5 w-5"}):e.jsx(dt,{className:"h-5 w-5 ml-0.5"})}),e.jsxs("div",{className:"flex-1 flex flex-col gap-1.5",children:[e.jsx(Ks,{value:[f],onValueChange:A,max:100,step:1,className:"w-full [&>span:first-child]:h-1 [&>span:first-child>span]:h-1"}),e.jsx("span",{className:"text-xs font-mono text-muted-foreground self-end",children:Ln(j)})]}),!t&&e.jsxs(je,{className:"h-10 w-10 flex-shrink-0 ml-2",children:[e.jsx(Ne,{src:n}),e.jsx(ye,{children:D(r)})]})]})}const Qt=(s,t=2)=>{if(s===0)return"0 Bytes";const n=1024,r=t<0?0:t,l=["Bytes","KB","MB","GB","TB"],x=Math.floor(Math.log(s)/Math.log(n));return parseFloat((s/Math.pow(n,x)).toFixed(r))+" "+l[x]};function Hn(){const s=Sa(),{user:t,userProfile:n}=ka(),{teamMembers:r,addTask:l}=Ra(),{onlineStatus:x,markChatAsRead:d,markMessagesAsReadBatch:f,unreadCounts:b}=Ma(),{toast:j}=Ia(),v=Pa(),{setChatOpenMobile:u,setOpen:p}=_a(),{impact:D}=$a(),[m,A]=o.useState(null),[w,h]=o.useState([]),[C,S]=o.useState(""),[I,$]=o.useState(!1),[G,re]=o.useState(!1),[Ke,Ce]=o.useState(!1),[K,L]=o.useState(""),[se,oe]=o.useState({}),[fe,le]=o.useState([]),[ae,q]=o.useState({open:!1,images:[],startIndex:0}),[Q,xe]=o.useState(!1),[pe,He]=o.useState(0),[ce,bt]=o.useState(null),wt=o.useRef(null),Ye=o.useRef(null),We=o.useRef(null),Xe=o.useRef(null),Se=o.useRef(null),ke=o.useRef(!0),H=o.useRef(null),qe=o.useRef(null),Qe=o.useRef(null);o.useEffect(()=>{p&&(window.innerWidth>=768?p(!1):p(!0))},[p]),o.useEffect(()=>{if(H.current){H.current.style.height="auto";const a=120,c=H.current.scrollHeight;H.current.style.height=`${Math.min(c,a)}px`,c>a?H.current.style.overflowY="auto":H.current.style.overflowY="hidden"}},[C]),o.useEffect(()=>{var a;(a=We.current)==null||a.scrollIntoView({behavior:"smooth"})},[w]),o.useEffect(()=>(m&&t&&Hs(m.uid),()=>{if(Xe.current)try{Mt(Xe.current)}catch(a){console.warn(a)}if(Se.current)try{Mt(Se.current)}catch(a){console.warn(a)}}),[m,t]),o.useEffect(()=>{m&&H.current&&H.current.focus()},[m]);const ne=(a,c)=>[a,c].sort().join("_"),Hs=a=>{if(!t)return;$(!0);const c=ne(t.uid,a),i=Aa(Z(te,`chats/${c}/messages`),Da("timestamp"),Ea(50));Xe.current=i,It(i,g=>{if(!ke.current)return;const E=g.val();if(E){const T=Object.entries(E).map(([N,P])=>({id:N,...P}));T.sort((N,P)=>N.timestamp-P.timestamp),h(T),vt(a);const R=T.map(N=>N.id);f(c,R).catch(N=>console.warn(N))}else h([]),vt(a);$(!1)},g=>{console.error("Error listening to chat messages:",g),ke.current&&(j({title:"Chat connection error",variant:"destructive"}),$(!1))})},vt=a=>{if(!t)return;const c=ne(t.uid,a);Se.current=Z(te,`messageStatus/${c}`),It(Se.current,i=>{if(!ke.current)return;const g=i.val(),E={};g&&Object.entries(g).forEach(([T,R])=>{R&&R[a]&&(E[T]=!0)}),oe(E)})},Je=async()=>{if(!C.trim()||!m||!t||!n)return;const a=C.trim();S(""),re(!0);try{const c=ne(t.uid,m.uid),i=Z(te,`chats/${c}/messages`),g={senderId:t.uid,senderName:n.displayName||t.email||"Unknown",senderEmail:t.email||"",senderAvatar:n.photoURL,message:a,timestamp:$e(),type:"text"};await Le(i,g);const E=Ue(ze,`chatRooms/${c}`);await Oe(E,{participants:[t.uid,m.uid],lastActivity:Be(),lastMessage:g},{merge:!0}),t.uid!==m.uid&&at.addInAppNotification(m.uid,`New message from ${g.senderName}`,g.message.substring(0,50),"chat",{chatRoomId:c,senderId:t.uid,senderName:g.senderName}).catch(T=>console.warn(T))}catch(c){console.error("Error sending message:",c),S(a),j({title:"Failed to send message",variant:"destructive"})}finally{re(!1)}},Ys=async(a,c)=>{if(!t||!m||!n||a.length===0)return;const i=ne(t.uid,m.uid),g=Z(te,`chats/${i}/messages`),E=a.map(_=>({id:`temp-${_.name}-${Date.now()}`,type:_.type.startsWith("image/")?"image":"video",url:"",previewUrl:URL.createObjectURL(_),status:"uploading"})),T={senderId:t.uid,senderName:n.displayName||t.email||"Unknown",senderEmail:t.email||"",senderAvatar:n.photoURL,message:c,timestamp:$e(),type:"media",attachments:E},R=Le(g),N=R.key;if(!N){console.error("Failed to get message key");return}await zt(R,T);const P=a.map(async(_,B)=>{try{const z=Date.now(),F=`chat_attachments/${i}/${z}_${_.name}`,y=nt(rt,F),V=await ot(y,_),Y=await it(V.ref),J=`chats/${i}/messages/${N}/attachments/${B}`;return await Fe(Z(te),{[`${J}/url`]:Y,[`${J}/status`]:"sent",[`${J}/previewUrl`]:null}),{success:!0}}catch(z){console.error("Error uploading attachment:",z);const F=`chats/${i}/messages/${N}/attachments/${B}`;return await Fe(Z(te),{[`${F}/status`]:"failed"}),{success:!1}}});await Promise.all(P);const U=Ue(ze,`chatRooms/${i}`);if(await Oe(U,{participants:[t.uid,m.uid],lastActivity:Be(),lastMessage:{...T,message:c||`📷 ${a.length} Media File(s)`}},{merge:!0}),t.uid!==m.uid){const _=c?`Sent ${a.length} media file(s): ${c}`:`Sent ${a.length} media file(s)`;at.addInAppNotification(m.uid,`New message from ${n.displayName||t.email||"Unknown"}`,_,"chat",{chatRoomId:i,senderId:t.uid,senderName:n.displayName||t.email||"Unknown"}).catch(B=>console.warn(B))}},Ws=async(a,c)=>{if(!t||!m||!n||a.length===0)return;const i=ne(t.uid,m.uid),g=Z(te,`chats/${i}/messages`),E=a.map(_=>({id:`temp-${_.name}-${Date.now()}`,type:"document",url:"",fileName:_.name,fileSize:_.size,fileType:_.type,status:"uploading"})),T={senderId:t.uid,senderName:n.displayName||t.email||"Unknown",senderEmail:t.email||"",senderAvatar:n.photoURL,message:c,timestamp:$e(),type:"media",attachments:E},R=Le(g),N=R.key;if(!N){console.error("Failed to get message key");return}await zt(R,T);const P=a.map(async(_,B)=>{try{const z=Date.now(),F=`chat_attachments/${i}/${z}_${_.name}`,y=nt(rt,F),V=await ot(y,_),Y=await it(V.ref),J=`chats/${i}/messages/${N}/attachments/${B}`;return await Fe(Z(te),{[`${J}/url`]:Y,[`${J}/status`]:"sent"}),{success:!0}}catch(z){console.error("Error uploading document:",z);const F=`chats/${i}/messages/${N}/attachments/${B}`;return await Fe(Z(te),{[`${F}/status`]:"failed"}),{success:!1}}});await Promise.all(P);const U=Ue(ze,`chatRooms/${i}`);if(await Oe(U,{participants:[t.uid,m.uid],lastActivity:Be(),lastMessage:{...T,message:`📄 ${a.length} Document(s)`}},{merge:!0}),t.uid!==m.uid){const _=`Sent ${a.length} document(s)`;at.addInAppNotification(m.uid,`New message from ${n.displayName||t.email||"Unknown"}`,_,"chat",{chatRoomId:i,senderId:t.uid,senderName:n.displayName||t.email||"Unknown"}).catch(B=>console.warn(B))}},Xs=a=>{const c=a.target.files?Array.from(a.target.files):[];c.length>0&&le(c),a.target&&(a.target.value="")},qs=a=>{const c=a.target.files?Array.from(a.target.files):[];c.length>0&&Ws(c,""),a.target&&(a.target.value="")},jt=a=>{!v&&a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),Je())},Re=a=>a.senderId!==(t==null?void 0:t.uid)?null:se[a.id]?e.jsx(Ta,{className:"h-3 w-3 text-sky-500"}):e.jsx(ts,{className:"h-3 w-3 text-muted-foreground/70"}),Me=a=>new Date(a).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),Ie=(a,c)=>a!=null&&a.trim()?a.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2):(c==null?void 0:c.split("@")[0].slice(0,2).toUpperCase())||"U",Pe=a=>{const c=Math.floor((Date.now()-a)/6e4);if(c<1)return"Just now";if(c<60)return`${c}m ago`;const i=Math.floor(c/60);return i<24?`${i}h ago`:`${Math.floor(i/24)}d ago`},_e=a=>{var c;return((c=x[a])==null?void 0:c.online)||!1},Ae=a=>{var c;return((c=x[a])==null?void 0:c.lastSeen)||Date.now()},Ee=()=>{const a=[];let c="";return w.forEach((i,g)=>{var R,N,P,U;const E=new Date(i.timestamp).toDateString();if(E!==c){c=E;const _=new Date().toDateString(),B=new Date(Date.now()-864e5).toDateString();let z=new Date(i.timestamp).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"});E===_?z="Today":E===B&&(z="Yesterday"),a.push({type:"date",data:z})}const T=i.senderId===((R=w[g-1])==null?void 0:R.senderId)&&i.timestamp-((N=w[g-1])==null?void 0:N.timestamp)<3e5;a.push({type:"message",data:{...i,isFirstInGroup:!T,isLastInGroup:g===w.length-1||((P=w[g+1])==null?void 0:P.senderId)!==i.senderId||((U=w[g+1])==null?void 0:U.timestamp)-i.timestamp>=3e5}})}),a},De=o.useMemo(()=>{const a=n?{...n,isSelf:!0}:null,c=r.filter(i=>{var g;return i.uid!==(t==null?void 0:t.uid)&&(((g=i.displayName)==null?void 0:g.toLowerCase().includes(K.toLowerCase()))||i.email.toLowerCase().includes(K.toLowerCase()))});return a&&!K?[a,...c]:c},[r,t,n,K]),Nt=a=>{if(A(a),Ce(!0),u(!0),t){const c=ne(t.uid,a.uid);d(c)}},Qs=()=>{Ce(!1),A(null),u(!1)},de=async a=>{try{D("light");const c={title:a.message.substring(0,50)+(a.message.length>50?"...":""),description:`Created from chat message by ${a.senderName}:

"${a.message}"`,priority:"medium",status:"todo",assignedTo:[]};await l(c),j({title:"Task created! 📝"})}catch(c){console.error("Error creating task from message:",c),j({title:"Error creating task",variant:"destructive"})}},yt=a=>navigator.clipboard.writeText(a.message).then(()=>j({title:"Copied"})).catch(()=>j({title:"Error",variant:"destructive"})),Ct=a=>{var c;S(`@${a.senderName}: "${a.message.substring(0,30)}..."

`),(c=H.current)==null||c.focus()};o.useEffect(()=>()=>{ke.current=!1},[]);const St=async()=>{try{const a=await navigator.mediaDevices.getUserMedia({audio:!0}),c=new MediaRecorder(a);wt.current=c;const i=[];c.ondataavailable=g=>i.push(g.data),c.onstop=()=>{const g=new Blob(i,{type:"audio/webm"});bt(g)},c.start(),xe(!0),He(0),Ye.current=setInterval(()=>{He(g=>g+1)},1e3)}catch{j({title:"Microphone access denied",variant:"destructive"})}},kt=()=>{var a;(a=wt.current)==null||a.stop(),Ye.current&&clearInterval(Ye.current),xe(!1)},Ze=()=>{bt(null),He(0)},Rt=async()=>{if(!(!ce||!t||!m||!n)){re(!0);try{const a=ne(t.uid,m.uid),c=Date.now(),i=`chat_attachments/${a}/${c}_voice_message.webm`,g=nt(rt,i),E=await ot(g,ce),T=await it(E.ref),R={id:`audio-${c}`,type:"audio",url:T,fileName:"Voice Message",fileSize:ce.size,fileType:ce.type,duration:pe},N={senderId:t.uid,senderName:n.displayName||t.email||"Unknown",senderEmail:t.email||"",senderAvatar:n.photoURL,message:"",timestamp:$e(),type:"media",attachments:[R]},P=Z(te,`chats/${a}/messages`);await Le(P,N);const U=Ue(ze,`chatRooms/${a}`);await Oe(U,{participants:[t.uid,m.uid],lastActivity:Be(),lastMessage:{...N,message:"🎤 Voice Message"}},{merge:!0}),Ze()}catch(a){console.error("Error sending voice message:",a),j({title:"Failed to send voice message",variant:"destructive"})}finally{re(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",ref:qe,onChange:Xs,accept:"image/*,video/*",multiple:!0,className:"hidden"}),e.jsx("input",{type:"file",ref:Qe,onChange:qs,accept:"*/*",multiple:!0,className:"hidden"}),e.jsx(pn,{open:fe.length>0,onOpenChange:a=>{a||le([])},files:fe,onSend:Ys}),e.jsx(bn,{open:ae.open,onOpenChange:a=>q(c=>({...c,open:a})),images:ae.images,startIndex:ae.startIndex}),e.jsx("div",{className:"h-full w-full bg-background flex overflow-hidden min-h-0",children:v?e.jsx(e.Fragment,{children:Ke?m&&e.jsxs("div",{className:"flex-1 flex flex-col w-full min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"bg-card px-4 py-3 flex items-center gap-3 shadow-sm z-20 border-b",children:[e.jsx(k,{variant:"ghost",size:"icon",onClick:Qs,className:"text-foreground hover:bg-accent -ml-2",children:e.jsx(tt,{className:"h-5 w-5"})}),e.jsxs(je,{className:"h-10 w-10",children:[e.jsx(Ne,{src:m.photoURL||""}),e.jsx(ye,{className:"bg-primary/10 text-primary font-semibold",children:Ie(m.displayName,m.email)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold",children:m.uid===(t==null?void 0:t.uid)?"Message yourself":m.displayName||"Team Member"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m.uid===(t==null?void 0:t.uid)?"Personal notes":_e(m.uid)?"Online":`Last seen ${Pe(Ae(m.uid))}`})]})]}),e.jsx("div",{className:"flex-1 whatsapp-wallpaper overflow-hidden",children:e.jsx(we,{className:"h-full",children:e.jsxs("div",{className:"p-4 space-y-1 pb-16",children:[I?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(ee,{className:"h-8 w-8 animate-spin text-primary"})}):Ee().length===0?e.jsxs("div",{className:"text-center py-16 text-muted-foreground",children:[e.jsx(st,{className:"h-16 w-16 mx-auto mb-6 opacity-30"}),e.jsx("p",{className:"text-base",children:"Start a conversation"})]}):Ee().map((a,c)=>{if(a.type==="date")return e.jsx("div",{className:"flex justify-center my-6",children:e.jsx("div",{className:"bg-background/90 dark:bg-muted/90 text-xs px-4 py-2 rounded-full text-muted-foreground shadow-sm",children:a.data})},`date-${c}`);const i=a.data,g=i.senderId===(t==null?void 0:t.uid),E=()=>{const T=Ft({onSwipeRight:g?void 0:()=>de(i),onSwipeLeft:g?()=>de(i):void 0},{threshold:80,velocityThreshold:.2}),R=i.attachments||[],N=R.length,P=i.type==="media"&&N>0,U=i.message&&i.message.trim().length>0,_=()=>{if(N===1&&R[0].type==="audio")return e.jsx(qt,{attachment:R[0],isMyMessage:g,senderAvatar:i.senderAvatar,senderName:i.senderName});const z=R.slice(0,4),F=N-4;return e.jsx("div",{className:M("grid gap-1",N===1&&"grid-cols-1",N===2&&"grid-cols-2",N===3&&"grid-cols-2 grid-rows-2",N>=4&&"grid-cols-2 grid-rows-2"),children:z.map((y,V)=>{if(y.type==="document")return e.jsx("div",{className:"col-span-2",children:e.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-black/10 dark:bg-black/20 rounded-lg hover:bg-black/20 dark:hover:bg-black/30 transition-colors",children:[y.status==="uploading"?e.jsx(ee,{className:"h-8 w-8 animate-spin text-muted-foreground flex-shrink-0"}):e.jsx(Te,{className:"h-8 w-8 text-primary flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold truncate text-sm",children:y.fileName}),e.jsx("p",{className:"text-xs text-muted-foreground",children:y.fileSize?Qt(y.fileSize):""})]})]})},y.id||V);const Y=V===3&&F>0,J=N===3&&V===0?"row-span-2 h-full":"aspect-square",et=y.status==="uploading"?y.previewUrl:y.url;return e.jsxs("div",{className:M("relative bg-black/20",J),onClick:()=>{if(y.status==="sent"&&y.url){const ge=R.filter(W=>W.status==="sent"&&W.url&&W.type==="image"),be=ge.findIndex(W=>W.id===y.id);q({open:!0,images:ge,startIndex:be>=0?be:0})}},children:[e.jsx("img",{src:et,alt:"Attachment",className:M("w-full h-full object-cover",y.status==="uploading"&&"opacity-50")}),Y&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsxs("span",{className:"text-white text-2xl font-bold",children:["+",F]})}),y.status==="uploading"&&!Y&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:e.jsx(ee,{className:"h-6 w-6 animate-spin text-white"})}),y.status==="failed"&&!Y&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/50 text-white p-2 text-center",children:[e.jsx(Ot,{className:"h-6 w-6 text-destructive mb-1"}),e.jsx("p",{className:"text-xs font-semibold",children:"Upload Failed"})]})]},y.id||V)})})};return e.jsxs(Wt,{children:[e.jsx(Xt,{children:e.jsx("div",{ref:T,className:M("max-w-[320px] text-sm break-words shadow-sm cursor-pointer relative",g?"bg-[#DCF8C6] text-black dark:bg-emerald-900/50 dark:text-white":"bg-white text-black dark:bg-muted dark:text-foreground",P?"p-1.5 rounded-xl":"px-3 py-2",i.isFirstInGroup&&i.isLastInGroup?"rounded-lg":i.isFirstInGroup?g?"rounded-t-lg rounded-bl-lg rounded-br-md":"rounded-t-lg rounded-br-lg rounded-bl-md":i.isLastInGroup?g?"rounded-b-lg rounded-tl-lg rounded-tr-md":"rounded-b-lg rounded-tr-lg rounded-tl-md":g?"rounded-l-lg rounded-tr-md rounded-br-md":"rounded-r-lg rounded-tl-md rounded-bl-md"),children:e.jsxs("div",{className:"flex flex-col",children:[P&&_(),(U||!P)&&e.jsxs("div",{className:M("relative",P&&U&&"px-2 pt-2 pb-0.5"),children:[e.jsx("p",{className:"break-words leading-relaxed whitespace-pre-wrap",children:i.message}),e.jsxs("div",{className:"flex items-center gap-1 text-xs opacity-70 whitespace-nowrap mt-1 w-full justify-end",children:[e.jsx("span",{children:Me(i.timestamp)}),g&&Re(i)]})]}),P&&!U&&e.jsxs("div",{className:"flex items-center gap-1 text-xs opacity-70 whitespace-nowrap mt-1 w-full justify-end",children:[e.jsx("span",{children:Me(i.timestamp)}),g&&Re(i)]})]})})}),e.jsxs(ut,{className:"w-48 bg-background border shadow-lg z-50",children:[e.jsxs(ie,{onClick:()=>de(i),children:[e.jsx(lt,{className:"mr-2 h-4 w-4"}),"Create Task"]}),e.jsxs(ie,{onClick:()=>yt(i),children:[e.jsx(Gt,{className:"mr-2 h-4 w-4"}),"Copy Message"]}),e.jsxs(ie,{onClick:()=>Ct(i),children:[e.jsx(Yt,{className:"mr-2 h-4 w-4"}),"Reply"]})]})]})};return e.jsx("div",{className:M("flex mb-1",g?"justify-end":"justify-start"),children:e.jsx(E,{})},i.id)}),e.jsx("div",{ref:We})]})})}),e.jsx("div",{className:"bg-background border-t px-2 py-2 shadow-lg z-10",children:ce?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{variant:"ghost",size:"icon",className:"rounded-full h-10 w-10 flex-shrink-0",onClick:Ze,children:e.jsx(Et,{className:"h-5 w-5 text-destructive"})}),e.jsxs("div",{className:"flex-1 bg-muted/50 rounded-full flex items-center px-4 h-10",children:[e.jsx(dt,{className:"h-5 w-5 mr-2"}),e.jsx("span",{className:"font-mono text-sm",children:new Date(pe*1e3).toISOString().substr(14,5)})]}),e.jsx(k,{onClick:Rt,disabled:G,size:"icon",className:"rounded-full bg-[#25D366] hover:bg-[#20B358] text-white shadow-md h-10 w-10 flex-shrink-0",children:G?e.jsx(ee,{className:"h-4 w-4 animate-spin"}):e.jsx(ve,{className:"h-4 w-4"})})]}):Q?e.jsxs("div",{className:"flex items-center gap-2 h-10",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),e.jsx("span",{className:"font-mono text-sm",children:new Date(pe*1e3).toISOString().substr(14,5)}),e.jsx("div",{className:"flex-1"}),e.jsx(k,{onClick:kt,size:"icon",className:"rounded-full bg-destructive hover:bg-destructive/90 text-white shadow-md h-10 w-10 flex-shrink-0",children:e.jsx(Dt,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("div",{className:"flex-1 flex items-center bg-muted/50 rounded-full p-1",children:[e.jsx(k,{variant:"ghost",size:"icon",className:"rounded-full h-9 w-9 flex-shrink-0",children:e.jsx(Vt,{className:"h-5 w-5 text-muted-foreground"})}),e.jsx(Bt,{value:C,onChange:a=>S(a.target.value),onKeyDown:jt,ref:H,placeholder:"Type a message",autoFocus:!0,rows:1,className:"flex-1 border-0 bg-transparent resize-none focus-visible:ring-0 focus-visible:ring-offset-0 py-1.5 px-2 text-base min-h-0"}),e.jsxs(Tt,{children:[e.jsx($t,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",className:"rounded-full h-9 w-9 flex-shrink-0",children:e.jsx(Ht,{className:"h-5 w-5 text-muted-foreground"})})}),e.jsx(Lt,{className:"w-48 p-2 mb-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs(k,{variant:"ghost",className:"w-full justify-start",onClick:()=>{var a;return(a=qe.current)==null?void 0:a.click()},children:[e.jsx(Kt,{className:"h-4 w-4 mr-2"}),"Photos & Videos"]}),e.jsxs(k,{variant:"ghost",className:"w-full justify-start",onClick:()=>{var a;return(a=Qe.current)==null?void 0:a.click()},children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Document"]})]})})]})]}),C.trim()?e.jsx(k,{onClick:Je,disabled:G,size:"icon",className:"rounded-full bg-[#25D366] hover:bg-[#20B358] text-white shadow-md h-10 w-10 flex-shrink-0",children:G?e.jsx(ee,{className:"h-4 w-4 animate-spin"}):e.jsx(ve,{className:"h-4 w-4"})}):e.jsx(k,{onClick:St,size:"icon",className:"rounded-full bg-[#25D366] hover:bg-[#20B358] text-white shadow-md h-10 w-10 flex-shrink-0",children:e.jsx(Ut,{className:"h-4 w-4"})})]})})]}):e.jsxs("div",{className:"flex-1 flex flex-col w-full min-h-0",children:[e.jsxs("div",{className:"bg-card px-4 py-3 flex items-center gap-3 shadow-sm z-20 sticky top-0 pt-safe border-b",children:[e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>s("/"),className:"text-foreground hover:bg-accent -ml-2",children:e.jsx(tt,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-xl font-semibold",children:"Chats"})]}),e.jsx("div",{className:"px-4 py-3 border-b bg-card shadow-sm z-10 sticky top-[72px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Pt,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(ct,{placeholder:"Search chats...",value:K,onChange:a=>L(a.target.value),className:"pl-10 border-0 bg-muted/50 rounded-xl"})]})}),e.jsx(we,{className:"flex-1",children:e.jsx("div",{className:"divide-y divide-border/50",children:De.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(_t,{className:"h-12 w-12 mx-auto mb-4 opacity-30"}),e.jsx("p",{className:"text-sm",children:"No team members"})]}):De.map(a=>{const c=t?ne(t.uid,a.uid):"",i=b[c]||0;return e.jsx("div",{className:"px-4 py-3 hover:bg-muted/30 cursor-pointer transition-colors active:bg-muted/50",onClick:()=>Nt(a),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(je,{className:"h-12 w-12",children:[e.jsx(Ne,{src:a.photoURL||""}),e.jsx(ye,{className:"bg-primary/10 text-primary font-semibold",children:Ie(a.displayName,a.email)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsx("p",{className:"font-semibold truncate text-foreground",children:a.isSelf?"Message yourself":a.displayName||"Team Member"})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:a.isSelf?"Personal notes & reminders":_e(a.uid)?e.jsx("span",{className:"text-green-600 font-medium",children:"Online"}):`Last seen ${Pe(Ae(a.uid))}`}),i>0&&e.jsx(At,{className:"bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full min-w-[20px] h-5 flex items-center justify-center",children:i})]})]})]})},a.uid)})})})]})}):e.jsxs("div",{className:"flex w-full",children:[e.jsxs("div",{className:"w-1/3 border-r border-border flex flex-col",children:[e.jsxs("div",{className:"bg-card px-4 py-3 shadow-sm z-10 flex items-center gap-3 border-b",children:[e.jsx(k,{variant:"ghost",size:"icon",onClick:()=>s("/"),className:"text-foreground hover:bg-accent -ml-2",children:e.jsx(tt,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-xl font-semibold",children:"Chats"})]}),e.jsx("div",{className:"px-4 py-3 border-b bg-card shadow-sm z-10",children:e.jsxs("div",{className:"relative",children:[e.jsx(Pt,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(ct,{placeholder:"Search chats...",value:K,onChange:a=>L(a.target.value),className:"pl-10 border-0 bg-muted/50 rounded-xl"})]})}),e.jsx(we,{className:"flex-1",children:e.jsx("div",{className:"divide-y divide-border/50",children:De.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(_t,{className:"h-12 w-12 mx-auto mb-4 opacity-30"}),e.jsx("p",{className:"text-sm",children:"No team members"})]}):De.map(a=>{const c=t?ne(t.uid,a.uid):"",i=b[c]||0;return e.jsx("div",{className:M("px-4 py-3 cursor-pointer transition-colors",(m==null?void 0:m.uid)===a.uid?"bg-muted/70":"hover:bg-muted/30"),onClick:()=>Nt(a),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(je,{className:"h-12 w-12",children:[e.jsx(Ne,{src:a.photoURL||""}),e.jsx(ye,{className:"bg-primary/10 text-primary font-semibold",children:Ie(a.displayName,a.email)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsx("p",{className:"font-semibold truncate text-foreground",children:a.isSelf?"Message yourself":a.displayName||"Team Member"})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:a.isSelf?"Personal notes & reminders":_e(a.uid)?e.jsx("span",{className:"text-green-600 font-medium",children:"Online"}):`Last seen ${Pe(Ae(a.uid))}`}),i>0&&e.jsx(At,{className:"bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full min-w-[20px] h-5 flex items-center justify-center",children:i})]})]})]})},a.uid)})})})]}),e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-card px-4 py-3 flex items-center gap-3 shadow-sm z-20 border-b",children:[e.jsxs(je,{className:"h-10 w-10",children:[e.jsx(Ne,{src:m.photoURL||""}),e.jsx(ye,{className:"bg-primary/10 text-primary font-semibold",children:Ie(m.displayName,m.email)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold",children:m.uid===(t==null?void 0:t.uid)?"Message yourself":m.displayName||"Team Member"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m.uid===(t==null?void 0:t.uid)?"Personal notes":_e(m.uid)?"Online":`Last seen ${Pe(Ae(m.uid))}`})]})]}),e.jsx("div",{className:"flex-1 whatsapp-wallpaper overflow-hidden",children:e.jsx(we,{className:"h-full",children:e.jsxs("div",{className:"p-6 space-y-1",children:[I?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(ee,{className:"h-8 w-8 animate-spin text-primary"})}):Ee().length===0?e.jsxs("div",{className:"text-center py-16 text-muted-foreground",children:[e.jsx(st,{className:"h-16 w-16 mx-auto mb-6 opacity-30"}),e.jsx("p",{className:"text-base",children:"Start a conversation"})]}):Ee().map((a,c)=>{if(a.type==="date")return e.jsx("div",{className:"flex justify-center my-6",children:e.jsx("div",{className:"bg-background/90 dark:bg-muted/90 text-xs px-4 py-2 rounded-full text-muted-foreground shadow-sm",children:a.data})},`date-${c}`);const i=a.data,g=i.senderId===(t==null?void 0:t.uid),E=()=>{const T=Ft({onSwipeRight:g?void 0:()=>de(i),onSwipeLeft:g?()=>de(i):void 0},{threshold:80,velocityThreshold:.2}),R=i.attachments||[],N=R.length,P=i.type==="media"&&N>0,U=i.message&&i.message.trim().length>0,_=()=>{if(N===1&&R[0].type==="audio")return e.jsx(qt,{attachment:R[0],isMyMessage:g,senderAvatar:i.senderAvatar,senderName:i.senderName});const z=R.slice(0,4),F=N-4;return e.jsx("div",{className:M("grid gap-1",N===1&&"grid-cols-1",N===2&&"grid-cols-2",N===3&&"grid-cols-2 grid-rows-2",N>=4&&"grid-cols-2 grid-rows-2"),children:z.map((y,V)=>{if(y.type==="document")return e.jsx("div",{className:"col-span-2",children:e.jsxs("a",{href:y.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-black/10 dark:bg-black/20 rounded-lg hover:bg-black/20 dark:hover:bg-black/30 transition-colors",children:[y.status==="uploading"?e.jsx(ee,{className:"h-8 w-8 animate-spin text-muted-foreground flex-shrink-0"}):e.jsx(Te,{className:"h-8 w-8 text-primary flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold truncate text-sm",children:y.fileName}),e.jsx("p",{className:"text-xs text-muted-foreground",children:y.fileSize?Qt(y.fileSize):""})]})]})},y.id||V);const Y=V===3&&F>0,J=N===3&&V===0?"row-span-2 h-full":"aspect-square",et=y.status==="uploading"?y.previewUrl:y.url;return e.jsxs("div",{className:M("relative bg-black/20",J),onClick:()=>{if(y.status==="sent"&&y.url){const ge=R.filter(W=>W.status==="sent"&&W.url&&W.type==="image"),be=ge.findIndex(W=>W.id===y.id);q({open:!0,images:ge,startIndex:be>=0?be:0})}},children:[e.jsx("img",{src:et,alt:"Attachment",className:M("w-full h-full object-cover",y.status==="uploading"&&"opacity-50")}),Y&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsxs("span",{className:"text-white text-2xl font-bold",children:["+",F]})}),y.status==="uploading"&&!Y&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:e.jsx(ee,{className:"h-6 w-6 animate-spin text-white"})}),y.status==="failed"&&!Y&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/50 text-white p-2 text-center",children:[e.jsx(Ot,{className:"h-6 w-6 text-destructive mb-1"}),e.jsx("p",{className:"text-xs font-semibold",children:"Upload Failed"})]})]},y.id||V)})})};return e.jsxs(Wt,{children:[e.jsx(Xt,{children:e.jsx("div",{ref:T,className:M("max-w-[320px] text-sm break-words shadow-sm cursor-pointer relative",g?"bg-[#e7ffdb] text-black dark:bg-emerald-900/60 dark:text-white":"bg-white text-black dark:bg-muted dark:text-foreground",P?"p-1.5 rounded-xl":"px-3 py-2",i.isFirstInGroup&&i.isLastInGroup?"rounded-xl":i.isFirstInGroup?g?"rounded-t-xl rounded-bl-xl rounded-br-sm":"rounded-t-xl rounded-br-xl rounded-bl-sm":i.isLastInGroup?g?"rounded-b-xl rounded-tl-xl rounded-tr-sm":"rounded-b-xl rounded-tr-xl rounded-tl-sm":g?"rounded-l-xl rounded-r-sm":"rounded-r-xl rounded-l-sm"),children:e.jsxs("div",{className:"flex flex-col",children:[P&&_(),(U||!P)&&e.jsxs("div",{className:M("relative",P&&U&&"px-2 pt-2 pb-0.5"),children:[e.jsx("p",{className:"break-words leading-relaxed whitespace-pre-wrap",children:i.message}),e.jsxs("div",{className:"flex items-center gap-1 text-xs opacity-70 whitespace-nowrap mt-1 w-full justify-end",children:[e.jsx("span",{children:Me(i.timestamp)}),g&&Re(i)]})]}),P&&!U&&e.jsxs("div",{className:"flex items-center gap-1 text-xs opacity-70 whitespace-nowrap mt-1 w-full justify-end",children:[e.jsx("span",{children:Me(i.timestamp)}),g&&Re(i)]})]})})}),e.jsxs(ut,{className:"w-48 bg-background border shadow-lg z-50",children:[e.jsxs(ie,{onClick:()=>de(i),children:[e.jsx(lt,{className:"mr-2 h-4 w-4"}),"Create Task"]}),e.jsxs(ie,{onClick:()=>yt(i),children:[e.jsx(Gt,{className:"mr-2 h-4 w-4"}),"Copy Message"]}),e.jsxs(ie,{onClick:()=>Ct(i),children:[e.jsx(Yt,{className:"mr-2 h-4 w-4"}),"Reply"]})]})]})};return e.jsx("div",{className:M("flex mb-1",g?"justify-end":"justify-start"),children:e.jsx(E,{})},i.id)}),e.jsx("div",{ref:We})]})})}),e.jsx("div",{className:"bg-background border-t px-4 py-2 shadow-lg z-10",children:ce?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{variant:"ghost",size:"icon",className:"rounded-full h-10 w-10 flex-shrink-0",onClick:Ze,children:e.jsx(Et,{className:"h-5 w-5 text-destructive"})}),e.jsxs("div",{className:"flex-1 bg-muted/50 rounded-full flex items-center px-4 h-10",children:[e.jsx(dt,{className:"h-5 w-5 mr-2"}),e.jsx("span",{className:"font-mono text-sm",children:new Date(pe*1e3).toISOString().substr(14,5)})]}),e.jsx(k,{onClick:Rt,disabled:G,size:"icon",className:"rounded-full bg-primary hover:bg-primary/90 text-primary-foreground shadow-md h-10 w-10 flex-shrink-0",children:G?e.jsx(ee,{className:"h-4 w-4 animate-spin"}):e.jsx(ve,{className:"h-4 w-4"})})]}):Q?e.jsxs("div",{className:"flex items-center gap-2 h-10",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),e.jsx("span",{className:"font-mono text-sm",children:new Date(pe*1e3).toISOString().substr(14,5)}),e.jsx("div",{className:"flex-1"}),e.jsx(k,{onClick:kt,size:"icon",className:"rounded-full bg-destructive hover:bg-destructive/90 text-white shadow-md h-10 w-10 flex-shrink-0",children:e.jsx(Dt,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsxs("div",{className:"flex-1 flex items-center bg-muted/50 rounded-2xl p-1",children:[e.jsx(k,{variant:"ghost",size:"icon",className:"rounded-full h-9 w-9 flex-shrink-0",children:e.jsx(Vt,{className:"h-5 w-5 text-muted-foreground"})}),e.jsx(Bt,{value:C,onChange:a=>S(a.target.value),onKeyDown:jt,ref:H,placeholder:"Type a message",autoFocus:!0,rows:1,className:"flex-1 border-0 bg-transparent resize-none focus-visible:ring-0 focus-visible:ring-offset-0 px-2 text-base min-h-0"}),e.jsxs(Tt,{children:[e.jsx($t,{asChild:!0,children:e.jsx(k,{variant:"ghost",size:"icon",className:"rounded-full h-9 w-9 flex-shrink-0",children:e.jsx(Ht,{className:"h-5 w-5 text-muted-foreground"})})}),e.jsx(Lt,{className:"w-48 p-2 mb-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs(k,{variant:"ghost",className:"w-full justify-start",onClick:()=>{var a;return(a=qe.current)==null?void 0:a.click()},children:[e.jsx(Kt,{className:"h-4 w-4 mr-2"}),"Photos & Videos"]}),e.jsxs(k,{variant:"ghost",className:"w-full justify-start",onClick:()=>{var a;return(a=Qe.current)==null?void 0:a.click()},children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Document"]})]})})]})]}),C.trim()?e.jsx(k,{onClick:Je,disabled:G,size:"icon",className:"rounded-full bg-primary hover:bg-primary/90 text-primary-foreground shadow-md h-10 w-10 flex-shrink-0",children:G?e.jsx(ee,{className:"h-4 w-4 animate-spin"}):e.jsx(ve,{className:"h-4 w-4"})}):e.jsx(k,{onClick:St,size:"icon",className:"rounded-full bg-primary hover:bg-primary/90 text-primary-foreground shadow-md h-10 w-10 flex-shrink-0",children:e.jsx(Ut,{className:"h-4 w-4"})})]})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center whatsapp-wallpaper",children:e.jsxs("div",{className:"text-center space-y-6 p-8 bg-white/80 dark:bg-muted/80 rounded-2xl shadow-lg backdrop-blur-sm",children:[e.jsx(st,{className:"h-20 w-20 mx-auto text-muted-foreground/30"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Select a chat"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose a team member to start messaging"})]})]})})})]})})]})}export{Hn as default};
