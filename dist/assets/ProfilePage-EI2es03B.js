import{c as W,r as i,b1 as be,bM as Be,j as e,b3 as Le,br as we,b4 as ze,bR as De,bQ as $e,D as le,a7 as He,cC as Pe,an as de,L as M,k as L,o as z,A as O,aL as oe,q as Q,co as Ye,w as X,a3 as me,c8 as Ke,B as u,U as he,u as Oe,l as G,n as J,a4 as Qe,ao as xe,ap as F,aq as U,ar as A,as as _,Q as D,at as ue,x as k,cl as Xe,cD as Ge,bp as Je,X as We,az as $,cE as n,au as pe,av as Se,aw as Ze,cF as es}from"./index-CIyudF9t.js";import{S as fe}from"./separator-BKX0jZPM.js";import{S as je,a as ge,b as Ne,c as ve,d as w}from"./select-cJBpq2ym.js";import{U as ye}from"./user-plus-DpZnq-4A.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],as=W("globe",ss);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],rs=W("palette",ts);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],cs=W("shield",ns);var H="Switch",[is]=Le(H),[ls,ds]=is(H),Ce=i.forwardRef((t,a)=>{const{__scopeSwitch:c,name:p,checked:h,defaultChecked:E,required:g,disabled:f,value:N="on",onCheckedChange:l,form:x,...R}=t,[j,v]=i.useState(null),o=be(a,b=>v(b)),y=i.useRef(!1),T=j?x||!!j.closest("form"):!0,[S,P]=Be({prop:h,defaultProp:E??!1,onChange:l,caller:H});return e.jsxs(ls,{scope:c,checked:S,disabled:f,children:[e.jsx(we.button,{type:"button",role:"switch","aria-checked":S,"aria-required":g,"data-state":Te(S),"data-disabled":f?"":void 0,disabled:f,value:N,...R,ref:o,onClick:ze(t.onClick,b=>{P(C=>!C),T&&(y.current=b.isPropagationStopped(),y.current||b.stopPropagation())})}),T&&e.jsx(Re,{control:j,bubbles:!y.current,name:p,value:N,checked:S,required:g,disabled:f,form:x,style:{transform:"translateX(-100%)"}})]})});Ce.displayName=H;var ke="SwitchThumb",Ee=i.forwardRef((t,a)=>{const{__scopeSwitch:c,...p}=t,h=ds(ke,c);return e.jsx(we.span,{"data-state":Te(h.checked),"data-disabled":h.disabled?"":void 0,...p,ref:a})});Ee.displayName=ke;var os="SwitchBubbleInput",Re=i.forwardRef(({__scopeSwitch:t,control:a,checked:c,bubbles:p=!0,...h},E)=>{const g=i.useRef(null),f=be(g,E),N=De(c),l=$e(a);return i.useEffect(()=>{const x=g.current;if(!x)return;const R=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(R,"checked").set;if(N!==c&&v){const o=new Event("click",{bubbles:p});v.call(x,c),x.dispatchEvent(o)}},[N,c,p]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:c,...h,tabIndex:-1,ref:f,style:{...h.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Re.displayName=os;function Te(t){return t?"checked":"unchecked"}var qe=Ce,ms=Ee;const Ie=i.forwardRef(({className:t,...a},c)=>e.jsx(qe,{className:le("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:c,children:e.jsx(ms,{className:le("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ie.displayName=qe.displayName;const hs=Se({displayName:$().min(2,"Name must be at least 2 characters"),email:$().email("Invalid email address")}),xs=Se({notifications:es().optional(),theme:Ze(["light","dark","system"]).optional(),language:$().optional()});function gs(){var se,ae,te,re,ne,ce,ie;const{user:t,userProfile:a,updateUserProfile:c,sendVerificationEmail:p,sendTeamRequest:h,fetchReceivedTeamRequests:E,acceptTeamRequest:g,declineTeamRequest:f,fetchTeamMembers:N,loading:l}=He(),{theme:x,setTheme:R}=Pe(),[j,v]=i.useState(!1),[o,y]=i.useState(""),[T,S]=i.useState([]),[P,b]=i.useState([]),[C,Z]=i.useState(!1);i.useEffect(()=>{t&&(Y(),ee())},[t,a==null?void 0:a.teamId]);const Y=async()=>{if(!t)return;const s=await E();S(s)},ee=async()=>{if(!t||!(a!=null&&a.teamId)){b([]);return}const s=await N();b(s)},V=async()=>{if(!o.trim())return;const s=o.split(",").map(r=>r.trim()).filter(r=>$().email().safeParse(r).success);if(s.length===0){n({title:"Invalid Email",description:"Please provide at least one valid email address.",variant:"destructive"});return}try{Z(!0);const r=await Promise.allSettled(s.map(m=>h(m))),d=r.filter(m=>m.status==="fulfilled").length,I=r.filter(m=>m.status==="rejected").length;d>0?n({title:"Team requests sent!",description:`Successfully sent ${d} request${d!==1?"s":""}${I>0?`. ${I} failed.`:"."}`}):n({title:"Failed to send requests",description:"Please check the email addresses and try again.",variant:"destructive"}),y("")}catch(r){console.error("Error sending team request:",r),n({title:"An error occurred",description:r.message||"Could not send team requests.",variant:"destructive"})}finally{Z(!1)}},Me=async(s,r)=>{try{await g(s,r),await Y(),await ee(),n({title:"Team request accepted!",description:"You've joined a new team."})}catch(d){console.error("Error accepting request:",d),n({title:"Error",description:d.message,variant:"destructive"})}},Fe=async s=>{try{await f(s),await Y(),n({title:"Request declined."})}catch(r){console.error("Error declining request:",r),n({title:"Error",description:r.message,variant:"destructive"})}},Ue=async()=>{try{await c({role:"superadmin"}),n({title:"Role Updated",description:"You are now a Superadmin! Access granted to restricted features."})}catch{n({title:"Error",description:"Failed to set role.",variant:"destructive"})}},B=de({resolver:pe(hs),defaultValues:{displayName:(a==null?void 0:a.displayName)||"",email:(t==null?void 0:t.email)||""},values:{displayName:(a==null?void 0:a.displayName)||"",email:(t==null?void 0:t.email)||""}}),q=de({resolver:pe(xs),defaultValues:{notifications:((se=a==null?void 0:a.preferences)==null?void 0:se.notifications)??!0,theme:((ae=a==null?void 0:a.preferences)==null?void 0:ae.theme)||x||"system",language:((te=a==null?void 0:a.preferences)==null?void 0:te.language)||"en"},values:{notifications:((re=a==null?void 0:a.preferences)==null?void 0:re.notifications)??!0,theme:((ne=a==null?void 0:a.preferences)==null?void 0:ne.theme)||x||"system",language:((ce=a==null?void 0:a.preferences)==null?void 0:ce.language)||"en"}}),Ae=async s=>{try{await c({displayName:s.displayName}),v(!1),n({title:"Profile updated successfully!"})}catch(r){console.error("Error updating profile:",r),n({title:"Error",description:r.message,variant:"destructive"})}},_e=async s=>{var r,d,I;try{s.theme&&R(s.theme);const m={notifications:s.notifications??((r=a==null?void 0:a.preferences)==null?void 0:r.notifications)??!0,theme:s.theme??((d=a==null?void 0:a.preferences)==null?void 0:d.theme)??"system",language:s.language??((I=a==null?void 0:a.preferences)==null?void 0:I.language)??"en"};await c({preferences:m}),n({title:"Preferences saved!"})}catch(m){console.error("Error updating preferences:",m),n({title:"Error",description:m.message,variant:"destructive"})}},Ve=async()=>{try{await p(),n({title:"Verification email sent!",description:"Check your inbox to verify your email address."})}catch(s){console.error("Error sending verification email:",s),n({title:"Error",description:s.message,variant:"destructive"})}},K=(s,r)=>s&&s.trim()?s.split(" ").map(d=>d[0]).join("").toUpperCase().slice(0,2):r?r.split("@")[0].slice(0,2).toUpperCase():"??";return!t||!a?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(M,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsx("div",{className:"container mx-auto p-4 md:p-6 lg:p-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(L,{className:"shadow-elegant lg:col-span-1",children:e.jsxs(z,{className:"pt-6 flex flex-col items-center text-center",children:[e.jsxs(O,{className:"h-24 w-24 mb-4",children:[e.jsx(oe,{src:a.photoURL||"",alt:a.displayName||""}),e.jsx(Q,{className:"text-3xl",children:K(a.displayName,a.email)})]}),e.jsx("h2",{className:"text-2xl font-semibold",children:a.displayName}),e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(Ye,{className:"h-3 w-3"}),a.email]}),e.jsx("div",{className:"mt-4",children:t.emailVerified?e.jsxs(X,{variant:"secondary",className:"border-green-500/50 bg-green-500/10 text-green-700 dark:text-green-400",children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),"Verified"]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs(X,{variant:"destructive",children:[e.jsx(Ke,{className:"h-3 w-3 mr-1"}),"Not Verified"]}),e.jsx(u,{variant:"link",className:"h-auto p-0 text-xs",onClick:Ve,disabled:l,children:"Resend verification email"})]})}),e.jsx(fe,{className:"my-6"}),e.jsxs("div",{className:"w-full text-left space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-center mb-2 uppercase tracking-wider text-muted-foreground",children:"Account Status"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(he,{className:"h-4 w-4"})," Team Status"]}),e.jsx("span",{className:"font-medium",children:a.teamId?"In a Team":"No Team"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(cs,{className:"h-4 w-4"})," Account"]}),e.jsx("span",{className:"font-medium capitalize",children:a.role||"user"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Oe,{className:"h-4 w-4"})," Joined"]}),e.jsx("span",{className:"font-medium",children:(ie=t.metadata)!=null&&ie.creationTime?new Date(t.metadata.creationTime).toLocaleDateString():"N/A"})]})]}),a.role!=="superadmin"&&e.jsx("div",{className:"w-full mt-6 pt-4 border-t border-dashed",children:e.jsx(u,{onClick:Ue,variant:"destructive",className:"w-full bg-purple-600 hover:bg-purple-700",children:"Set Role to Superadmin (Test)"})})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(L,{className:"shadow-elegant",children:[e.jsx(G,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5"}),"Basic Information"]}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>v(!j),children:j?"Cancel":"Edit"})]})}),e.jsx(z,{children:j?e.jsx(xe,{...B,children:e.jsxs("form",{onSubmit:B.handleSubmit(Ae),className:"space-y-4",children:[e.jsx(F,{control:B.control,name:"displayName",render:({field:s})=>e.jsxs(U,{children:[e.jsx(A,{children:"Display Name"}),e.jsx(_,{children:e.jsx(D,{placeholder:"Your name",...s})}),e.jsx(ue,{})]})}),e.jsx(F,{control:B.control,name:"email",render:({field:s})=>e.jsxs(U,{children:[e.jsx(A,{children:"Email Address"}),e.jsx(_,{children:e.jsx(D,{placeholder:"your@email.com",...s,disabled:!0})}),e.jsx(ue,{}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Email cannot be changed for security reasons."})]})}),e.jsx(u,{type:"submit",disabled:l,variant:"focus",children:l?e.jsx(M,{className:"h-4 w-4 mr-2 animate-spin"}):"Save Changes"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-sm font-medium",children:"Display Name"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.displayName||"Not set"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-sm font-medium",children:"Email Address"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.email})]})]})})]}),e.jsxs(L,{className:"shadow-elegant",children:[e.jsx(G,{children:e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"h-5 w-5"}),"Preferences"]})}),e.jsx(z,{children:e.jsx(xe,{...q,children:e.jsxs("form",{onSubmit:q.handleSubmit(_e),className:"space-y-6",children:[e.jsx(F,{control:q.control,name:"notifications",render:({field:s})=>e.jsxs(U,{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs(A,{className:"flex items-center gap-2 text-base",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Push Notifications"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive notifications for tasks and reminders."})]}),e.jsx(_,{children:e.jsx(Ie,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(F,{control:q.control,name:"theme",render:({field:s})=>e.jsxs(U,{children:[e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-4 w-4"}),"Theme"]}),e.jsxs(je,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(_,{children:e.jsx(ge,{children:e.jsx(Ne,{placeholder:"Select theme"})})}),e.jsxs(ve,{children:[e.jsx(w,{value:"light",children:"Light"}),e.jsx(w,{value:"dark",children:"Dark"}),e.jsx(w,{value:"system",children:"System"})]})]})]})}),e.jsx(F,{control:q.control,name:"language",render:({field:s})=>e.jsxs(U,{children:[e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(as,{className:"h-4 w-4"}),"Language"]}),e.jsxs(je,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(_,{children:e.jsx(ge,{children:e.jsx(Ne,{placeholder:"Select language"})})}),e.jsxs(ve,{children:[e.jsx(w,{value:"en",children:"English"}),e.jsx(w,{value:"es",children:"Español"}),e.jsx(w,{value:"fr",children:"Français"}),e.jsx(w,{value:"de",children:"Deutsch"})]})]})]})}),e.jsx(u,{type:"submit",disabled:l,variant:"focus",children:l?e.jsx(M,{className:"h-4 w-4 mr-2 animate-spin"}):"Save Preferences"})]})})})]}),e.jsxs(L,{className:"shadow-elegant",children:[e.jsx(G,{children:e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5"}),"Team Collaboration"]})}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-6",children:[a!=null&&a.teamId?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-green-500/5 border border-green-500/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(me,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"font-medium text-green-600 dark:text-green-400",children:"You're part of a team!"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx(k,{className:"text-sm font-medium",children:"Team Members"}),e.jsx("div",{className:"mt-2 space-y-2",children:P.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background/50 rounded-lg",children:[e.jsxs(O,{className:"h-8 w-8",children:[e.jsx(oe,{src:s.photoURL||""}),e.jsx(Q,{className:"text-xs",children:K(s.displayName,s.email)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:s.displayName||"User"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.email})]}),s.uid===(t==null?void 0:t.uid)&&e.jsx(X,{variant:"secondary",className:"text-xs",children:"You"})]},s.uid))})]})})]}),e.jsx(fe,{}),e.jsxs("div",{children:[e.jsx(k,{htmlFor:"teamRequestEmail",className:"text-sm font-medium",children:"Invite More Members"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(D,{id:"teamRequestEmail",type:"text",placeholder:"colleague1@example.com, colleague2@example.com",value:o,onChange:s=>y(s.target.value),onKeyPress:s=>s.key==="Enter"&&V(),className:"flex-1"}),e.jsx(u,{onClick:V,disabled:!o.trim()||C,variant:"focus",className:"hover-scale",children:C?e.jsx(M,{className:"h-4 w-4 animate-spin"}):e.jsx(ye,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Send collaboration requests (separate multiple emails with commas)."})]})]}):e.jsxs("div",{children:[e.jsx(k,{htmlFor:"teamRequestEmail",className:"text-sm font-medium",children:"Invite Team Member"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(D,{id:"teamRequestEmail",type:"text",placeholder:"colleague1@example.com, colleague2@example.com",value:o,onChange:s=>y(s.target.value),onKeyPress:s=>s.key==="Enter"&&V(),className:"flex-1"}),e.jsx(u,{onClick:V,disabled:!o.trim()||C,variant:"focus",className:"hover-scale",children:C?e.jsx(M,{className:"h-4 w-4 animate-spin"}):e.jsx(ye,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Send a request to start a team or join an existing one."})]}),T.length>0&&e.jsxs("div",{children:[e.jsx(k,{className:"text-sm font-medium",children:"Pending Requests"}),e.jsx("div",{className:"mt-2 space-y-2",children:T.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(O,{className:"h-8 w-8",children:e.jsx(Q,{className:"text-xs",children:K(s.senderName,s.senderEmail)})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s.senderName||"User"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.senderEmail})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{size:"icon",variant:"outline",onClick:()=>Me(s.id,s.senderId),disabled:l,className:"h-8 w-8 hover-scale text-green-500 hover:bg-green-500/10 hover:border-green-500/20",children:e.jsx(Je,{className:"h-4 w-4"})}),e.jsx(u,{size:"icon",variant:"outline",onClick:()=>Fe(s.id),disabled:l,className:"h-8 w-8 hover-scale text-red-500 hover:bg-red-500/10 hover:border-red-500/20",children:e.jsx(We,{className:"h-4 w-4"})})]})]},s.id))})]})]})})]})]})]})})}export{gs as default};
