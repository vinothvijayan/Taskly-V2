import{c as re,aG as ie,r as i,j as e,m as I,X as ze,F as ft,A as gt,aB as vt,k as jt,ah as ve,ai as je,aj as ye,ak as H,O as ue,q as L,e as be,h as yt,L as bt,av as wt,aH as we,aI as Nt,aJ as Ct,aK as St,I as ce,aL as Ke,aM as Oe,aN as qe,B as V,aO as Ue,aP as Ve,l as _e,C as de,U as Be,aQ as te,aR as W,aS as ne,aF as Tt,ar as Dt,as as Et,at as It,$ as Pt,o as Rt,p as kt,s as Mt,aT as At,n as Y}from"./index-BOMCLsi_.js";import{f as Ft,E as Ge,D as He}from"./DeleteConfirmationDialog-ZXLq3vwY.js";import{S as Ne,A as Je}from"./index-DvSqf5q0.js";import{a as $t,u as Lt}from"./useTouchGestures-BNpwY5ui.js";import{T as We}from"./textarea-iMbD7bqt.js";import{S as zt}from"./send-5-KT-IdZ.js";import{m as Xe}from"./skeletons-OrUvxu0E.js";import{C as Kt}from"./checkbox-pEVMzDLQ.js";import{C as Ot,S as Re,a as ke,b as Me,c as Ae,d as Q}from"./select-QNqOlXgW.js";import{C as qt}from"./chevron-down-QVhbesXr.js";import{P as Ut}from"./plus-jVcLPC9x.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],_t=re("chevrons-up-down",Vt);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ce=re("circle-check",Bt);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Ht=re("ellipsis",Gt);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Se=re("message-circle",Jt);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]],Ye=re("star-off",Wt);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Qe=re("star",Xt);function Ze({taskId:t,initialContent:r="",isEditing:s=!1,commentId:p,onCommentAdded:a,onCancel:o}){const{addComment:u,updateComment:f}=ie(),[c,d]=i.useState(r),[l,m]=i.useState(!1),g=1e3,j=g-c.length,T=async S=>{if(S.preventDefault(),!(!c.trim()||l)){m(!0);try{s&&p?await f(p,t,c):await u(t,c),d(""),a==null||a()}catch(F){console.error("Error submitting comment:",F)}finally{m(!1)}}},E=S=>{S.key==="Enter"&&(S.ctrlKey||S.metaKey)&&(S.preventDefault(),T(S)),S.key==="Escape"&&(o==null||o())};return e.jsxs("form",{onSubmit:T,className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(We,{value:c,onChange:S=>d(S.target.value),onKeyDown:E,placeholder:"Add a comment... (Ctrl+Enter to submit)",className:"min-h-[80px] resize-none pr-16",maxLength:g,autoFocus:!0}),e.jsx("div",{className:"absolute bottom-2 right-2 text-xs text-muted-foreground",children:j})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-muted-foreground"}),e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsxs(I,{type:"button",variant:"ghost",size:"sm",onClick:o,disabled:l,children:[e.jsx(ze,{className:"h-4 w-4 mr-1"}),"Cancel"]}),e.jsxs(I,{type:"submit",size:"sm",disabled:!c.trim()||l||j<0,children:[e.jsx(zt,{className:"h-4 w-4 mr-1"}),l?"Posting...":s?"Update":"Comment"]})]})]})]})}function Yt({comment:t}){const{deleteComment:r}=ie(),{user:s}=ft(),[p,a]=i.useState(!1),o=(s==null?void 0:s.uid)===t.userId,u=g=>{if(!g)return"";const j=g.toDate?g.toDate():new Date(g),T=Ft(j,{addSuffix:!0});return T.includes("less than a minute")?"Just now":T.includes("about a minute")?"1 minute ago":T},f=g=>g.split(" ").map(j=>j[0]).join("").toUpperCase().slice(0,2),c=()=>{a(!0)},d=async()=>{confirm("Are you sure you want to delete this comment?")&&await r(t.id,t.taskId)},l=()=>{a(!1)},m=()=>{a(!1)};return p?e.jsx("div",{className:"border rounded-lg p-3 bg-muted/20",children:e.jsx(Ze,{taskId:t.taskId,initialContent:t.content,isEditing:!0,commentId:t.id,onCommentAdded:l,onCancel:m})}):e.jsxs("div",{className:"flex gap-3 group",children:[e.jsxs(gt,{className:"h-8 w-8 flex-shrink-0",children:[e.jsx(vt,{src:t.userPhotoURL,alt:t.userDisplayName}),e.jsx(jt,{className:"text-xs",children:f(t.userDisplayName)})]}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:t.userDisplayName}),e.jsx("span",{className:"text-xs text-muted-foreground",children:u(t.createdAt)}),t.isEdited&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"(edited)"}),o&&e.jsxs(ve,{children:[e.jsx(je,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Ht,{className:"h-3 w-3"})})}),e.jsxs(ye,{align:"end",children:[e.jsxs(H,{onClick:c,children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(H,{onClick:d,className:"text-destructive",children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),e.jsx("div",{className:"text-sm whitespace-pre-wrap break-words",children:t.content})]})]})}function et({taskId:t,className:r,isExpanded:s,onToggleExpanded:p}){const{comments:a,commentCounts:o,loading:u,subscribeToTaskComments:f,unsubscribeFromTaskComments:c}=ie(),[d,l]=i.useState(!1),m=i.useRef(null),g=a[t]||[];o[t];const j=u[t]===!0&&g.length===0;i.useEffect(()=>{m.current&&clearTimeout(m.current);const E=f(t);return()=>{E&&c(t)}},[t,f,c]),i.useEffect(()=>{s?m.current&&(clearTimeout(m.current),m.current=null):m.current=setTimeout(()=>{c(t)},3e4)},[s,t,c]);const T=()=>{l(!1)};return e.jsx("div",{className:L("w-full pt-0",r),children:e.jsx(Je,{initial:!1,children:s&&e.jsx(Xe.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{type:"spring",duration:.4,bounce:0},className:"overflow-hidden",children:e.jsx(be,{className:"mt-1 border-none shadow-none bg-transparent",children:e.jsxs(yt,{className:"py-1 px-2 space-y-3",children:[" ",d?e.jsx(Ze,{taskId:t,onCommentAdded:T,onCancel:()=>l(!1)}):e.jsxs(I,{variant:"outline",onClick:()=>l(!0),className:"w-full justify-start text-muted-foreground h-9 rounded-md border-dashed hover:border-primary/50 hover:text-primary transition-colors",size:"sm",children:[e.jsx(Se,{className:"h-3 w-3 mr-2"}),"Write a comment..."]}),j?e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground py-4",children:[e.jsx(bt,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Loading comments..."})]}):g.length>0&&e.jsxs("div",{className:"space-y-3 border-t border-border/50 pt-2",children:[" ",g.map(E=>e.jsx(Yt,{comment:E},E.id))]})]})})})})})}const Qt=t=>{if(!t||t.length===0)return 0;const r=t.filter(s=>s.isCompleted).length;return Math.round(r/t.length*100)};function tt({task:t}){var k;const{addSubtask:r,toggleSubtaskStatus:s,deleteSubtask:p}=wt(),[a,o]=i.useState(""),[u,f]=i.useState(!1),c=Qt(t.subtasks),d=((k=t.subtasks)==null?void 0:k.length)||0,{trackingSubtask:l,isTrackingSubtask:m,startSubtaskTracking:g,stopSubtaskTracking:j,getFormattedTime:T,currentSubtaskElapsedSeconds:E}=we(),S=async h=>{h.stopPropagation(),a.trim()&&(await r(t.id,a.trim()),o(""))},F=async(h,y)=>{var B;const O=(B=t.subtasks)==null?void 0:B.find(w=>w.id===y),P=(l==null?void 0:l.subtaskId)===y&&(l==null?void 0:l.taskId)===t.id;O&&!O.isCompleted&&P&&m?await s(t.id,y,{currentSeconds:E,stopTracking:j}):await s(t.id,y)},$=async(h,y)=>{h.stopPropagation(),confirm("Are you sure you want to delete this subtask?")&&await p(t.id,y)},_=h=>{h.stopPropagation(),h.key==="Enter"&&(h.preventDefault(),S(h))},K=()=>{f(!u)};return e.jsxs("div",{className:"pt-0 pb-3 space-y-3",children:[" ",e.jsxs(I,{variant:"ghost",onClick:K,className:"w-full justify-between py-1 px-2 h-auto hover:bg-muted/30 rounded-lg transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:["Subtasks ",d>0&&`(${d})`]})]}),u?e.jsx(Ot,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(qt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Je,{initial:!1,children:u&&e.jsx(Xe.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{type:"spring",duration:.4,bounce:0},className:"overflow-hidden",children:e.jsxs("div",{className:"space-y-3 pt-0",children:[t.subtasks&&t.subtasks.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Nt,{value:c,className:"flex-1 h-2"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[c,"%"]})]}),e.jsx("div",{className:"space-y-2",children:t.subtasks.map(h=>{const y=(l==null?void 0:l.subtaskId)===h.id&&(l==null?void 0:l.taskId)===t.id,O=y?E:h.timeSpent||0;return e.jsxs("div",{className:"flex items-center gap-2 group",children:[e.jsx(Kt,{id:`subtask-${h.id}`,checked:h.isCompleted,onCheckedChange:P=>F({stopPropagation:()=>{}},h.id),onClick:P=>P.stopPropagation(),className:"h-4 w-4"}),e.jsxs("label",{htmlFor:`subtask-${h.id}`,className:L("flex-1 text-sm cursor-pointer",h.isCompleted?"line-through text-muted-foreground":"text-foreground"),onClick:P=>P.stopPropagation(),children:[h.title,O>0&&e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:T(O)})]}),e.jsx(I,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity hover:text-primary",onClick:P=>{P.stopPropagation(),y&&m?j():g(t.id,h.id,h.title)},title:y&&m?"Stop tracking":"Start tracking",children:y&&m?e.jsx(Ct,{className:"h-3 w-3 fill-current"}):e.jsx(St,{className:"h-3 w-3"})}),e.jsx(I,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity hover:text-destructive",onClick:P=>$(P,h.id),children:e.jsx(ue,{className:"h-3 w-3"})})]},h.id)})})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(ce,{placeholder:"Add a new subtask...",value:a,onChange:h=>o(h.target.value),onKeyPress:_,onClick:h=>h.stopPropagation(),className:"flex-1"}),e.jsx(I,{size:"icon",onClick:S,disabled:!a.trim(),children:e.jsx(Ut,{className:"h-4 w-4"})})]})]})})})]})}function Lr({task:t,onEdit:r,onDelete:s,onToggleStatus:p,onTogglePriority:a,onStartTimer:o,assignedProfiles:u}){const[f,c]=i.useState(!1),[d,l]=i.useState(!1),{commentCounts:m}=ie(),{trackingTask:g,isTracking:j,startTracking:T,stopTracking:E,getFormattedTime:S,trackingSubtask:F}=we(),$=(g==null?void 0:g.id)===t.id,_=(F==null?void 0:F.taskId)===t.id,K=t.status==="completed",k=t.dueDate&&new Date(t.dueDate)<new Date&&!K,h=Ke(t),y=()=>{s(t.id),c(!1)},O=w=>{const q=new Date(w),N=new Date,M=q.getTime()-N.getTime(),R=Math.ceil(M/(1e3*60*60*24));return R===0?"Today":R===1?"Tomorrow":R===-1?"Yesterday":R<0?`${Math.abs(R)} days ago`:`${R} days`},P=w=>{const q=Math.floor(w/3600),N=Math.floor(w%3600/60);return q>0?`${q}h ${N}m`:`${N}m`},B=m[t.id]||0;return e.jsxs("div",{className:"flex flex-col mb-3",children:[e.jsxs(be,{className:L("relative transition-all duration-200 cursor-pointer","min-h-[120px] shadow-md hover:shadow-lg dark:shadow-lg","bg-white dark:bg-gray-900","border border-border/50 dark:border-gray-700","rounded-xl",K&&"opacity-75 bg-muted/50 dark:bg-gray-800",$&&"ring-2 ring-primary/50 border-primary/50",_&&"ring-2 ring-primary/50 border-primary/50",h&&"border-l-4 border-l-blue-500 bg-blue-50/10 dark:bg-blue-900/10 animate-pulse-glow",k&&"bg-destructive/5 dark:bg-red-900/20 animate-pulse-glow-destructive"),onClick:w=>{const q=w.target;(w.target===w.currentTarget||!q.closest("button, a, [role='menuitem']"))&&r(t)},children:[e.jsx("div",{className:"p-5 pb-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(I,{onClick:w=>{w.stopPropagation(),p(t.id)},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 min-w-[40px] shrink-0 rounded-full hover:bg-primary/10 transition-all",children:K?e.jsx(Ce,{className:"h-6 w-6 text-green-600"}):e.jsx(Oe,{className:"h-6 w-6 text-muted-foreground hover:text-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h3",{className:L("font-semibold text-lg leading-relaxed line-clamp-2",K&&"line-through text-muted-foreground"),children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs(I,{onClick:w=>{w.stopPropagation(),l(!d),t.lastCommentedAt&&qe(t.id,t.lastCommentedAt)},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-primary/10 transition-all relative",children:[e.jsx(Se,{className:"h-5 w-5 text-muted-foreground"}),B>0&&e.jsx(V,{variant:"destructive",className:"absolute -top-1 -right-1 h-4 w-4 flex items-center justify-center p-0 text-xs font-bold",children:B})]}),e.jsx(I,{onClick:w=>{w.stopPropagation(),a(t.id)},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-yellow-500/10 transition-all",children:t.priority==="high"?e.jsx(Qe,{className:"h-5 w-5 fill-yellow-400 text-yellow-400"}):e.jsx(Ye,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs(ve,{children:[e.jsx(je,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-muted/50 transition-all",onClick:w=>w.stopPropagation(),children:e.jsx(Ge,{className:"h-5 w-5"})})}),e.jsxs(ye,{align:"end",className:"w-52 shadow-lg",children:[e.jsxs(H,{onClick:w=>{w.stopPropagation(),r(t)},children:[e.jsx(Ne,{className:"h-4 w-4 mr-3"}),"Edit Task"]}),e.jsx(H,{onClick:w=>{w.stopPropagation(),$?E():T(t)},children:$?e.jsxs(e.Fragment,{children:[" ",e.jsx(Ue,{className:"h-4 w-4 mr-3"})," Stop Timer "]}):e.jsxs(e.Fragment,{children:[" ",e.jsx(Ve,{className:"h-4 w-4 mr-3"})," Start Timer "]})}),e.jsxs(H,{onClick:w=>{w.stopPropagation(),c(!0)},className:"text-destructive",children:[e.jsx(ue,{className:"h-4 w-4 mr-3"}),"Delete Task"]})]})]})]})]}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 leading-relaxed",children:t.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs mt-3",children:[t.dueDate&&e.jsxs(V,{variant:k?"destructive":"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(_e,{className:"h-3 w-3 mr-1.5"}),O(t.dueDate)]}),t.estimatedTime&&e.jsxs(V,{variant:"secondary",className:"h-6 text-xs px-2 py-1",children:[e.jsx(de,{className:"h-3 w-3 mr-1.5"}),t.estimatedTime,"m"]}),t.timeSpent&&t.timeSpent>0&&e.jsxs(V,{variant:"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(de,{className:"h-3 w-3 mr-1.5"}),P(t.timeSpent)]}),u.length>0&&e.jsxs(V,{variant:"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(Be,{className:"h-3 w-3 mr-1.5"}),u.length]}),e.jsx(V,{variant:t.status==="completed"?"default":"secondary",className:"h-6 text-xs px-2 py-1",children:t.status})]})]})]})}),e.jsx("div",{className:"px-5 py-0 border-t border-border/30",children:e.jsx(et,{taskId:t.id,isExpanded:d,onToggleExpanded:()=>l(!d)})}),t.subtasks&&(t.subtasks.length>0||!K)&&e.jsxs("div",{className:"px-5 pt-3 py-0 border-t border-border/30",children:[" ",e.jsx(tt,{task:t})]}),$&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full animate-pulse shadow-glow"})})]}),e.jsx(He,{open:f,onOpenChange:c,onConfirm:y,itemName:t.title})]})}const zr=i.memo(function({task:r,onEdit:s,onDelete:p,onToggleStatus:a,onTogglePriority:o,onStartTimer:u,assignedProfiles:f=[]}){const[c,d]=i.useState(!1),[l,m]=i.useState(!1),{commentCounts:g}=ie(),{impact:j,notification:T}=Lt(),{trackingTask:E,startTracking:S,stopTracking:F,trackingSubtask:$}=we(),_=(E==null?void 0:E.id)===r.id,K=($==null?void 0:$.taskId)===r.id,k=$t({onSwipeLeft:()=>{j("medium"),d(!0)},onSwipeRight:()=>{j("light"),a(r.id)}},{threshold:60,velocityThreshold:.15,ignoreTapFromInteractive:!0}),h=r.dueDate&&new Date(r.dueDate)<new Date&&r.status!=="completed",y=r.status==="completed",O=Ke(r),P=()=>{p(r.id),T("error"),d(!1)},B=N=>{const M=new Date(N),R=new Date,se=M.getTime()-R.getTime(),G=Math.ceil(se/(1e3*60*60*24));return G===0?"Today":G===1?"Tomorrow":G===-1?"Yesterday":G<0?`${Math.abs(G)} days ago`:`${G} days`},w=N=>{const M=Math.floor(N/3600),R=Math.floor(N%3600/60);return M>0?`${M}h ${R}m`:`${R}m`},q=g[r.id]||0;return e.jsxs("div",{className:"flex flex-col mb-3",children:[e.jsxs(be,{ref:k,className:L("relative transition-all duration-200 touch-manipulation touch-pan-y z-10 mx-1","shadow-md hover:shadow-lg",y&&"opacity-75 bg-muted/50",h&&!y&&"border-destructive/50 bg-destructive/5",_&&"ring-2 ring-primary/50 border-primary/50",K&&"ring-2 ring-primary/50 border-primary/50",O&&"border-l-4 border-l-blue-500 bg-blue-50/10 dark:bg-blue-900/10 animate-pulse-glow","border border-border/50 rounded-xl"),children:[e.jsx("div",{className:"p-3 sm:p-4",onClick:N=>{const M=N.target;(N.target===N.currentTarget||!M.closest('button, a, [role="menuitem"]'))&&s(r)},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(I,{onClick:N=>{N.stopPropagation(),a(r.id),j("light")},variant:"ghost",size:"sm",className:"p-0 h-9 w-9 min-w-[36px] shrink-0 rounded-full hover:bg-primary/10 transition-all",children:y?e.jsx(Ce,{className:"h-5 w-5 text-green-600"}):e.jsx(Oe,{className:"h-5 w-5 text-muted-foreground hover:text-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h3",{className:L("font-semibold text-sm leading-snug line-clamp-2",y&&"line-through text-muted-foreground"),children:r.title}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsxs(I,{onClick:N=>{N.stopPropagation(),m(!l),r.lastCommentedAt&&qe(r.id,r.lastCommentedAt),j("light")},variant:"ghost",size:"sm",className:"p-0 h-8 w-8 rounded-full hover:bg-primary/10 transition-all relative",children:[e.jsx(Se,{className:"h-4 w-4 text-muted-foreground"}),q>0&&e.jsx(V,{variant:"destructive",className:"absolute -top-0.5 -right-0.5 h-3.5 w-3.5 flex items-center justify-center p-0 text-[10px] font-bold",children:q})]}),e.jsx(I,{onClick:N=>{N.stopPropagation(),o(r.id),j("light")},variant:"ghost",size:"sm",className:"p-0 h-8 w-8 rounded-full hover:bg-yellow-500/10 transition-all",children:r.priority==="high"?e.jsx(Qe,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}):e.jsx(Ye,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs(ve,{children:[e.jsx(je,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",className:"p-0 h-8 w-8 rounded-full hover:bg-muted/50 transition-all",onClick:N=>{N.stopPropagation(),j("light")},children:e.jsx(Ge,{className:"h-4 w-4"})})}),e.jsxs(ye,{align:"end",className:"w-52 shadow-lg",children:[e.jsxs(H,{onClick:N=>{N.stopPropagation(),s(r)},children:[e.jsx(Ne,{className:"h-4 w-4 mr-3"}),"Edit Task"]}),e.jsx(H,{onClick:N=>{N.stopPropagation(),_?F():S(r)},children:_?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"h-4 w-4 mr-3"}),"Stop Timer"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 mr-3"}),"Start Timer"]})}),e.jsxs(H,{onClick:N=>{N.stopPropagation(),d(!0)},className:"text-destructive",children:[e.jsx(ue,{className:"h-4 w-4 mr-3"}),"Delete Task"]})]})]})]})]}),r.description&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 leading-relaxed",children:r.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 text-xs mt-2",children:[r.dueDate&&e.jsxs(V,{variant:h?"destructive":"outline",className:"h-5 text-[10px] px-1.5 py-0.5",children:[e.jsx(_e,{className:"h-2.5 w-2.5 mr-1"}),B(r.dueDate)]}),r.estimatedTime&&e.jsxs(V,{variant:"secondary",className:"h-5 text-[10px] px-1.5 py-0.5",children:[e.jsx(de,{className:"h-2.5 w-2.5 mr-1"}),r.estimatedTime,"m"]}),r.timeSpent&&r.timeSpent>0&&e.jsxs(V,{variant:"outline",className:"h-5 text-[10px] px-1.5 py-0.5",children:[e.jsx(de,{className:"h-2.5 w-2.5 mr-1"}),w(r.timeSpent)]}),f.length>0&&e.jsxs(V,{variant:"outline",className:"h-5 text-[10px] px-1.5 py-0.5",children:[e.jsx(Be,{className:"h-2.5 w-2.5 mr-1"}),f.length]}),e.jsx(V,{variant:r.status==="completed"?"default":"secondary",className:"h-5 text-[10px] px-1.5 py-0.5",children:r.status})]})]})]})}),e.jsx("div",{className:"px-3 py-0 border-t border-border/30",children:e.jsx(et,{taskId:r.id,isExpanded:l,onToggleExpanded:()=>m(!l)})}),r.subtasks&&(r.subtasks.length>0||!y)&&e.jsx("div",{className:"px-3 pt-2 py-0 border-t border-border/30",children:e.jsx(tt,{task:r})}),_&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full animate-pulse shadow-glow"})})]}),e.jsx(He,{open:c,onOpenChange:d,onConfirm:P,itemName:r.title})]})});var Fe=1,Zt=.9,er=.8,tr=.17,he=.1,pe=.999,rr=.9999,sr=.99,ar=/[\\\/_+.#"@\[\(\{&]/,nr=/[\\\/_+.#"@\[\(\{&]/g,ir=/[\s-]/,rt=/[\s-]/g;function fe(t,r,s,p,a,o,u){if(o===r.length)return a===t.length?Fe:sr;var f=`${a},${o}`;if(u[f]!==void 0)return u[f];for(var c=p.charAt(o),d=s.indexOf(c,a),l=0,m,g,j,T;d>=0;)m=fe(t,r,s,p,d+1,o+1,u),m>l&&(d===a?m*=Fe:ar.test(t.charAt(d-1))?(m*=er,j=t.slice(a,d-1).match(nr),j&&a>0&&(m*=Math.pow(pe,j.length))):ir.test(t.charAt(d-1))?(m*=Zt,T=t.slice(a,d-1).match(rt),T&&a>0&&(m*=Math.pow(pe,T.length))):(m*=tr,a>0&&(m*=Math.pow(pe,d-a))),t.charAt(d)!==r.charAt(o)&&(m*=rr)),(m<he&&s.charAt(d-1)===p.charAt(o+1)||p.charAt(o+1)===p.charAt(o)&&s.charAt(d-1)!==p.charAt(o))&&(g=fe(t,r,s,p,d+1,o+2,u),g*he>m&&(m=g*he)),m>l&&(l=m),d=s.indexOf(c,d+1);return u[f]=l,l}function $e(t){return t.toLowerCase().replace(rt," ")}function lr(t,r,s){return t=s&&s.length>0?`${t+" "+s.join(" ")}`:t,fe(t,r,$e(t),$e(r),0,0,{})}var ae='[cmdk-group=""]',xe='[cmdk-group-items=""]',or='[cmdk-group-heading=""]',st='[cmdk-item=""]',Le=`${st}:not([aria-disabled="true"])`,ge="cmdk-item-select",Z="data-value",cr=(t,r,s)=>lr(t,r,s),at=i.createContext(void 0),le=()=>i.useContext(at),nt=i.createContext(void 0),Te=()=>i.useContext(nt),it=i.createContext(void 0),lt=i.forwardRef((t,r)=>{let s=ee(()=>{var n,v;return{search:"",value:(v=(n=t.value)!=null?n:t.defaultValue)!=null?v:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),p=ee(()=>new Set),a=ee(()=>new Map),o=ee(()=>new Map),u=ee(()=>new Set),f=ot(t),{label:c,children:d,value:l,onValueChange:m,filter:g,shouldFilter:j,loop:T,disablePointerSelection:E=!1,vimBindings:S=!0,...F}=t,$=te(),_=te(),K=te(),k=i.useRef(null),h=yr();X(()=>{if(l!==void 0){let n=l.trim();s.current.value=n,y.emit()}},[l]),X(()=>{h(6,N)},[]);let y=i.useMemo(()=>({subscribe:n=>(u.current.add(n),()=>u.current.delete(n)),snapshot:()=>s.current,setState:(n,v,b)=>{var x,C,D,U;if(!Object.is(s.current[n],v)){if(s.current[n]=v,n==="search")q(),B(),h(1,w);else if(n==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let A=document.getElementById(K);A?A.focus():(x=document.getElementById($))==null||x.focus()}if(h(7,()=>{var A;s.current.selectedItemId=(A=M())==null?void 0:A.id,y.emit()}),b||h(5,N),((C=f.current)==null?void 0:C.value)!==void 0){let A=v??"";(U=(D=f.current).onValueChange)==null||U.call(D,A);return}}y.emit()}},emit:()=>{u.current.forEach(n=>n())}}),[]),O=i.useMemo(()=>({value:(n,v,b)=>{var x;v!==((x=o.current.get(n))==null?void 0:x.value)&&(o.current.set(n,{value:v,keywords:b}),s.current.filtered.items.set(n,P(v,b)),h(2,()=>{B(),y.emit()}))},item:(n,v)=>(p.current.add(n),v&&(a.current.has(v)?a.current.get(v).add(n):a.current.set(v,new Set([n]))),h(3,()=>{q(),B(),s.current.value||w(),y.emit()}),()=>{o.current.delete(n),p.current.delete(n),s.current.filtered.items.delete(n);let b=M();h(4,()=>{q(),(b==null?void 0:b.getAttribute("id"))===n&&w(),y.emit()})}),group:n=>(a.current.has(n)||a.current.set(n,new Set),()=>{o.current.delete(n),a.current.delete(n)}),filter:()=>f.current.shouldFilter,label:c||t["aria-label"],getDisablePointerSelection:()=>f.current.disablePointerSelection,listId:$,inputId:K,labelId:_,listInnerRef:k}),[]);function P(n,v){var b,x;let C=(x=(b=f.current)==null?void 0:b.filter)!=null?x:cr;return n?C(n,s.current.search,v):0}function B(){if(!s.current.search||f.current.shouldFilter===!1)return;let n=s.current.filtered.items,v=[];s.current.filtered.groups.forEach(x=>{let C=a.current.get(x),D=0;C.forEach(U=>{let A=n.get(U);D=Math.max(A,D)}),v.push([x,D])});let b=k.current;R().sort((x,C)=>{var D,U;let A=x.getAttribute("id"),oe=C.getAttribute("id");return((D=n.get(oe))!=null?D:0)-((U=n.get(A))!=null?U:0)}).forEach(x=>{let C=x.closest(xe);C?C.appendChild(x.parentElement===C?x:x.closest(`${xe} > *`)):b.appendChild(x.parentElement===b?x:x.closest(`${xe} > *`))}),v.sort((x,C)=>C[1]-x[1]).forEach(x=>{var C;let D=(C=k.current)==null?void 0:C.querySelector(`${ae}[${Z}="${encodeURIComponent(x[0])}"]`);D==null||D.parentElement.appendChild(D)})}function w(){let n=R().find(b=>b.getAttribute("aria-disabled")!=="true"),v=n==null?void 0:n.getAttribute(Z);y.setState("value",v||void 0)}function q(){var n,v,b,x;if(!s.current.search||f.current.shouldFilter===!1){s.current.filtered.count=p.current.size;return}s.current.filtered.groups=new Set;let C=0;for(let D of p.current){let U=(v=(n=o.current.get(D))==null?void 0:n.value)!=null?v:"",A=(x=(b=o.current.get(D))==null?void 0:b.keywords)!=null?x:[],oe=P(U,A);s.current.filtered.items.set(D,oe),oe>0&&C++}for(let[D,U]of a.current)for(let A of U)if(s.current.filtered.items.get(A)>0){s.current.filtered.groups.add(D);break}s.current.filtered.count=C}function N(){var n,v,b;let x=M();x&&(((n=x.parentElement)==null?void 0:n.firstChild)===x&&((b=(v=x.closest(ae))==null?void 0:v.querySelector(or))==null||b.scrollIntoView({block:"nearest"})),x.scrollIntoView({block:"nearest"}))}function M(){var n;return(n=k.current)==null?void 0:n.querySelector(`${st}[aria-selected="true"]`)}function R(){var n;return Array.from(((n=k.current)==null?void 0:n.querySelectorAll(Le))||[])}function se(n){let v=R()[n];v&&y.setState("value",v.getAttribute(Z))}function G(n){var v;let b=M(),x=R(),C=x.findIndex(U=>U===b),D=x[C+n];(v=f.current)!=null&&v.loop&&(D=C+n<0?x[x.length-1]:C+n===x.length?x[0]:x[C+n]),D&&y.setState("value",D.getAttribute(Z))}function De(n){let v=M(),b=v==null?void 0:v.closest(ae),x;for(;b&&!x;)b=n>0?vr(b,ae):jr(b,ae),x=b==null?void 0:b.querySelector(Le);x?y.setState("value",x.getAttribute(Z)):G(n)}let Ee=()=>se(R().length-1),Ie=n=>{n.preventDefault(),n.metaKey?Ee():n.altKey?De(1):G(1)},Pe=n=>{n.preventDefault(),n.metaKey?se(0):n.altKey?De(-1):G(-1)};return i.createElement(W.div,{ref:r,tabIndex:-1,...F,"cmdk-root":"",onKeyDown:n=>{var v;(v=F.onKeyDown)==null||v.call(F,n);let b=n.nativeEvent.isComposing||n.keyCode===229;if(!(n.defaultPrevented||b))switch(n.key){case"n":case"j":{S&&n.ctrlKey&&Ie(n);break}case"ArrowDown":{Ie(n);break}case"p":case"k":{S&&n.ctrlKey&&Pe(n);break}case"ArrowUp":{Pe(n);break}case"Home":{n.preventDefault(),se(0);break}case"End":{n.preventDefault(),Ee();break}case"Enter":{n.preventDefault();let x=M();if(x){let C=new Event(ge);x.dispatchEvent(C)}}}}},i.createElement("label",{"cmdk-label":"",htmlFor:O.inputId,id:O.labelId,style:wr},c),me(t,n=>i.createElement(nt.Provider,{value:y},i.createElement(at.Provider,{value:O},n))))}),dr=i.forwardRef((t,r)=>{var s,p;let a=te(),o=i.useRef(null),u=i.useContext(it),f=le(),c=ot(t),d=(p=(s=c.current)==null?void 0:s.forceMount)!=null?p:u==null?void 0:u.forceMount;X(()=>{if(!d)return f.item(a,u==null?void 0:u.id)},[d]);let l=ct(a,o,[t.value,t.children,o],t.keywords),m=Te(),g=J(h=>h.value&&h.value===l.current),j=J(h=>d||f.filter()===!1?!0:h.search?h.filtered.items.get(a)>0:!0);i.useEffect(()=>{let h=o.current;if(!(!h||t.disabled))return h.addEventListener(ge,T),()=>h.removeEventListener(ge,T)},[j,t.onSelect,t.disabled]);function T(){var h,y;E(),(y=(h=c.current).onSelect)==null||y.call(h,l.current)}function E(){m.setState("value",l.current,!0)}if(!j)return null;let{disabled:S,value:F,onSelect:$,forceMount:_,keywords:K,...k}=t;return i.createElement(W.div,{ref:ne(o,r),...k,id:a,"cmdk-item":"",role:"option","aria-disabled":!!S,"aria-selected":!!g,"data-disabled":!!S,"data-selected":!!g,onPointerMove:S||f.getDisablePointerSelection()?void 0:E,onClick:S?void 0:T},t.children)}),ur=i.forwardRef((t,r)=>{let{heading:s,children:p,forceMount:a,...o}=t,u=te(),f=i.useRef(null),c=i.useRef(null),d=te(),l=le(),m=J(j=>a||l.filter()===!1?!0:j.search?j.filtered.groups.has(u):!0);X(()=>l.group(u),[]),ct(u,f,[t.value,t.heading,c]);let g=i.useMemo(()=>({id:u,forceMount:a}),[a]);return i.createElement(W.div,{ref:ne(f,r),...o,"cmdk-group":"",role:"presentation",hidden:m?void 0:!0},s&&i.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:d},s),me(t,j=>i.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":s?d:void 0},i.createElement(it.Provider,{value:g},j))))}),mr=i.forwardRef((t,r)=>{let{alwaysRender:s,...p}=t,a=i.useRef(null),o=J(u=>!u.search);return!s&&!o?null:i.createElement(W.div,{ref:ne(a,r),...p,"cmdk-separator":"",role:"separator"})}),hr=i.forwardRef((t,r)=>{let{onValueChange:s,...p}=t,a=t.value!=null,o=Te(),u=J(d=>d.search),f=J(d=>d.selectedItemId),c=le();return i.useEffect(()=>{t.value!=null&&o.setState("search",t.value)},[t.value]),i.createElement(W.input,{ref:r,...p,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":f,id:c.inputId,type:"text",value:a?t.value:u,onChange:d=>{a||o.setState("search",d.target.value),s==null||s(d.target.value)}})}),pr=i.forwardRef((t,r)=>{let{children:s,label:p="Suggestions",...a}=t,o=i.useRef(null),u=i.useRef(null),f=J(d=>d.selectedItemId),c=le();return i.useEffect(()=>{if(u.current&&o.current){let d=u.current,l=o.current,m,g=new ResizeObserver(()=>{m=requestAnimationFrame(()=>{let j=d.offsetHeight;l.style.setProperty("--cmdk-list-height",j.toFixed(1)+"px")})});return g.observe(d),()=>{cancelAnimationFrame(m),g.unobserve(d)}}},[]),i.createElement(W.div,{ref:ne(o,r),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":f,"aria-label":p,id:c.listId},me(t,d=>i.createElement("div",{ref:ne(u,c.listInnerRef),"cmdk-list-sizer":""},d)))}),xr=i.forwardRef((t,r)=>{let{open:s,onOpenChange:p,overlayClassName:a,contentClassName:o,container:u,...f}=t;return i.createElement(Tt,{open:s,onOpenChange:p},i.createElement(Dt,{container:u},i.createElement(Et,{"cmdk-overlay":"",className:a}),i.createElement(It,{"aria-label":t.label,"cmdk-dialog":"",className:o},i.createElement(lt,{ref:r,...f}))))}),fr=i.forwardRef((t,r)=>J(s=>s.filtered.count===0)?i.createElement(W.div,{ref:r,...t,"cmdk-empty":"",role:"presentation"}):null),gr=i.forwardRef((t,r)=>{let{progress:s,children:p,label:a="Loading...",...o}=t;return i.createElement(W.div,{ref:r,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":s,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},me(t,u=>i.createElement("div",{"aria-hidden":!0},u)))}),z=Object.assign(lt,{List:pr,Item:dr,Input:hr,Group:ur,Separator:mr,Dialog:xr,Empty:fr,Loading:gr});function vr(t,r){let s=t.nextElementSibling;for(;s;){if(s.matches(r))return s;s=s.nextElementSibling}}function jr(t,r){let s=t.previousElementSibling;for(;s;){if(s.matches(r))return s;s=s.previousElementSibling}}function ot(t){let r=i.useRef(t);return X(()=>{r.current=t}),r}var X=typeof window>"u"?i.useEffect:i.useLayoutEffect;function ee(t){let r=i.useRef();return r.current===void 0&&(r.current=t()),r}function J(t){let r=Te(),s=()=>t(r.snapshot());return i.useSyncExternalStore(r.subscribe,s,s)}function ct(t,r,s,p=[]){let a=i.useRef(),o=le();return X(()=>{var u;let f=(()=>{var d;for(let l of s){if(typeof l=="string")return l.trim();if(typeof l=="object"&&"current"in l)return l.current?(d=l.current.textContent)==null?void 0:d.trim():a.current}})(),c=p.map(d=>d.trim());o.value(t,f,c),(u=r.current)==null||u.setAttribute(Z,f),a.current=f}),a}var yr=()=>{let[t,r]=i.useState(),s=ee(()=>new Map);return X(()=>{s.current.forEach(p=>p()),s.current=new Map},[t]),(p,a)=>{s.current.set(p,a),r({})}};function br(t){let r=t.type;return typeof r=="function"?r(t.props):"render"in r?r.render(t.props):t}function me({asChild:t,children:r},s){return t&&i.isValidElement(r)?i.cloneElement(br(r),{ref:r.ref},s(r.props.children)):s(r)}var wr={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const dt=i.forwardRef(({className:t,...r},s)=>e.jsx(z,{ref:s,className:L("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...r}));dt.displayName=z.displayName;const ut=i.forwardRef(({className:t,...r},s)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(Pt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(z.Input,{ref:s,className:L("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...r})]}));ut.displayName=z.Input.displayName;const mt=i.forwardRef(({className:t,...r},s)=>e.jsx(z.List,{ref:s,className:L("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...r}));mt.displayName=z.List.displayName;const ht=i.forwardRef((t,r)=>e.jsx(z.Empty,{ref:r,className:"py-6 text-center text-sm",...t}));ht.displayName=z.Empty.displayName;const pt=i.forwardRef(({className:t,...r},s)=>e.jsx(z.Group,{ref:s,className:L("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...r}));pt.displayName=z.Group.displayName;const Nr=i.forwardRef(({className:t,...r},s)=>e.jsx(z.Separator,{ref:s,className:L("-mx-1 h-px bg-border",t),...r}));Nr.displayName=z.Separator.displayName;const xt=i.forwardRef(({className:t,...r},s)=>e.jsx(z.Item,{ref:s,className:L("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",t),...r}));xt.displayName=z.Item.displayName;function Cr({options:t,selected:r,onChange:s,placeholder:p="Select items...",label:a,className:o}){const[u,f]=i.useState(!1),c=l=>{s(r.filter(m=>m!==l))},d=l=>{r.includes(l)?s(r.filter(m=>m!==l)):s([...r,l])};return e.jsxs("div",{className:L("grid gap-2",o),children:[a&&e.jsx("label",{className:"text-sm font-medium",children:a}),e.jsxs(Rt,{open:u,onOpenChange:f,children:[e.jsx(kt,{asChild:!0,children:e.jsxs(I,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-full justify-between text-left font-normal",onClick:()=>f(!u),children:[e.jsx("div",{className:"flex gap-1 flex-wrap",children:r.length>0?r.map(l=>{const m=t.find(g=>g.value===l);return e.jsxs(V,{variant:"secondary",className:"mr-1 mb-1",onClick:g=>{g.preventDefault(),g.stopPropagation(),c(l)},children:[m==null?void 0:m.label,e.jsx("button",{className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",onKeyDown:g=>{g.key==="Enter"&&c(l)},onMouseDown:g=>{g.preventDefault(),g.stopPropagation()},onClick:g=>{g.preventDefault(),g.stopPropagation(),c(l)},children:e.jsx(ze,{className:"h-3 w-3 text-muted-foreground hover:text-foreground"})})]},l)}):e.jsx("span",{className:"text-muted-foreground",children:p})}),e.jsx(_t,{className:"h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Mt,{className:"w-full p-0",children:e.jsxs(dt,{children:[e.jsx(ut,{placeholder:"Search..."}),e.jsx(ht,{children:"No item found."}),e.jsx(pt,{children:e.jsx(mt,{children:t.map(l=>e.jsxs(xt,{onSelect:()=>d(l.value),children:[e.jsx(At,{className:L("mr-2 h-4 w-4",r.includes(l.value)?"opacity-100":"opacity-0")}),l.label]},l.value))})})]})})]})]})}function Sr({members:t,selectedIds:r,onSelectionChange:s,label:p="Assigned Members",placeholder:a="Select team members"}){const o=t.map(u=>({label:u.displayName||u.email,value:u.uid}));return e.jsx(Cr,{options:o,selected:r,onChange:s,label:p,placeholder:a})}function Kr({task:t,onSubmit:r,onCancel:s,teamMembers:p}){var f;const[a,o]=i.useState({title:(t==null?void 0:t.title)||"",description:(t==null?void 0:t.description)||"",priority:(t==null?void 0:t.priority)||"medium",status:(t==null?void 0:t.status)||"todo",estimatedTime:((f=t==null?void 0:t.estimatedTime)==null?void 0:f.toString())||"",dueDate:(t==null?void 0:t.dueDate)||"",assignedTo:(t==null?void 0:t.assignedTo)||[]}),u=c=>{c.preventDefault(),r({...a,estimatedTime:a.estimatedTime?parseInt(a.estimatedTime,10):void 0,assignedTo:a.assignedTo})};return e.jsxs("form",{onSubmit:u,className:"space-y-6 py-4",children:[e.jsxs("div",{children:[e.jsx(Y,{htmlFor:"title",className:"text-sm font-medium",children:"Title *"}),e.jsx(ce,{id:"title",value:a.title,onChange:c=>o({...a,title:c.target.value}),placeholder:"Enter task title",className:"mt-2 transition-smooth focus:ring-2 focus:ring-primary/20",required:!0})]}),e.jsxs("div",{children:[e.jsx(Y,{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),e.jsx(We,{id:"description",value:a.description,onChange:c=>o({...a,description:c.target.value}),placeholder:"Enter task description",className:"mt-2 transition-smooth focus:ring-2 focus:ring-primary/20",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Y,{htmlFor:"priority",className:"text-sm font-medium",children:"Priority"}),e.jsxs(Re,{value:a.priority,onValueChange:c=>o({...a,priority:c}),children:[e.jsx(ke,{className:"mt-2",children:e.jsx(Me,{})}),e.jsxs(Ae,{children:[e.jsx(Q,{value:"low",children:"Low"}),e.jsx(Q,{value:"medium",children:"Medium"}),e.jsx(Q,{value:"high",children:"High"})]})]})]}),e.jsxs("div",{children:[e.jsx(Y,{htmlFor:"status",className:"text-sm font-medium",children:"Status"}),e.jsxs(Re,{value:a.status,onValueChange:c=>o({...a,status:c}),children:[e.jsx(ke,{className:"mt-2",children:e.jsx(Me,{})}),e.jsxs(Ae,{children:[e.jsx(Q,{value:"todo",children:"To Do"}),e.jsx(Q,{value:"in-progress",children:"In Progress"}),e.jsx(Q,{value:"completed",children:"Completed"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(Y,{htmlFor:"estimatedTime",className:"text-sm font-medium",children:"Estimated Time (minutes)"}),e.jsx(ce,{id:"estimatedTime",type:"number",value:a.estimatedTime,onChange:c=>o({...a,estimatedTime:c.target.value}),placeholder:"25",className:"mt-2 transition-smooth focus:ring-2 focus:ring-primary/20",min:"1"})]}),e.jsxs("div",{children:[e.jsx(Y,{htmlFor:"dueDate",className:"text-sm font-medium",children:"Due Date"}),e.jsx(ce,{id:"dueDate",type:"datetime-local",value:a.dueDate,onChange:c=>o({...a,dueDate:c.target.value}),className:"mt-2 transition-smooth focus:ring-2 focus:ring-primary/20"})]})]}),p.length>0&&e.jsx("div",{children:e.jsx(Sr,{members:p,selectedIds:a.assignedTo,onSelectionChange:c=>o({...a,assignedTo:c})})}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx(I,{type:"submit",variant:"focus",className:"flex-1",children:t?"Update Task":"Create Task"}),e.jsx(I,{type:"button",variant:"outline",onClick:s,className:"hover-scale",children:"Cancel"})]})]})}export{zr as M,Lr as T,Kr as a};
