import{c as H,r as i,b4 as be,bT as Ve,j as e,b6 as Be,a$ as we,b7 as Le,bU as $e,bV as ze,v as le,V as De,bW as He,a9 as de,L as M,e as L,h as $,A as K,ay as oe,l as W,bu as Pe,p as G,N as me,B as j,U as he,n as Ye,f as J,g as Z,O as Oe,aa as xe,ab as _,ac as F,ad as U,ae as A,I as z,af as ue,q as S,br as Xe,bX as Ke,b1 as We,X as Ge,al as D,bY as c,ag as pe,ah as ke,ai as Je,bZ as Ze}from"./index-C20fHVmm.js";import{S as fe}from"./separator-BDnYhoo8.js";import{S as je,a as ge,b as Ne,c as ve,d as w}from"./select-DzEN2igF.js";import{C as Qe}from"./circle-alert-x52EUvXx.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],ss=H("globe",es);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],ts=H("palette",as);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],ns=H("shield",rs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],ye=H("user-plus",cs);var P="Switch",[is]=Be(P),[ls,ds]=is(P),Ce=i.forwardRef((t,a)=>{const{__scopeSwitch:n,name:u,checked:h,defaultChecked:E,required:g,disabled:p,value:N="on",onCheckedChange:l,form:x,...R}=t,[f,v]=i.useState(null),o=be(a,b=>v(b)),y=i.useRef(!1),T=f?x||!!f.closest("form"):!0,[k,Y]=Ve({prop:h,defaultProp:E??!1,onChange:l,caller:P});return e.jsxs(ls,{scope:n,checked:k,disabled:p,children:[e.jsx(we.button,{type:"button",role:"switch","aria-checked":k,"aria-required":g,"data-state":Te(k),"data-disabled":p?"":void 0,disabled:p,value:N,...R,ref:o,onClick:Le(t.onClick,b=>{Y(C=>!C),T&&(y.current=b.isPropagationStopped(),y.current||b.stopPropagation())})}),T&&e.jsx(Re,{control:f,bubbles:!y.current,name:u,value:N,checked:k,required:g,disabled:p,form:x,style:{transform:"translateX(-100%)"}})]})});Ce.displayName=P;var Se="SwitchThumb",Ee=i.forwardRef((t,a)=>{const{__scopeSwitch:n,...u}=t,h=ds(Se,n);return e.jsx(we.span,{"data-state":Te(h.checked),"data-disabled":h.disabled?"":void 0,...u,ref:a})});Ee.displayName=Se;var os="SwitchBubbleInput",Re=i.forwardRef(({__scopeSwitch:t,control:a,checked:n,bubbles:u=!0,...h},E)=>{const g=i.useRef(null),p=be(g,E),N=$e(n),l=ze(a);return i.useEffect(()=>{const x=g.current;if(!x)return;const R=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(R,"checked").set;if(N!==n&&v){const o=new Event("click",{bubbles:u});v.call(x,n),x.dispatchEvent(o)}},[N,n,u]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...h,tabIndex:-1,ref:p,style:{...h.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Re.displayName=os;function Te(t){return t?"checked":"unchecked"}var qe=Ce,ms=Ee;const Ie=i.forwardRef(({className:t,...a},n)=>e.jsx(qe,{className:le("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:n,children:e.jsx(ms,{className:le("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Ie.displayName=qe.displayName;const hs=ke({displayName:D().min(2,"Name must be at least 2 characters"),email:D().email("Invalid email address")}),xs=ke({notifications:Ze().optional(),theme:Je(["light","dark","system"]).optional(),language:D().optional()});function gs(){var se,ae,te,re,ne,ce,ie;const{user:t,userProfile:a,updateUserProfile:n,sendVerificationEmail:u,sendTeamRequest:h,fetchReceivedTeamRequests:E,acceptTeamRequest:g,declineTeamRequest:p,fetchTeamMembers:N,loading:l}=De(),{theme:x,setTheme:R}=He(),[f,v]=i.useState(!1),[o,y]=i.useState(""),[T,k]=i.useState([]),[Y,b]=i.useState([]),[C,Q]=i.useState(!1);i.useEffect(()=>{t&&(O(),ee())},[t,a==null?void 0:a.teamId]);const O=async()=>{if(!t)return;const s=await E();k(s)},ee=async()=>{if(!t||!(a!=null&&a.teamId)){b([]);return}const s=await N();b(s)},V=async()=>{if(!o.trim())return;const s=o.split(",").map(r=>r.trim()).filter(r=>D().email().safeParse(r).success);if(s.length===0){c({title:"Invalid Email",description:"Please provide at least one valid email address.",variant:"destructive"});return}try{Q(!0);const r=await Promise.allSettled(s.map(m=>h(m))),d=r.filter(m=>m.status==="fulfilled").length,I=r.filter(m=>m.status==="rejected").length;d>0?c({title:"Team requests sent!",description:`Successfully sent ${d} request${d!==1?"s":""}${I>0?`. ${I} failed.`:"."}`}):c({title:"Failed to send requests",description:"Please check the email addresses and try again.",variant:"destructive"}),y("")}catch(r){console.error("Error sending team request:",r),c({title:"An error occurred",description:r.message||"Could not send team requests.",variant:"destructive"})}finally{Q(!1)}},Me=async(s,r)=>{try{await g(s,r),await O(),await ee(),c({title:"Team request accepted!",description:"You've joined a new team."})}catch(d){console.error("Error accepting request:",d),c({title:"Error",description:d.message,variant:"destructive"})}},_e=async s=>{try{await p(s),await O(),c({title:"Request declined."})}catch(r){console.error("Error declining request:",r),c({title:"Error",description:r.message,variant:"destructive"})}},B=de({resolver:pe(hs),defaultValues:{displayName:(a==null?void 0:a.displayName)||"",email:(t==null?void 0:t.email)||""},values:{displayName:(a==null?void 0:a.displayName)||"",email:(t==null?void 0:t.email)||""}}),q=de({resolver:pe(xs),defaultValues:{notifications:((se=a==null?void 0:a.preferences)==null?void 0:se.notifications)??!0,theme:((ae=a==null?void 0:a.preferences)==null?void 0:ae.theme)||x||"system",language:((te=a==null?void 0:a.preferences)==null?void 0:te.language)||"en"},values:{notifications:((re=a==null?void 0:a.preferences)==null?void 0:re.notifications)??!0,theme:((ne=a==null?void 0:a.preferences)==null?void 0:ne.theme)||x||"system",language:((ce=a==null?void 0:a.preferences)==null?void 0:ce.language)||"en"}}),Fe=async s=>{try{await n({displayName:s.displayName}),v(!1),c({title:"Profile updated successfully!"})}catch(r){console.error("Error updating profile:",r),c({title:"Error",description:r.message,variant:"destructive"})}},Ue=async s=>{var r,d,I;try{s.theme&&R(s.theme);const m={notifications:s.notifications??((r=a==null?void 0:a.preferences)==null?void 0:r.notifications)??!0,theme:s.theme??((d=a==null?void 0:a.preferences)==null?void 0:d.theme)??"system",language:s.language??((I=a==null?void 0:a.preferences)==null?void 0:I.language)??"en"};await n({preferences:m}),c({title:"Preferences saved!"})}catch(m){console.error("Error updating preferences:",m),c({title:"Error",description:m.message,variant:"destructive"})}},Ae=async()=>{try{await u(),c({title:"Verification email sent!",description:"Check your inbox to verify your email address."})}catch(s){console.error("Error sending verification email:",s),c({title:"Error",description:s.message,variant:"destructive"})}},X=(s,r)=>s&&s.trim()?s.split(" ").map(d=>d[0]).join("").toUpperCase().slice(0,2):r?r.split("@")[0].slice(0,2).toUpperCase():"??";return!t||!a?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(M,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsx("div",{className:"container mx-auto p-4 md:p-6 lg:p-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(L,{className:"shadow-elegant lg:col-span-1",children:e.jsxs($,{className:"pt-6 flex flex-col items-center text-center",children:[e.jsxs(K,{className:"h-24 w-24 mb-4",children:[e.jsx(oe,{src:a.photoURL||"",alt:a.displayName||""}),e.jsx(W,{className:"text-3xl",children:X(a.displayName,a.email)})]}),e.jsx("h2",{className:"text-2xl font-semibold",children:a.displayName}),e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(Pe,{className:"h-3 w-3"}),a.email]}),e.jsx("div",{className:"mt-4",children:t.emailVerified?e.jsxs(G,{variant:"secondary",className:"border-green-500/50 bg-green-500/10 text-green-700 dark:text-green-400",children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),"Verified"]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs(G,{variant:"destructive",children:[e.jsx(Qe,{className:"h-3 w-3 mr-1"}),"Not Verified"]}),e.jsx(j,{variant:"link",className:"h-auto p-0 text-xs",onClick:Ae,disabled:l,children:"Resend verification email"})]})}),e.jsx(fe,{className:"my-6"}),e.jsxs("div",{className:"w-full text-left space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-center mb-2 uppercase tracking-wider text-muted-foreground",children:"Account Status"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(he,{className:"h-4 w-4"})," Team Status"]}),e.jsx("span",{className:"font-medium",children:a.teamId?"In a Team":"No Team"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ns,{className:"h-4 w-4"})," Account"]}),e.jsx("span",{className:"font-medium",children:"Member"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ye,{className:"h-4 w-4"})," Joined"]}),e.jsx("span",{className:"font-medium",children:(ie=t.metadata)!=null&&ie.creationTime?new Date(t.metadata.creationTime).toLocaleDateString():"N/A"})]})]})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(L,{className:"shadow-elegant",children:[e.jsx(J,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Z,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5"}),"Basic Information"]}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>v(!f),children:f?"Cancel":"Edit"})]})}),e.jsx($,{children:f?e.jsx(xe,{...B,children:e.jsxs("form",{onSubmit:B.handleSubmit(Fe),className:"space-y-4",children:[e.jsx(_,{control:B.control,name:"displayName",render:({field:s})=>e.jsxs(F,{children:[e.jsx(U,{children:"Display Name"}),e.jsx(A,{children:e.jsx(z,{placeholder:"Your name",...s})}),e.jsx(ue,{})]})}),e.jsx(_,{control:B.control,name:"email",render:({field:s})=>e.jsxs(F,{children:[e.jsx(U,{children:"Email Address"}),e.jsx(A,{children:e.jsx(z,{placeholder:"your@email.com",...s,disabled:!0})}),e.jsx(ue,{}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Email cannot be changed for security reasons."})]})}),e.jsx(j,{type:"submit",disabled:l,variant:"focus",children:l?e.jsx(M,{className:"h-4 w-4 mr-2 animate-spin"}):"Save Changes"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{className:"text-sm font-medium",children:"Display Name"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.displayName||"Not set"})]}),e.jsxs("div",{children:[e.jsx(S,{className:"text-sm font-medium",children:"Email Address"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.email})]})]})})]}),e.jsxs(L,{className:"shadow-elegant",children:[e.jsx(J,{children:e.jsxs(Z,{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"h-5 w-5"}),"Preferences"]})}),e.jsx($,{children:e.jsx(xe,{...q,children:e.jsxs("form",{onSubmit:q.handleSubmit(Ue),className:"space-y-6",children:[e.jsx(_,{control:q.control,name:"notifications",render:({field:s})=>e.jsxs(F,{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs(U,{className:"flex items-center gap-2 text-base",children:[e.jsx(Ke,{className:"h-4 w-4"}),"Push Notifications"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive notifications for tasks and reminders."})]}),e.jsx(A,{children:e.jsx(Ie,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(_,{control:q.control,name:"theme",render:({field:s})=>e.jsxs(F,{children:[e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(ts,{className:"h-4 w-4"}),"Theme"]}),e.jsxs(je,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(A,{children:e.jsx(ge,{children:e.jsx(Ne,{placeholder:"Select theme"})})}),e.jsxs(ve,{children:[e.jsx(w,{value:"light",children:"Light"}),e.jsx(w,{value:"dark",children:"Dark"}),e.jsx(w,{value:"system",children:"System"})]})]})]})}),e.jsx(_,{control:q.control,name:"language",render:({field:s})=>e.jsxs(F,{children:[e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(ss,{className:"h-4 w-4"}),"Language"]}),e.jsxs(je,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(A,{children:e.jsx(ge,{children:e.jsx(Ne,{placeholder:"Select language"})})}),e.jsxs(ve,{children:[e.jsx(w,{value:"en",children:"English"}),e.jsx(w,{value:"es",children:"Español"}),e.jsx(w,{value:"fr",children:"Français"}),e.jsx(w,{value:"de",children:"Deutsch"})]})]})]})}),e.jsx(j,{type:"submit",disabled:l,variant:"focus",children:l?e.jsx(M,{className:"h-4 w-4 mr-2 animate-spin"}):"Save Preferences"})]})})})]}),e.jsxs(L,{className:"shadow-elegant",children:[e.jsx(J,{children:e.jsxs(Z,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5"}),"Team Collaboration"]})}),e.jsx($,{children:e.jsxs("div",{className:"space-y-6",children:[a!=null&&a.teamId?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-green-500/5 border border-green-500/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(me,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"font-medium text-green-600 dark:text-green-400",children:"You're part of a team!"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx(S,{className:"text-sm font-medium",children:"Team Members"}),e.jsx("div",{className:"mt-2 space-y-2",children:Y.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background/50 rounded-lg",children:[e.jsxs(K,{className:"h-8 w-8",children:[e.jsx(oe,{src:s.photoURL||""}),e.jsx(W,{className:"text-xs",children:X(s.displayName,s.email)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:s.displayName||"User"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.email})]}),s.uid===(t==null?void 0:t.uid)&&e.jsx(G,{variant:"secondary",className:"text-xs",children:"You"})]},s.uid))})]})})]}),e.jsx(fe,{}),e.jsxs("div",{children:[e.jsx(S,{htmlFor:"teamRequestEmail",className:"text-sm font-medium",children:"Invite More Members"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(z,{id:"teamRequestEmail",type:"text",placeholder:"colleague1@example.com, colleague2@example.com",value:o,onChange:s=>y(s.target.value),onKeyPress:s=>s.key==="Enter"&&V(),className:"flex-1"}),e.jsx(j,{onClick:V,disabled:!o.trim()||C,variant:"focus",className:"hover-scale",children:C?e.jsx(M,{className:"h-4 w-4 animate-spin"}):e.jsx(ye,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Send collaboration requests (separate multiple emails with commas)."})]})]}):e.jsxs("div",{children:[e.jsx(S,{htmlFor:"teamRequestEmail",className:"text-sm font-medium",children:"Invite Team Member"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(z,{id:"teamRequestEmail",type:"text",placeholder:"colleague1@example.com, colleague2@example.com",value:o,onChange:s=>y(s.target.value),onKeyPress:s=>s.key==="Enter"&&V(),className:"flex-1"}),e.jsx(j,{onClick:V,disabled:!o.trim()||C,variant:"focus",className:"hover-scale",children:C?e.jsx(M,{className:"h-4 w-4 animate-spin"}):e.jsx(ye,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Send a request to start a team or join an existing one."})]}),T.length>0&&e.jsxs("div",{children:[e.jsx(S,{className:"text-sm font-medium",children:"Pending Requests"}),e.jsx("div",{className:"mt-2 space-y-2",children:T.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(K,{className:"h-8 w-8",children:e.jsx(W,{className:"text-xs",children:X(s.senderName,s.senderEmail)})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s.senderName||"User"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.senderEmail})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{size:"icon",variant:"outline",onClick:()=>Me(s.id,s.senderId),disabled:l,className:"h-8 w-8 hover-scale text-green-500 hover:bg-green-500/10 hover:border-green-500/20",children:e.jsx(We,{className:"h-4 w-4"})}),e.jsx(j,{size:"icon",variant:"outline",onClick:()=>_e(s.id),disabled:l,className:"h-8 w-8 hover-scale text-red-500 hover:bg-red-500/10 hover:border-red-500/20",children:e.jsx(Ge,{className:"h-4 w-4"})})]})]},s.id))})]})]})})]})]})]})})}export{gs as default};
