import{av as je,aw as fe,F as ve,az as Ne,u as ye,r as j,j as e,m as r,aA as Ce,C as we,e as y,f as S,g as F,h as C,Z as be,S as Te,U as A,A as ke,aB as Se,k as Fe,B as D,q as f,$ as Ae,I as De,o as Re,p as Le,l as Me,s as Pe}from"./index-BOMCLsi_.js";import{S as W,a as Z,b as J,c as K,d}from"./select-QNqOlXgW.js";import{C as Ie}from"./calendar-D4ZJ7g6y.js";import{D as $e,g as Ee,F as Be,a as Ue,b as ze,c as Oe,h as Ve,i as He}from"./drawer-CtMx6SxT.js";import{a as Ye,M as qe,T as Ge}from"./TaskForm-DsTePK1p.js";import{F as We,A as Ze,C as Je}from"./ContributionGraph-DBtThH0U.js";import{D as Ke,m}from"./skeletons-OrUvxu0E.js";import{P as R}from"./plus-jVcLPC9x.js";import{T as Q}from"./target-1Bj3qq1r.js";import{T as Qe}from"./trending-up-D0DttzfC.js";import{A as Xe}from"./award-BbtgAuia.js";import{A as X}from"./index-DvSqf5q0.js";import{U as _}from"./user-plus-MUTCKdY9.js";import{f as L}from"./format-BmZa2Fkx.js";import"./index-CqAVEad7.js";import"./chevron-down-QVhbesXr.js";import"./en-US-DSSwd-Ay.js";import"./endOfMonth-BNqLjwTF.js";import"./DeleteConfirmationDialog-ZXLq3vwY.js";import"./useTouchGestures-BNpwY5ui.js";import"./textarea-iMbD7bqt.js";import"./send-5-KT-IdZ.js";import"./checkbox-pEVMzDLQ.js";const _e={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},w={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}};function ws(){const{tasks:M,teamMembers:l,setTaskFormActive:b,addTask:ee,updateTask:se,deleteTask:P,toggleTaskStatus:I,toggleTaskPriority:$,getTotalTasksCount:ae,getCompletedTasksCount:te,getActiveTasksCount:re,getCurrentStreak:ie,getLongestStreak:le,loading:ne}=je(),{startTaskTimer:oe}=fe(),{user:i,userProfile:x,loading:ce}=ve(),E=Ne(),n=ye(),[o,v]=j.useState(null),[N,u]=j.useState(!1),[de,B]=j.useState(!1),[a,g]=j.useState({status:"all",priority:"all",dateRange:{from:void 0,to:void 0},search:""});j.useEffect(()=>(b(N||!!o),()=>b(!1)),[N,o,b]);const me=ne||ce,p=ae(),U=te(),xe=re(),z=ie(),O=le(),he=p>0?Math.round(U/p*100):0,T=M.filter(s=>{var t;if(a.status!=="all"&&s.status!==a.status||a.priority!=="all"&&s.priority!==a.priority||a.search&&!s.title.toLowerCase().includes(a.search.toLowerCase())&&!((t=s.description)!=null&&t.toLowerCase().includes(a.search.toLowerCase())))return!1;if(a.dateRange.from||a.dateRange.to){const c=new Date(s.createdAt);if(a.dateRange.from&&c<a.dateRange.from||a.dateRange.to&&c>a.dateRange.to)return!1}return!0}),ue=s=>{const t={...s,createdBy:(i==null?void 0:i.uid)||null};t.estimatedTime===void 0&&delete t.estimatedTime,ee(t),u(!1)},ge=s=>{o&&(se(o.id,s),v(null))},V=s=>{const t=M.find(c=>c.id===s);t&&oe(t)},H=()=>{g({status:"all",priority:"all",dateRange:{from:void 0,to:void 0},search:""}),n&&B(!1)},k=()=>{let s=0;return a.status!=="all"&&s++,a.priority!=="all"&&s++,a.search&&s++,a.dateRange.from&&s++,s},Y=s=>!s||s.length===0?[]:s.map(t=>l.find(c=>c.uid===t)).filter(t=>t!==void 0);if(me)return e.jsx(Ke,{});if(N||o)return e.jsx("div",{className:"container max-w-2xl mx-auto p-4 sm:p-6",children:e.jsx(Ye,{task:o,onSubmit:o?ge:ue,onCancel:()=>{u(!1),v(null)},teamMembers:l})});const h=({title:s,value:t,icon:c,colorClass:G,bgColorClass:pe})=>e.jsx(m.div,{variants:w,children:e.jsx(y,{className:"shadow-elegant overflow-hidden",children:e.jsxs(C,{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:s}),e.jsx("p",{className:f("text-xl sm:text-2xl font-bold",G),children:t})]}),e.jsx("div",{className:f("h-10 w-10 sm:h-12 sm:w-12 rounded-lg flex items-center justify-center",pe),children:e.jsx(c,{className:f("h-5 w-5 sm:h-6 sm:w-6",G)})})]})})}),q=({inDrawer:s=!1})=>e.jsxs("div",{className:f("grid gap-4",s?"grid-cols-1 p-4":"sm:grid-cols-2 lg:grid-cols-4"),children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(De,{placeholder:"Search tasks...",value:a.search,onChange:t=>g({...a,search:t.target.value}),className:"pl-10"})]}),e.jsxs(W,{value:a.status,onValueChange:t=>g({...a,status:t}),children:[e.jsx(Z,{children:e.jsx(J,{placeholder:"Filter by status"})}),e.jsxs(K,{children:[e.jsx(d,{value:"all",children:"All Status"}),e.jsx(d,{value:"todo",children:"To Do"}),e.jsx(d,{value:"in-progress",children:"In Progress"}),e.jsx(d,{value:"completed",children:"Completed"})]})]}),e.jsxs(W,{value:a.priority,onValueChange:t=>g({...a,priority:t}),children:[e.jsx(Z,{children:e.jsx(J,{placeholder:"Filter by priority"})}),e.jsxs(K,{children:[e.jsx(d,{value:"all",children:"All Priority"}),e.jsx(d,{value:"low",children:"Low"}),e.jsx(d,{value:"medium",children:"Medium"}),e.jsx(d,{value:"high",children:"High"})]})]}),e.jsxs(Re,{children:[e.jsx(Le,{asChild:!0,children:e.jsxs(r,{variant:"outline",className:f("justify-start text-left font-normal",!a.dateRange.from&&"text-muted-foreground"),children:[e.jsx(Me,{className:"mr-2 h-4 w-4"}),a.dateRange.from?a.dateRange.to?`${L(a.dateRange.from,"LLL dd")} - ${L(a.dateRange.to,"LLL dd")}`:L(a.dateRange.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date range"})]})}),e.jsx(Pe,{className:"w-auto p-0",align:"start",children:e.jsx(Ie,{initialFocus:!0,mode:"range",selected:a.dateRange,onSelect:t=>g({...a,dateRange:{from:t==null?void 0:t.from,to:t==null?void 0:t.to}}),numberOfMonths:n?1:2})})]})]});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"container max-w-7xl mx-auto p-4 md:p-6 space-y-6",children:[e.jsx(m.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"Dashboard"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Welcome back, ",(x==null?void 0:x.displayName)||(i==null?void 0:i.email),"!"]})]}),!n&&e.jsxs(r,{onClick:()=>u(!0),variant:"focus",className:"hover-scale",children:[e.jsx(R,{className:"h-4 w-4 mr-2"})," New Task"]})]})}),e.jsxs(m.div,{variants:_e,initial:"hidden",animate:"visible",className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:[e.jsx(h,{title:"Total Tasks",value:p,icon:Q,colorClass:"text-primary",bgColorClass:"bg-primary/10"}),e.jsx(h,{title:"Completed",value:U,icon:Ce,colorClass:"text-success",bgColorClass:"bg-success/10"}),e.jsx(h,{title:"Active Tasks",value:xe,icon:we,colorClass:"text-focus",bgColorClass:"bg-focus/10"}),e.jsx(h,{title:"Completion Rate",value:`${he}%`,icon:Qe,colorClass:"text-break",bgColorClass:"bg-break/10"}),e.jsx(h,{title:"Current Streak",value:`${z} ${z===1?"day":"days"}`,icon:We,colorClass:"text-orange-500",bgColorClass:"bg-orange-500/10"}),e.jsx(h,{title:"Longest Streak",value:`${O} ${O===1?"day":"days"}`,icon:Xe,colorClass:"text-purple-500",bgColorClass:"bg-purple-500/10"})]}),!n&&e.jsx(m.div,{variants:w,initial:"hidden",animate:"visible",children:e.jsxs(y,{className:"shadow-elegant",children:[e.jsx(S,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-5 w-5"}),"Activity Overview"]})}),e.jsx(C,{children:e.jsx(Je,{})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(m.div,{variants:w,initial:"hidden",animate:"visible",className:"lg:col-span-2",children:e.jsxs(y,{className:"shadow-elegant",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5"}),"Task Management"]}),!n&&k()>0&&e.jsx(r,{variant:"outline",size:"sm",onClick:H,className:"hover-scale",children:"Clear Filters"})]})}),e.jsxs(C,{className:"space-y-4 p-4 md:p-6",children:[n?e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 text-sm text-muted-foreground",children:["Showing ",T.length," of ",p," tasks"]}),e.jsxs($e,{open:de,onOpenChange:B,children:[e.jsx(Ee,{asChild:!0,children:e.jsxs(r,{variant:"outline",size:"sm",className:"shrink-0",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Filters"}),k()>0&&e.jsx(D,{variant:"secondary",className:"ml-2 px-1.5 py-0.5 text-xs",children:k()})]})}),e.jsxs(Ue,{children:[e.jsx(ze,{children:e.jsx(Oe,{children:"Filter Tasks"})}),e.jsx(q,{inDrawer:!0}),e.jsxs(Ve,{className:"flex-row gap-2",children:[e.jsx(He,{asChild:!0,children:e.jsx(r,{variant:"outline",className:"flex-1",children:"Close"})}),e.jsx(r,{onClick:H,variant:"destructive",className:"flex-1",children:"Clear Filters"})]})]})]})]}):e.jsx(q,{}),e.jsx(Te,{className:"h-[500px]",children:T.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-12 px-4",children:[e.jsx(Q,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground/30"}),e.jsx("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No tasks found"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4 max-w-xs",children:p===0?"Create your first task to get started.":"Try adjusting your filters or create a new task."}),e.jsxs(r,{onClick:()=>u(!0),variant:"focus",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Create Task"]})]}):e.jsx("div",{className:"space-y-3 pr-3",children:e.jsx(X,{children:T.map(s=>e.jsx(m.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,transition:{duration:.2}},children:n?e.jsx(qe,{task:s,onEdit:v,onDelete:P,onToggleStatus:I,onTogglePriority:$,onStartTimer:V,assignedProfiles:Y(s.assignedTo)},s.id):e.jsx(Ge,{task:s,onEdit:v,onDelete:P,onToggleStatus:I,onTogglePriority:$,onStartTimer:V,assignedProfiles:Y(s.assignedTo)},s.id)},s.id))})})})]})]})}),e.jsx(m.div,{variants:w,initial:"hidden",animate:"visible",children:e.jsxs(y,{className:"shadow-elegant",children:[e.jsx(S,{children:e.jsxs(F,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Team Collaboration"]})}),e.jsx(C,{className:"space-y-6 p-4 md:p-6",children:x!=null&&x.teamId&&l.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-success/5 border border-success/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(A,{className:"h-4 w-4 text-success"}),e.jsx("span",{className:"font-medium text-success text-base",children:"Active Team"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[l.length," member",l.length!==1?"s":""," collaborating"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3 text-base",children:"Team Members"}),e.jsxs("div",{className:"space-y-2",children:[l.slice(0,4).map(s=>{var t;return e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-muted/30 rounded-lg",children:[e.jsxs(ke,{className:"h-8 w-8",children:[e.jsx(Se,{src:s.photoURL||""}),e.jsx(Fe,{className:"text-xs bg-primary/20 text-primary",children:((t=s.displayName)==null?void 0:t.slice(0,2).toUpperCase())||s.email.slice(0,2).toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate text-sm",children:s.displayName||"Team Member"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.email})]}),s.uid===(i==null?void 0:i.uid)&&e.jsx(D,{variant:"secondary",className:"text-xs px-1 py-0",children:"You"})]},s.uid)}),l.length>4&&e.jsx("div",{className:"text-center py-1",children:e.jsxs(D,{variant:"outline",className:"text-xs",children:["+",l.length-4," more"]})})]})]}),e.jsxs(r,{onClick:()=>E("/profile"),variant:"outline",className:"w-full hover-scale",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Invite More Members"]})]}):e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-primary/10 to-focus/10 rounded-2xl flex items-center justify-center h-16 w-16 mx-auto shadow-elegant",children:e.jsx(A,{className:"h-8 w-8 text-muted-foreground/50"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-muted-foreground mb-1",children:"No Team Yet"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Invite members to collaborate on tasks and boost productivity."})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsxs(r,{onClick:()=>E("/profile"),variant:"focus",className:"w-full hover-scale",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Invite Team Member"]}),e.jsx("div",{className:"text-xs text-muted-foreground/80 pt-2",children:"Assign tasks, track progress, and collaborate in real-time."})]})]})})]})})]})]}),n&&e.jsx(X,{children:!N&&!o&&e.jsx(m.div,{initial:{scale:0,y:100},animate:{scale:1,y:0},exit:{scale:0,y:100},transition:{type:"spring",stiffness:260,damping:20},className:"fixed bottom-6 right-6 z-50",children:e.jsxs(r,{onClick:()=>u(!0),variant:"focus",size:"icon",className:"h-14 w-14 rounded-full shadow-lg shadow-primary/30",children:[e.jsx(R,{className:"h-6 w-6"}),e.jsx("span",{className:"sr-only",children:"Create New Task"})]})})})]})}export{ws as default};
