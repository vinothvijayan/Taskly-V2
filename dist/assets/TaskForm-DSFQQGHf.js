import{o as J,Q as as,V as qe,r as n,j as e,T as ns,O as Ge,W as Ye,Y as is,C as Be,Z as ls,p as os,q as cs,a as We,P as Je,_ as ds,s as Qe,e as M,$ as Ze,a0 as ce,B as P,X as et,g as us,E as ms,F as hs,G as fs,a1 as Ce,a2 as De,a3 as Se,a4 as B,a5 as ge,t as Te,x as ps,a6 as xs,u as gs,a7 as vs,I as fe,a8 as tt,a9 as st,H as V,aa as rt,ab as at,M as nt,l as xe,U as it,ac as ae,ad as Q,ae as oe,J as ys,K as js,L as bs,N as ws,af as Ns,ag as ee}from"./index-C3PoaKhJ.js";import{S as Cs,a as Ds,u as Ss}from"./useTouchGestures-BC_F8JP4.js";import{T as lt}from"./textarea-DzbpV_Fn.js";import{t as H,c as Ts,e as Es,g as _e,m as Fe,a as me,b as As}from"./en-US-DSSwd-Ay.js";import{e as Ms,d as Rs}from"./endOfMonth-BNqLjwTF.js";import{M as Ps,i as Is,u as ot,P as ks,a as $s,b as _s,L as Fs,m as ct}from"./proxy-wG0P1ngr.js";import{C as Os}from"./checkbox-CRixpEwR.js";import{C as Ls,e as zs,S as Oe,a as Le,b as ze,c as Ke,d as te}from"./select-DYfge7V7.js";import{P as Ks}from"./plus--53mYUUG.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],Hs=J("chevrons-up-down",Vs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ee=J("circle-check",Us);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],dt=J("ellipsis-vertical",Xs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Gs=J("ellipsis",qs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Ae=J("message-circle",Ys);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Me=J("square-pen",Bs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]],ut=J("star-off",Ws);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],mt=J("star",Js);var ht="AlertDialog",[Qs,ca]=as(ht,[qe]),Y=qe(),ft=t=>{const{__scopeAlertDialog:s,...r}=t,i=Y(s);return e.jsx(Qe,{...i,...r,modal:!0})};ft.displayName=ht;var Zs="AlertDialogTrigger",er=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...i}=t,a=Y(r);return e.jsx(ns,{...a,...i,ref:s})});er.displayName=Zs;var tr="AlertDialogPortal",pt=t=>{const{__scopeAlertDialog:s,...r}=t,i=Y(s);return e.jsx(Je,{...i,...r})};pt.displayName=tr;var sr="AlertDialogOverlay",xt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...i}=t,a=Y(r);return e.jsx(Ge,{...a,...i,ref:s})});xt.displayName=sr;var ne="AlertDialogContent",[rr,ar]=Qs(ne),nr=ds("AlertDialogContent"),gt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,children:i,...a}=t,l=Y(r),d=n.useRef(null),m=Ye(s,d),h=n.useRef(null);return e.jsx(is,{contentName:ne,titleName:vt,docsSlug:"alert-dialog",children:e.jsx(rr,{scope:r,cancelRef:h,children:e.jsxs(Be,{role:"alertdialog",...l,...a,ref:m,onOpenAutoFocus:ls(a.onOpenAutoFocus,o=>{var u;o.preventDefault(),(u=h.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:o=>o.preventDefault(),onInteractOutside:o=>o.preventDefault(),children:[e.jsx(nr,{children:i}),e.jsx(lr,{contentRef:d})]})})})});gt.displayName=ne;var vt="AlertDialogTitle",yt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...i}=t,a=Y(r);return e.jsx(os,{...a,...i,ref:s})});yt.displayName=vt;var jt="AlertDialogDescription",bt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...i}=t,a=Y(r);return e.jsx(cs,{...a,...i,ref:s})});bt.displayName=jt;var ir="AlertDialogAction",wt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...i}=t,a=Y(r);return e.jsx(We,{...a,...i,ref:s})});wt.displayName=ir;var Nt="AlertDialogCancel",Ct=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...i}=t,{cancelRef:a}=ar(Nt,r),l=Y(r),d=Ye(s,a);return e.jsx(We,{...l,...i,ref:d})});Ct.displayName=Nt;var lr=({contentRef:t})=>{const s=`\`${ne}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${ne}\` by passing a \`${jt}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${ne}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return n.useEffect(()=>{var i;document.getElementById((i=t.current)==null?void 0:i.getAttribute("aria-describedby"))||console.warn(s)},[s,t]),null},or=ft,cr=pt,Dt=xt,St=gt,Tt=wt,Et=Ct,At=yt,Mt=bt;const dr=or,ur=cr,Rt=n.forwardRef(({className:t,...s},r)=>e.jsx(Dt,{className:M("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:r}));Rt.displayName=Dt.displayName;const Pt=n.forwardRef(({className:t,...s},r)=>e.jsxs(ur,{children:[e.jsx(Rt,{}),e.jsx(St,{ref:r,className:M("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s})]}));Pt.displayName=St.displayName;const It=({className:t,...s})=>e.jsx("div",{className:M("flex flex-col space-y-2 text-center sm:text-left",t),...s});It.displayName="AlertDialogHeader";const kt=({className:t,...s})=>e.jsx("div",{className:M("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});kt.displayName="AlertDialogFooter";const $t=n.forwardRef(({className:t,...s},r)=>e.jsx(At,{ref:r,className:M("text-lg font-semibold",t),...s}));$t.displayName=At.displayName;const _t=n.forwardRef(({className:t,...s},r)=>e.jsx(Mt,{ref:r,className:M("text-sm text-muted-foreground",t),...s}));_t.displayName=Mt.displayName;const Ft=n.forwardRef(({className:t,...s},r)=>e.jsx(Tt,{ref:r,className:M(Ze(),t),...s}));Ft.displayName=Tt.displayName;const Ot=n.forwardRef(({className:t,...s},r)=>e.jsx(Et,{ref:r,className:M(Ze({variant:"outline"}),"mt-2 sm:mt-0",t),...s}));Ot.displayName=Et.displayName;function Lt({open:t,onOpenChange:s,onConfirm:r,title:i="Delete Task",description:a="Are you sure you want to delete this task? This action cannot be undone.",itemName:l}){return e.jsx(dr,{open:t,onOpenChange:s,children:e.jsxs(Pt,{className:"sm:max-w-md",children:[e.jsxs(It,{children:[e.jsx($t,{className:"flex items-center gap-2",children:i}),e.jsx(_t,{children:l?e.jsxs(e.Fragment,{children:['Are you sure you want to delete "',e.jsx("strong",{children:l}),'"? This action cannot be undone.']}):a})]}),e.jsxs(kt,{children:[e.jsx(Ot,{children:"Cancel"}),e.jsx(Ft,{onClick:r,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})}function zt({taskId:t,initialContent:s="",isEditing:r=!1,commentId:i,onCommentAdded:a,onCancel:l}){const{addComment:d,updateComment:m}=ce(),[h,o]=n.useState(s),[u,p]=n.useState(!1),f=1e3,v=f-h.length,g=async y=>{if(y.preventDefault(),!(!h.trim()||u)){p(!0);try{r&&i?await m(i,t,h):await d(t,h),o(""),a==null||a()}catch(E){console.error("Error submitting comment:",E)}finally{p(!1)}}},w=y=>{y.key==="Enter"&&(y.ctrlKey||y.metaKey)&&(y.preventDefault(),g(y)),y.key==="Escape"&&(l==null||l())};return e.jsxs("form",{onSubmit:g,className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(lt,{value:h,onChange:y=>o(y.target.value),onKeyDown:w,placeholder:"Add a comment... (Ctrl+Enter to submit)",className:"min-h-[80px] resize-none pr-16",maxLength:f,autoFocus:!0}),e.jsx("div",{className:"absolute bottom-2 right-2 text-xs text-muted-foreground",children:v})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-muted-foreground"}),e.jsxs("div",{className:"flex items-center gap-2",children:[l&&e.jsxs(P,{type:"button",variant:"ghost",size:"sm",onClick:l,disabled:u,children:[e.jsx(et,{className:"h-4 w-4 mr-1"}),"Cancel"]}),e.jsxs(P,{type:"submit",size:"sm",disabled:!h.trim()||u||v<0,children:[e.jsx(Cs,{className:"h-4 w-4 mr-1"}),u?"Posting...":r?"Update":"Comment"]})]})]})]})}function pe(t,s){const r=H(t),i=H(s),a=r.getTime()-i.getTime();return a<0?-1:a>0?1:a}function mr(t){return Ts(t,Date.now())}function hr(t){return s=>{const i=(t?Math[t]:Math.trunc)(s);return i===0?0:i}}function fr(t,s){return+H(t)-+H(s)}function pr(t){const s=H(t);return s.setHours(23,59,59,999),s}function xr(t){const s=H(t);return+pr(s)==+Ms(s)}function gr(t,s){const r=H(t),i=H(s),a=pe(r,i),l=Math.abs(Rs(r,i));let d;if(l<1)d=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*l);let m=pe(r,i)===-a;xr(H(t))&&l===1&&pe(t,i)===1&&(m=!1),d=a*(l-Number(m))}return d===0?0:d}function vr(t,s,r){const i=fr(t,s)/1e3;return hr(r==null?void 0:r.roundingMethod)(i)}function yr(t,s,r){const i=As(),a=(r==null?void 0:r.locale)??i.locale??Es,l=2520,d=pe(t,s);if(isNaN(d))throw new RangeError("Invalid time value");const m=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:d});let h,o;d>0?(h=H(s),o=H(t)):(h=H(t),o=H(s));const u=vr(o,h),p=(_e(o)-_e(h))/1e3,f=Math.round((u-p)/60);let v;if(f<2)return r!=null&&r.includeSeconds?u<5?a.formatDistance("lessThanXSeconds",5,m):u<10?a.formatDistance("lessThanXSeconds",10,m):u<20?a.formatDistance("lessThanXSeconds",20,m):u<40?a.formatDistance("halfAMinute",0,m):u<60?a.formatDistance("lessThanXMinutes",1,m):a.formatDistance("xMinutes",1,m):f===0?a.formatDistance("lessThanXMinutes",1,m):a.formatDistance("xMinutes",f,m);if(f<45)return a.formatDistance("xMinutes",f,m);if(f<90)return a.formatDistance("aboutXHours",1,m);if(f<Fe){const g=Math.round(f/60);return a.formatDistance("aboutXHours",g,m)}else{if(f<l)return a.formatDistance("xDays",1,m);if(f<me){const g=Math.round(f/Fe);return a.formatDistance("xDays",g,m)}else if(f<me*2)return v=Math.round(f/me),a.formatDistance("aboutXMonths",v,m)}if(v=gr(o,h),v<12){const g=Math.round(f/me);return a.formatDistance("xMonths",g,m)}else{const g=v%12,w=Math.trunc(v/12);return g<3?a.formatDistance("aboutXYears",w,m):g<9?a.formatDistance("overXYears",w,m):a.formatDistance("almostXYears",w+1,m)}}function jr(t,s){return yr(t,mr(t),s)}function br({comment:t}){const{deleteComment:s}=ce(),{user:r}=us(),[i,a]=n.useState(!1),l=(r==null?void 0:r.uid)===t.userId,d=f=>{if(!f)return"";const v=f.toDate?f.toDate():new Date(f),g=jr(v,{addSuffix:!0});return g.includes("less than a minute")?"Just now":g.includes("about a minute")?"1 minute ago":g},m=f=>f.split(" ").map(v=>v[0]).join("").toUpperCase().slice(0,2),h=()=>{a(!0)},o=async()=>{confirm("Are you sure you want to delete this comment?")&&await s(t.id,t.taskId)},u=()=>{a(!1)},p=()=>{a(!1)};return i?e.jsx("div",{className:"border rounded-lg p-3 bg-muted/20",children:e.jsx(zt,{taskId:t.taskId,initialContent:t.content,isEditing:!0,commentId:t.id,onCommentAdded:u,onCancel:p})}):e.jsxs("div",{className:"flex gap-3 group",children:[e.jsxs(ms,{className:"h-8 w-8 flex-shrink-0",children:[e.jsx(hs,{src:t.userPhotoURL,alt:t.userDisplayName}),e.jsx(fs,{className:"text-xs",children:m(t.userDisplayName)})]}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:t.userDisplayName}),e.jsx("span",{className:"text-xs text-muted-foreground",children:d(t.createdAt)}),t.isEdited&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"(edited)"}),l&&e.jsxs(Ce,{children:[e.jsx(De,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Gs,{className:"h-3 w-3"})})}),e.jsxs(Se,{align:"end",children:[e.jsxs(B,{onClick:h,children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(B,{onClick:o,className:"text-destructive",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),e.jsx("div",{className:"text-sm whitespace-pre-wrap break-words",children:t.content})]})]})}class wr extends n.Component{getSnapshotBeforeUpdate(s){const r=this.props.childRef.current;if(r&&s.isPresent&&!this.props.isPresent){const i=r.offsetParent,a=Is(i)&&i.offsetWidth||0,l=this.props.sizeRef.current;l.height=r.offsetHeight||0,l.width=r.offsetWidth||0,l.top=r.offsetTop,l.left=r.offsetLeft,l.right=a-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Nr({children:t,isPresent:s,anchorX:r,root:i}){const a=n.useId(),l=n.useRef(null),d=n.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:m}=n.useContext(Ps);return n.useInsertionEffect(()=>{const{width:h,height:o,top:u,left:p,right:f}=d.current;if(s||!l.current||!h||!o)return;const v=r==="left"?`left: ${p}`:`right: ${f}`;l.current.dataset.motionPopId=a;const g=document.createElement("style");m&&(g.nonce=m);const w=i??document.head;return w.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${h}px !important;
            height: ${o}px !important;
            ${v}px !important;
            top: ${u}px !important;
          }
        `),()=>{w.contains(g)&&w.removeChild(g)}},[s]),e.jsx(wr,{isPresent:s,childRef:l,sizeRef:d,children:n.cloneElement(t,{ref:l})})}const Cr=({children:t,initial:s,isPresent:r,onExitComplete:i,custom:a,presenceAffectsLayout:l,mode:d,anchorX:m,root:h})=>{const o=ot(Dr),u=n.useId();let p=!0,f=n.useMemo(()=>(p=!1,{id:u,initial:s,isPresent:r,custom:a,onExitComplete:v=>{o.set(v,!0);for(const g of o.values())if(!g)return;i&&i()},register:v=>(o.set(v,!1),()=>o.delete(v))}),[r,o,i]);return l&&p&&(f={...f}),n.useMemo(()=>{o.forEach((v,g)=>o.set(g,!1))},[r]),n.useEffect(()=>{!r&&!o.size&&i&&i()},[r]),d==="popLayout"&&(t=e.jsx(Nr,{isPresent:r,anchorX:m,root:h,children:t})),e.jsx(ks.Provider,{value:f,children:t})};function Dr(){return new Map}const he=t=>t.key||"";function Ve(t){const s=[];return n.Children.forEach(t,r=>{n.isValidElement(r)&&s.push(r)}),s}const Kt=({children:t,custom:s,initial:r=!0,onExitComplete:i,presenceAffectsLayout:a=!0,mode:l="sync",propagate:d=!1,anchorX:m="left",root:h})=>{const[o,u]=$s(d),p=n.useMemo(()=>Ve(t),[t]),f=d&&!o?[]:p.map(he),v=n.useRef(!0),g=n.useRef(p),w=ot(()=>new Map),[y,E]=n.useState(p),[F,U]=n.useState(p);_s(()=>{v.current=!1,g.current=p;for(let N=0;N<F.length;N++){const b=he(F[N]);f.includes(b)?w.delete(b):w.get(b)!==!0&&w.set(b,!1)}},[F,f.length,f.join("-")]);const R=[];if(p!==y){let N=[...p];for(let b=0;b<F.length;b++){const O=F[b],q=he(O);f.includes(q)||(N.splice(b,0,O),R.push(O))}return l==="wait"&&R.length&&(N=R),U(Ve(N)),E(p),null}const{forceRender:k}=n.useContext(Fs);return e.jsx(e.Fragment,{children:F.map(N=>{const b=he(N),O=d&&!o?!1:p===F||f.includes(b),q=()=>{if(w.has(b))w.set(b,!0);else return;let X=!0;w.forEach(D=>{D||(X=!1)}),X&&(k==null||k(),U(g.current),d&&(u==null||u()),i&&i())};return e.jsx(Cr,{isPresent:O,initial:!v.current||r?void 0:!1,custom:s,presenceAffectsLayout:a,mode:l,root:h,onExitComplete:O?void 0:q,anchorX:m,children:N},b)})})};function Vt({taskId:t,className:s,isExpanded:r,onToggleExpanded:i}){const{comments:a,commentCounts:l,loading:d,subscribeToTaskComments:m,unsubscribeFromTaskComments:h}=ce(),[o,u]=n.useState(!1),p=n.useRef(null),f=a[t]||[];l[t];const v=d[t]===!0&&f.length===0;n.useEffect(()=>{p.current&&clearTimeout(p.current);const w=m(t);return()=>{w&&h(t)}},[t,m,h]),n.useEffect(()=>{r?p.current&&(clearTimeout(p.current),p.current=null):p.current=setTimeout(()=>{h(t)},3e4)},[r,t,h]);const g=()=>{u(!1)};return e.jsx("div",{className:M("w-full pt-0",s),children:e.jsx(Kt,{initial:!1,children:r&&e.jsx(ct.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{type:"spring",duration:.4,bounce:0},className:"overflow-hidden",children:e.jsx(Te,{className:"mt-1 border-none shadow-none bg-transparent",children:e.jsxs(ps,{className:"py-1 px-2 space-y-3",children:[" ",o?e.jsx(zt,{taskId:t,onCommentAdded:g,onCancel:()=>u(!1)}):e.jsxs(P,{variant:"outline",onClick:()=>u(!0),className:"w-full justify-start text-muted-foreground h-9 rounded-md border-dashed hover:border-primary/50 hover:text-primary transition-colors",size:"sm",children:[e.jsx(Ae,{className:"h-3 w-3 mr-2"}),"Write a comment..."]}),v?e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground py-4",children:[e.jsx(xs,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Loading comments..."})]}):f.length>0&&e.jsxs("div",{className:"space-y-3 border-t border-border/50 pt-2",children:[" ",f.map(w=>e.jsx(br,{comment:w},w.id))]})]})})})})})}const Sr=t=>{if(!t||t.length===0)return 0;const s=t.filter(r=>r.isCompleted).length;return Math.round(s/t.length*100)};function Ht({task:t}){var w;const{addSubtask:s,toggleSubtaskStatus:r,deleteSubtask:i}=gs(),[a,l]=n.useState(""),[d,m]=n.useState(!1),h=Sr(t.subtasks),o=((w=t.subtasks)==null?void 0:w.length)||0,u=async y=>{y.stopPropagation(),a.trim()&&(await s(t.id,a.trim()),l(""))},p=async(y,E)=>{await r(t.id,E)},f=async(y,E)=>{y.stopPropagation(),confirm("Are you sure you want to delete this subtask?")&&await i(t.id,E)},v=y=>{y.stopPropagation(),y.key==="Enter"&&(y.preventDefault(),u(y))},g=()=>{m(!d)};return e.jsxs("div",{className:"pt-0 pb-3 space-y-3",children:[" ",e.jsxs(P,{variant:"ghost",onClick:g,className:"w-full justify-between py-1 px-2 h-auto hover:bg-muted/30 rounded-lg transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:["Subtasks ",o>0&&`(${o})`]})]}),d?e.jsx(Ls,{className:"h-4 w-4 text-muted-foreground"}):e.jsx(zs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Kt,{initial:!1,children:d&&e.jsx(ct.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{type:"spring",duration:.4,bounce:0},className:"overflow-hidden",children:e.jsxs("div",{className:"space-y-3 pt-0",children:[t.subtasks&&t.subtasks.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vs,{value:h,className:"flex-1 h-2"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[h,"%"]})]}),e.jsx("div",{className:"space-y-2",children:t.subtasks.map(y=>e.jsxs("div",{className:"flex items-center gap-2 group",children:[e.jsx(Os,{id:`subtask-${y.id}`,checked:y.isCompleted,onCheckedChange:E=>p({stopPropagation:()=>{}},y.id),onClick:E=>E.stopPropagation(),className:"h-4 w-4"}),e.jsx("label",{htmlFor:`subtask-${y.id}`,className:M("flex-1 text-sm cursor-pointer",y.isCompleted?"line-through text-muted-foreground":"text-foreground"),onClick:E=>E.stopPropagation(),children:y.title}),e.jsx(P,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity hover:text-destructive",onClick:E=>f(E,y.id),children:e.jsx(ge,{className:"h-3 w-3"})})]},y.id))})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(fe,{placeholder:"Add a new subtask...",value:a,onChange:y=>l(y.target.value),onKeyPress:v,onClick:y=>y.stopPropagation(),className:"flex-1"}),e.jsx(P,{size:"icon",onClick:u,disabled:!a.trim(),children:e.jsx(Ks,{className:"h-4 w-4"})})]})]})})})]})}function da({task:t,onEdit:s,onDelete:r,onToggleStatus:i,onTogglePriority:a,onStartTimer:l,assignedProfiles:d}){const[m,h]=n.useState(!1),[o,u]=n.useState(!1),[p,f]=n.useState(!1),{commentCounts:v}=ce(),{trackingTask:g,isTracking:w,startTracking:y,stopTracking:E,getFormattedTime:F}=tt(),U=(g==null?void 0:g.id)===t.id,R=t.status==="completed",k=t.dueDate&&new Date(t.dueDate)<new Date&&!R,N=t.lastCommentedAt&&Date.now()-new Date(t.lastCommentedAt).getTime()<5*60*1e3&&!p,b=()=>{r(t.id),h(!1)},O=D=>{const z=new Date(D),S=new Date,$=z.getTime()-S.getTime(),I=Math.ceil($/(1e3*60*60*24));return I===0?"Today":I===1?"Tomorrow":I===-1?"Yesterday":I<0?`${Math.abs(I)} days ago`:`${I} days`},q=D=>{const z=Math.floor(D/3600),S=Math.floor(D%3600/60);return z>0?`${z}h ${S}m`:`${S}m`},X=v[t.id]||0;return e.jsxs("div",{className:"flex flex-col mb-3",children:[e.jsxs(Te,{className:M("relative transition-all duration-200 cursor-pointer","min-h-[120px] shadow-md hover:shadow-lg dark:shadow-lg","bg-white dark:bg-gray-900","border border-border/50 dark:border-gray-700","rounded-xl",R&&"opacity-75 bg-muted/50 dark:bg-gray-800",U&&"ring-2 ring-primary/50 border-primary/50",N&&"border-l-4 border-l-blue-500 bg-blue-50/10 dark:bg-blue-900/10 animate-pulse-glow",k&&"bg-destructive/5 dark:bg-red-900/20 animate-pulse-glow-destructive"),onClick:D=>{const z=D.target;(D.target===D.currentTarget||!z.closest("button, a, [role='menuitem']"))&&s(t)},children:[e.jsx("div",{className:"p-5 pb-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(P,{onClick:D=>{D.stopPropagation(),i(t.id)},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 min-w-[40px] shrink-0 rounded-full hover:bg-primary/10 transition-all",children:R?e.jsx(Ee,{className:"h-6 w-6 text-green-600"}):e.jsx(st,{className:"h-6 w-6 text-muted-foreground hover:text-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h3",{className:M("font-semibold text-lg leading-relaxed line-clamp-2",R&&"line-through text-muted-foreground"),children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs(P,{onClick:D=>{D.stopPropagation(),u(!o),f(!0)},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-primary/10 transition-all relative",children:[e.jsx(Ae,{className:"h-5 w-5 text-muted-foreground"}),X>0&&e.jsx(V,{variant:"destructive",className:"absolute -top-1 -right-1 h-4 w-4 flex items-center justify-center p-0 text-xs font-bold",children:X})]}),e.jsx(P,{onClick:D=>{D.stopPropagation(),a(t.id)},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-yellow-500/10 transition-all",children:t.priority==="high"?e.jsx(mt,{className:"h-5 w-5 fill-yellow-400 text-yellow-400"}):e.jsx(ut,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs(Ce,{children:[e.jsx(De,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-muted/50 transition-all",onClick:D=>D.stopPropagation(),children:e.jsx(dt,{className:"h-5 w-5"})})}),e.jsxs(Se,{align:"end",className:"w-52 shadow-lg",children:[e.jsxs(B,{onClick:D=>{D.stopPropagation(),s(t)},children:[e.jsx(Me,{className:"h-4 w-4 mr-3"}),"Edit Task"]}),e.jsx(B,{onClick:D=>{D.stopPropagation(),U?E():y(t)},children:U?e.jsxs(e.Fragment,{children:[" ",e.jsx(rt,{className:"h-4 w-4 mr-3"})," Stop Timer "]}):e.jsxs(e.Fragment,{children:[" ",e.jsx(at,{className:"h-4 w-4 mr-3"})," Start Timer "]})}),e.jsxs(B,{onClick:D=>{D.stopPropagation(),h(!0)},className:"text-destructive",children:[e.jsx(ge,{className:"h-4 w-4 mr-3"}),"Delete Task"]})]})]})]})]}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 leading-relaxed",children:t.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs mt-3",children:[t.dueDate&&e.jsxs(V,{variant:k?"destructive":"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(nt,{className:"h-3 w-3 mr-1.5"}),O(t.dueDate)]}),t.estimatedTime&&e.jsxs(V,{variant:"secondary",className:"h-6 text-xs px-2 py-1",children:[e.jsx(xe,{className:"h-3 w-3 mr-1.5"}),t.estimatedTime,"m"]}),t.timeSpent&&t.timeSpent>0&&e.jsxs(V,{variant:"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(xe,{className:"h-3 w-3 mr-1.5"}),q(t.timeSpent)]}),d.length>0&&e.jsxs(V,{variant:"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(it,{className:"h-3 w-3 mr-1.5"}),d.length]}),e.jsx(V,{variant:t.status==="completed"?"default":"secondary",className:"h-6 text-xs px-2 py-1",children:t.status})]})]})]})}),e.jsx("div",{className:"px-5 py-0 border-t border-border/30",children:e.jsx(Vt,{taskId:t.id,isExpanded:o,onToggleExpanded:()=>u(!o)})}),t.subtasks&&(t.subtasks.length>0||!R)&&e.jsxs("div",{className:"px-5 pt-3 py-0 border-t border-border/30",children:[" ",e.jsx(Ht,{task:t})]}),U&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full animate-pulse shadow-glow"})})]}),e.jsx(Lt,{open:m,onOpenChange:h,onConfirm:b,itemName:t.title})]})}const ua=n.memo(function({task:s,onEdit:r,onDelete:i,onToggleStatus:a,onTogglePriority:l,onStartTimer:d,assignedProfiles:m=[]}){const[h,o]=n.useState(!1),[u,p]=n.useState(!1),[f,v]=n.useState(!1),{commentCounts:g}=ce(),{impact:w,notification:y}=Ss(),{trackingTask:E,startTracking:F,stopTracking:U}=tt(),R=(E==null?void 0:E.id)===s.id,k=Ds({onSwipeLeft:()=>{w("medium"),o(!0)},onSwipeRight:()=>{w("light"),a(s.id)}},{threshold:60,velocityThreshold:.15,ignoreTapFromInteractive:!0}),N=s.dueDate&&new Date(s.dueDate)<new Date&&s.status!=="completed",b=s.status==="completed",O=s.lastCommentedAt&&Date.now()-new Date(s.lastCommentedAt).getTime()<5*60*1e3&&!f,q=()=>{i(s.id),y("error"),o(!1)},X=S=>{const $=new Date(S),I=new Date,ie=$.getTime()-I.getTime(),G=Math.ceil(ie/(1e3*60*60*24));return G===0?"Today":G===1?"Tomorrow":G===-1?"Yesterday":G<0?`${Math.abs(G)} days ago`:`${G} days`},D=S=>{const $=Math.floor(S/3600),I=Math.floor(S%3600/60);return $>0?`${$}h ${I}m`:`${I}m`},z=g[s.id]||0;return e.jsxs("div",{className:"flex flex-col mb-3",children:[e.jsxs(Te,{ref:k,className:M("relative transition-all duration-200 touch-manipulation touch-pan-y z-10 mx-1","min-h-[100px] shadow-md hover:shadow-lg",b&&"opacity-75 bg-muted/50",N&&!b&&"border-destructive/50 bg-destructive/5",R&&"ring-2 ring-primary/50 border-primary/50",O&&"border-l-4 border-l-blue-500 bg-blue-50/10 dark:bg-blue-900/10 animate-pulse-glow","border border-border/50 rounded-xl"),children:[e.jsx("div",{className:"p-4 sm:p-5 pb-4",onClick:S=>{const $=S.target;(S.target===S.currentTarget||!$.closest('button, a, [role="menuitem"]'))&&r(s)},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(P,{onClick:S=>{S.stopPropagation(),a(s.id),w("light")},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 min-w-[40px] shrink-0 rounded-full hover:bg-primary/10 transition-all",children:b?e.jsx(Ee,{className:"h-6 w-6 text-green-600"}):e.jsx(st,{className:"h-6 w-6 text-muted-foreground hover:text-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h3",{className:M("font-semibold text-base leading-relaxed line-clamp-2",b&&"line-through text-muted-foreground"),children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsxs(P,{onClick:S=>{S.stopPropagation(),p(!u),v(!0),w("light")},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-primary/10 transition-all relative",children:[e.jsx(Ae,{className:"h-5 w-5 text-muted-foreground"}),z>0&&e.jsx(V,{variant:"destructive",className:"absolute -top-1 -right-1 h-4 w-4 flex items-center justify-center p-0 text-xs font-bold",children:z})]}),e.jsx(P,{onClick:S=>{S.stopPropagation(),l(s.id),w("light")},variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-yellow-500/10 transition-all",children:s.priority==="high"?e.jsx(mt,{className:"h-5 w-5 fill-yellow-400 text-yellow-400"}):e.jsx(ut,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs(Ce,{children:[e.jsx(De,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",className:"p-0 h-10 w-10 rounded-full hover:bg-muted/50 transition-all",onClick:S=>{S.stopPropagation(),w("light")},children:e.jsx(dt,{className:"h-5 w-5"})})}),e.jsxs(Se,{align:"end",className:"w-52 shadow-lg",children:[e.jsxs(B,{onClick:S=>{S.stopPropagation(),r(s)},children:[e.jsx(Me,{className:"h-4 w-4 mr-3"}),"Edit Task"]}),e.jsx(B,{onClick:S=>{S.stopPropagation(),R?U():F(s)},children:R?e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"h-4 w-4 mr-3"}),"Stop Timer"]}):e.jsxs(e.Fragment,{children:[e.jsx(at,{className:"h-4 w-4 mr-3"}),"Start Timer"]})}),e.jsxs(B,{onClick:S=>{S.stopPropagation(),o(!0)},className:"text-destructive",children:[e.jsx(ge,{className:"h-4 w-4 mr-3"}),"Delete Task"]})]})]})]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 leading-relaxed",children:s.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs mt-3",children:[s.dueDate&&e.jsxs(V,{variant:N?"destructive":"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(nt,{className:"h-3 w-3 mr-1.5"}),X(s.dueDate)]}),s.estimatedTime&&e.jsxs(V,{variant:"secondary",className:"h-6 text-xs px-2 py-1",children:[e.jsx(xe,{className:"h-3 w-3 mr-1.5"}),s.estimatedTime,"m"]}),s.timeSpent&&s.timeSpent>0&&e.jsxs(V,{variant:"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(xe,{className:"h-3 w-3 mr-1.5"}),D(s.timeSpent)]}),m.length>0&&e.jsxs(V,{variant:"outline",className:"h-6 text-xs px-2 py-1",children:[e.jsx(it,{className:"h-3 w-3 mr-1.5"}),m.length]}),e.jsx(V,{variant:s.status==="completed"?"default":"secondary",className:"h-6 text-xs px-2 py-1",children:s.status})]})]})]})}),e.jsx("div",{className:"px-4 py-0 border-t border-border/30",children:e.jsx(Vt,{taskId:s.id,isExpanded:u,onToggleExpanded:()=>p(!u)})}),s.subtasks&&(s.subtasks.length>0||!b)&&e.jsxs("div",{className:"px-4 pt-3 py-0 border-t border-border/30",children:[" ",e.jsx(Ht,{task:s})]}),R&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full animate-pulse shadow-glow"})})]}),e.jsx(Lt,{open:h,onOpenChange:o,onConfirm:q,itemName:s.title})]})});var He=1,Tr=.9,Er=.8,Ar=.17,ye=.1,je=.999,Mr=.9999,Rr=.99,Pr=/[\\\/_+.#"@\[\(\{&]/,Ir=/[\\\/_+.#"@\[\(\{&]/g,kr=/[\s-]/,Ut=/[\s-]/g;function we(t,s,r,i,a,l,d){if(l===s.length)return a===t.length?He:Rr;var m=`${a},${l}`;if(d[m]!==void 0)return d[m];for(var h=i.charAt(l),o=r.indexOf(h,a),u=0,p,f,v,g;o>=0;)p=we(t,s,r,i,o+1,l+1,d),p>u&&(o===a?p*=He:Pr.test(t.charAt(o-1))?(p*=Er,v=t.slice(a,o-1).match(Ir),v&&a>0&&(p*=Math.pow(je,v.length))):kr.test(t.charAt(o-1))?(p*=Tr,g=t.slice(a,o-1).match(Ut),g&&a>0&&(p*=Math.pow(je,g.length))):(p*=Ar,a>0&&(p*=Math.pow(je,o-a))),t.charAt(o)!==s.charAt(l)&&(p*=Mr)),(p<ye&&r.charAt(o-1)===i.charAt(l+1)||i.charAt(l+1)===i.charAt(l)&&r.charAt(o-1)!==i.charAt(l))&&(f=we(t,s,r,i,o+1,l+2,d),f*ye>p&&(p=f*ye)),p>u&&(u=p),o=r.indexOf(h,o+1);return d[m]=u,u}function Ue(t){return t.toLowerCase().replace(Ut," ")}function $r(t,s,r){return t=r&&r.length>0?`${t+" "+r.join(" ")}`:t,we(t,s,Ue(t),Ue(s),0,0,{})}var le='[cmdk-group=""]',be='[cmdk-group-items=""]',_r='[cmdk-group-heading=""]',Xt='[cmdk-item=""]',Xe=`${Xt}:not([aria-disabled="true"])`,Ne="cmdk-item-select",se="data-value",Fr=(t,s,r)=>$r(t,s,r),qt=n.createContext(void 0),de=()=>n.useContext(qt),Gt=n.createContext(void 0),Re=()=>n.useContext(Gt),Yt=n.createContext(void 0),Bt=n.forwardRef((t,s)=>{let r=re(()=>{var c,j;return{search:"",value:(j=(c=t.value)!=null?c:t.defaultValue)!=null?j:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),i=re(()=>new Set),a=re(()=>new Map),l=re(()=>new Map),d=re(()=>new Set),m=Wt(t),{label:h,children:o,value:u,onValueChange:p,filter:f,shouldFilter:v,loop:g,disablePointerSelection:w=!1,vimBindings:y=!0,...E}=t,F=ae(),U=ae(),R=ae(),k=n.useRef(null),N=Yr();Z(()=>{if(u!==void 0){let c=u.trim();r.current.value=c,b.emit()}},[u]),Z(()=>{N(6,S)},[]);let b=n.useMemo(()=>({subscribe:c=>(d.current.add(c),()=>d.current.delete(c)),snapshot:()=>r.current,setState:(c,j,C)=>{var x,T,A,K;if(!Object.is(r.current[c],j)){if(r.current[c]=j,c==="search")z(),X(),N(1,D);else if(c==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let _=document.getElementById(R);_?_.focus():(x=document.getElementById(F))==null||x.focus()}if(N(7,()=>{var _;r.current.selectedItemId=(_=$())==null?void 0:_.id,b.emit()}),C||N(5,S),((T=m.current)==null?void 0:T.value)!==void 0){let _=j??"";(K=(A=m.current).onValueChange)==null||K.call(A,_);return}}b.emit()}},emit:()=>{d.current.forEach(c=>c())}}),[]),O=n.useMemo(()=>({value:(c,j,C)=>{var x;j!==((x=l.current.get(c))==null?void 0:x.value)&&(l.current.set(c,{value:j,keywords:C}),r.current.filtered.items.set(c,q(j,C)),N(2,()=>{X(),b.emit()}))},item:(c,j)=>(i.current.add(c),j&&(a.current.has(j)?a.current.get(j).add(c):a.current.set(j,new Set([c]))),N(3,()=>{z(),X(),r.current.value||D(),b.emit()}),()=>{l.current.delete(c),i.current.delete(c),r.current.filtered.items.delete(c);let C=$();N(4,()=>{z(),(C==null?void 0:C.getAttribute("id"))===c&&D(),b.emit()})}),group:c=>(a.current.has(c)||a.current.set(c,new Set),()=>{l.current.delete(c),a.current.delete(c)}),filter:()=>m.current.shouldFilter,label:h||t["aria-label"],getDisablePointerSelection:()=>m.current.disablePointerSelection,listId:F,inputId:R,labelId:U,listInnerRef:k}),[]);function q(c,j){var C,x;let T=(x=(C=m.current)==null?void 0:C.filter)!=null?x:Fr;return c?T(c,r.current.search,j):0}function X(){if(!r.current.search||m.current.shouldFilter===!1)return;let c=r.current.filtered.items,j=[];r.current.filtered.groups.forEach(x=>{let T=a.current.get(x),A=0;T.forEach(K=>{let _=c.get(K);A=Math.max(_,A)}),j.push([x,A])});let C=k.current;I().sort((x,T)=>{var A,K;let _=x.getAttribute("id"),ue=T.getAttribute("id");return((A=c.get(ue))!=null?A:0)-((K=c.get(_))!=null?K:0)}).forEach(x=>{let T=x.closest(be);T?T.appendChild(x.parentElement===T?x:x.closest(`${be} > *`)):C.appendChild(x.parentElement===C?x:x.closest(`${be} > *`))}),j.sort((x,T)=>T[1]-x[1]).forEach(x=>{var T;let A=(T=k.current)==null?void 0:T.querySelector(`${le}[${se}="${encodeURIComponent(x[0])}"]`);A==null||A.parentElement.appendChild(A)})}function D(){let c=I().find(C=>C.getAttribute("aria-disabled")!=="true"),j=c==null?void 0:c.getAttribute(se);b.setState("value",j||void 0)}function z(){var c,j,C,x;if(!r.current.search||m.current.shouldFilter===!1){r.current.filtered.count=i.current.size;return}r.current.filtered.groups=new Set;let T=0;for(let A of i.current){let K=(j=(c=l.current.get(A))==null?void 0:c.value)!=null?j:"",_=(x=(C=l.current.get(A))==null?void 0:C.keywords)!=null?x:[],ue=q(K,_);r.current.filtered.items.set(A,ue),ue>0&&T++}for(let[A,K]of a.current)for(let _ of K)if(r.current.filtered.items.get(_)>0){r.current.filtered.groups.add(A);break}r.current.filtered.count=T}function S(){var c,j,C;let x=$();x&&(((c=x.parentElement)==null?void 0:c.firstChild)===x&&((C=(j=x.closest(le))==null?void 0:j.querySelector(_r))==null||C.scrollIntoView({block:"nearest"})),x.scrollIntoView({block:"nearest"}))}function $(){var c;return(c=k.current)==null?void 0:c.querySelector(`${Xt}[aria-selected="true"]`)}function I(){var c;return Array.from(((c=k.current)==null?void 0:c.querySelectorAll(Xe))||[])}function ie(c){let j=I()[c];j&&b.setState("value",j.getAttribute(se))}function G(c){var j;let C=$(),x=I(),T=x.findIndex(K=>K===C),A=x[T+c];(j=m.current)!=null&&j.loop&&(A=T+c<0?x[x.length-1]:T+c===x.length?x[0]:x[T+c]),A&&b.setState("value",A.getAttribute(se))}function Pe(c){let j=$(),C=j==null?void 0:j.closest(le),x;for(;C&&!x;)C=c>0?qr(C,le):Gr(C,le),x=C==null?void 0:C.querySelector(Xe);x?b.setState("value",x.getAttribute(se)):G(c)}let Ie=()=>ie(I().length-1),ke=c=>{c.preventDefault(),c.metaKey?Ie():c.altKey?Pe(1):G(1)},$e=c=>{c.preventDefault(),c.metaKey?ie(0):c.altKey?Pe(-1):G(-1)};return n.createElement(Q.div,{ref:s,tabIndex:-1,...E,"cmdk-root":"",onKeyDown:c=>{var j;(j=E.onKeyDown)==null||j.call(E,c);let C=c.nativeEvent.isComposing||c.keyCode===229;if(!(c.defaultPrevented||C))switch(c.key){case"n":case"j":{y&&c.ctrlKey&&ke(c);break}case"ArrowDown":{ke(c);break}case"p":case"k":{y&&c.ctrlKey&&$e(c);break}case"ArrowUp":{$e(c);break}case"Home":{c.preventDefault(),ie(0);break}case"End":{c.preventDefault(),Ie();break}case"Enter":{c.preventDefault();let x=$();if(x){let T=new Event(Ne);x.dispatchEvent(T)}}}}},n.createElement("label",{"cmdk-label":"",htmlFor:O.inputId,id:O.labelId,style:Wr},h),ve(t,c=>n.createElement(Gt.Provider,{value:b},n.createElement(qt.Provider,{value:O},c))))}),Or=n.forwardRef((t,s)=>{var r,i;let a=ae(),l=n.useRef(null),d=n.useContext(Yt),m=de(),h=Wt(t),o=(i=(r=h.current)==null?void 0:r.forceMount)!=null?i:d==null?void 0:d.forceMount;Z(()=>{if(!o)return m.item(a,d==null?void 0:d.id)},[o]);let u=Jt(a,l,[t.value,t.children,l],t.keywords),p=Re(),f=W(N=>N.value&&N.value===u.current),v=W(N=>o||m.filter()===!1?!0:N.search?N.filtered.items.get(a)>0:!0);n.useEffect(()=>{let N=l.current;if(!(!N||t.disabled))return N.addEventListener(Ne,g),()=>N.removeEventListener(Ne,g)},[v,t.onSelect,t.disabled]);function g(){var N,b;w(),(b=(N=h.current).onSelect)==null||b.call(N,u.current)}function w(){p.setState("value",u.current,!0)}if(!v)return null;let{disabled:y,value:E,onSelect:F,forceMount:U,keywords:R,...k}=t;return n.createElement(Q.div,{ref:oe(l,s),...k,id:a,"cmdk-item":"",role:"option","aria-disabled":!!y,"aria-selected":!!f,"data-disabled":!!y,"data-selected":!!f,onPointerMove:y||m.getDisablePointerSelection()?void 0:w,onClick:y?void 0:g},t.children)}),Lr=n.forwardRef((t,s)=>{let{heading:r,children:i,forceMount:a,...l}=t,d=ae(),m=n.useRef(null),h=n.useRef(null),o=ae(),u=de(),p=W(v=>a||u.filter()===!1?!0:v.search?v.filtered.groups.has(d):!0);Z(()=>u.group(d),[]),Jt(d,m,[t.value,t.heading,h]);let f=n.useMemo(()=>({id:d,forceMount:a}),[a]);return n.createElement(Q.div,{ref:oe(m,s),...l,"cmdk-group":"",role:"presentation",hidden:p?void 0:!0},r&&n.createElement("div",{ref:h,"cmdk-group-heading":"","aria-hidden":!0,id:o},r),ve(t,v=>n.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?o:void 0},n.createElement(Yt.Provider,{value:f},v))))}),zr=n.forwardRef((t,s)=>{let{alwaysRender:r,...i}=t,a=n.useRef(null),l=W(d=>!d.search);return!r&&!l?null:n.createElement(Q.div,{ref:oe(a,s),...i,"cmdk-separator":"",role:"separator"})}),Kr=n.forwardRef((t,s)=>{let{onValueChange:r,...i}=t,a=t.value!=null,l=Re(),d=W(o=>o.search),m=W(o=>o.selectedItemId),h=de();return n.useEffect(()=>{t.value!=null&&l.setState("search",t.value)},[t.value]),n.createElement(Q.input,{ref:s,...i,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":h.listId,"aria-labelledby":h.labelId,"aria-activedescendant":m,id:h.inputId,type:"text",value:a?t.value:d,onChange:o=>{a||l.setState("search",o.target.value),r==null||r(o.target.value)}})}),Vr=n.forwardRef((t,s)=>{let{children:r,label:i="Suggestions",...a}=t,l=n.useRef(null),d=n.useRef(null),m=W(o=>o.selectedItemId),h=de();return n.useEffect(()=>{if(d.current&&l.current){let o=d.current,u=l.current,p,f=new ResizeObserver(()=>{p=requestAnimationFrame(()=>{let v=o.offsetHeight;u.style.setProperty("--cmdk-list-height",v.toFixed(1)+"px")})});return f.observe(o),()=>{cancelAnimationFrame(p),f.unobserve(o)}}},[]),n.createElement(Q.div,{ref:oe(l,s),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":m,"aria-label":i,id:h.listId},ve(t,o=>n.createElement("div",{ref:oe(d,h.listInnerRef),"cmdk-list-sizer":""},o)))}),Hr=n.forwardRef((t,s)=>{let{open:r,onOpenChange:i,overlayClassName:a,contentClassName:l,container:d,...m}=t;return n.createElement(Qe,{open:r,onOpenChange:i},n.createElement(Je,{container:d},n.createElement(Ge,{"cmdk-overlay":"",className:a}),n.createElement(Be,{"aria-label":t.label,"cmdk-dialog":"",className:l},n.createElement(Bt,{ref:s,...m}))))}),Ur=n.forwardRef((t,s)=>W(r=>r.filtered.count===0)?n.createElement(Q.div,{ref:s,...t,"cmdk-empty":"",role:"presentation"}):null),Xr=n.forwardRef((t,s)=>{let{progress:r,children:i,label:a="Loading...",...l}=t;return n.createElement(Q.div,{ref:s,...l,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},ve(t,d=>n.createElement("div",{"aria-hidden":!0},d)))}),L=Object.assign(Bt,{List:Vr,Item:Or,Input:Kr,Group:Lr,Separator:zr,Dialog:Hr,Empty:Ur,Loading:Xr});function qr(t,s){let r=t.nextElementSibling;for(;r;){if(r.matches(s))return r;r=r.nextElementSibling}}function Gr(t,s){let r=t.previousElementSibling;for(;r;){if(r.matches(s))return r;r=r.previousElementSibling}}function Wt(t){let s=n.useRef(t);return Z(()=>{s.current=t}),s}var Z=typeof window>"u"?n.useEffect:n.useLayoutEffect;function re(t){let s=n.useRef();return s.current===void 0&&(s.current=t()),s}function W(t){let s=Re(),r=()=>t(s.snapshot());return n.useSyncExternalStore(s.subscribe,r,r)}function Jt(t,s,r,i=[]){let a=n.useRef(),l=de();return Z(()=>{var d;let m=(()=>{var o;for(let u of r){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(o=u.current.textContent)==null?void 0:o.trim():a.current}})(),h=i.map(o=>o.trim());l.value(t,m,h),(d=s.current)==null||d.setAttribute(se,m),a.current=m}),a}var Yr=()=>{let[t,s]=n.useState(),r=re(()=>new Map);return Z(()=>{r.current.forEach(i=>i()),r.current=new Map},[t]),(i,a)=>{r.current.set(i,a),s({})}};function Br(t){let s=t.type;return typeof s=="function"?s(t.props):"render"in s?s.render(t.props):t}function ve({asChild:t,children:s},r){return t&&n.isValidElement(s)?n.cloneElement(Br(s),{ref:s.ref},r(s.props.children)):r(s)}var Wr={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Qt=n.forwardRef(({className:t,...s},r)=>e.jsx(L,{ref:r,className:M("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...s}));Qt.displayName=L.displayName;const Zt=n.forwardRef(({className:t,...s},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(ys,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(L.Input,{ref:r,className:M("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...s})]}));Zt.displayName=L.Input.displayName;const es=n.forwardRef(({className:t,...s},r)=>e.jsx(L.List,{ref:r,className:M("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...s}));es.displayName=L.List.displayName;const ts=n.forwardRef((t,s)=>e.jsx(L.Empty,{ref:s,className:"py-6 text-center text-sm",...t}));ts.displayName=L.Empty.displayName;const ss=n.forwardRef(({className:t,...s},r)=>e.jsx(L.Group,{ref:r,className:M("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...s}));ss.displayName=L.Group.displayName;const Jr=n.forwardRef(({className:t,...s},r)=>e.jsx(L.Separator,{ref:r,className:M("-mx-1 h-px bg-border",t),...s}));Jr.displayName=L.Separator.displayName;const rs=n.forwardRef(({className:t,...s},r)=>e.jsx(L.Item,{ref:r,className:M("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",t),...s}));rs.displayName=L.Item.displayName;function Qr({options:t,selected:s,onChange:r,placeholder:i="Select items...",label:a,className:l}){const[d,m]=n.useState(!1),h=u=>{r(s.filter(p=>p!==u))},o=u=>{s.includes(u)?r(s.filter(p=>p!==u)):r([...s,u])};return e.jsxs("div",{className:M("grid gap-2",l),children:[a&&e.jsx("label",{className:"text-sm font-medium",children:a}),e.jsxs(js,{open:d,onOpenChange:m,children:[e.jsx(bs,{asChild:!0,children:e.jsxs(P,{variant:"outline",role:"combobox","aria-expanded":d,className:"w-full justify-between text-left font-normal",onClick:()=>m(!d),children:[e.jsx("div",{className:"flex gap-1 flex-wrap",children:s.length>0?s.map(u=>{const p=t.find(f=>f.value===u);return e.jsxs(V,{variant:"secondary",className:"mr-1 mb-1",onClick:f=>{f.preventDefault(),f.stopPropagation(),h(u)},children:[p==null?void 0:p.label,e.jsx("button",{className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",onKeyDown:f=>{f.key==="Enter"&&h(u)},onMouseDown:f=>{f.preventDefault(),f.stopPropagation()},onClick:f=>{f.preventDefault(),f.stopPropagation(),h(u)},children:e.jsx(et,{className:"h-3 w-3 text-muted-foreground hover:text-foreground"})})]},u)}):e.jsx("span",{className:"text-muted-foreground",children:i})}),e.jsx(Hs,{className:"h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ws,{className:"w-full p-0",children:e.jsxs(Qt,{children:[e.jsx(Zt,{placeholder:"Search..."}),e.jsx(ts,{children:"No item found."}),e.jsx(ss,{children:e.jsx(es,{children:t.map(u=>e.jsxs(rs,{onSelect:()=>o(u.value),children:[e.jsx(Ns,{className:M("mr-2 h-4 w-4",s.includes(u.value)?"opacity-100":"opacity-0")}),u.label]},u.value))})})]})})]})]})}function Zr({members:t,selectedIds:s,onSelectionChange:r,label:i="Assigned Members",placeholder:a="Select team members"}){const l=t.map(d=>({label:d.displayName||d.email,value:d.uid}));return e.jsx(Qr,{options:l,selected:s,onChange:r,label:i,placeholder:a})}function ma({task:t,onSubmit:s,onCancel:r,teamMembers:i}){var m;const[a,l]=n.useState({title:(t==null?void 0:t.title)||"",description:(t==null?void 0:t.description)||"",priority:(t==null?void 0:t.priority)||"medium",status:(t==null?void 0:t.status)||"todo",estimatedTime:((m=t==null?void 0:t.estimatedTime)==null?void 0:m.toString())||"",dueDate:(t==null?void 0:t.dueDate)||"",assignedTo:(t==null?void 0:t.assignedTo)||[]}),d=h=>{h.preventDefault(),s({...a,estimatedTime:a.estimatedTime?parseInt(a.estimatedTime,10):void 0,assignedTo:a.assignedTo})};return e.jsxs("form",{onSubmit:d,className:"space-y-6 py-4",children:[e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"title",className:"text-sm font-medium",children:"Title *"}),e.jsx(fe,{id:"title",value:a.title,onChange:h=>l({...a,title:h.target.value}),placeholder:"Enter task title",className:"mt-2 transition-smooth focus:ring-2 focus:ring-primary/20",required:!0})]}),e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"description",className:"text-sm font-medium",children:"Description"}),e.jsx(lt,{id:"description",value:a.description,onChange:h=>l({...a,description:h.target.value}),placeholder:"Enter task description",className:"mt-2 transition-smooth focus:ring-2 focus:ring-primary/20",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"priority",className:"text-sm font-medium",children:"Priority"}),e.jsxs(Oe,{value:a.priority,onValueChange:h=>l({...a,priority:h}),children:[e.jsx(Le,{className:"mt-2",children:e.jsx(ze,{})}),e.jsxs(Ke,{children:[e.jsx(te,{value:"low",children:"Low"}),e.jsx(te,{value:"medium",children:"Medium"}),e.jsx(te,{value:"high",children:"High"})]})]})]}),e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"status",className:"text-sm font-medium",children:"Status"}),e.jsxs(Oe,{value:a.status,onValueChange:h=>l({...a,status:h}),children:[e.jsx(Le,{className:"mt-2",children:e.jsx(ze,{})}),e.jsxs(Ke,{children:[e.jsx(te,{value:"todo",children:"To Do"}),e.jsx(te,{value:"in-progress",children:"In Progress"}),e.jsx(te,{value:"completed",children:"Completed"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"estimatedTime",className:"text-sm font-medium",children:"Estimated Time (minutes)"}),e.jsx(fe,{id:"estimatedTime",type:"number",value:a.estimatedTime,onChange:h=>l({...a,estimatedTime:h.target.value}),placeholder:"25",className:"mt-2 transition-smooth focus:ring-2 focus:ring-primary/20",min:"1"})]}),e.jsxs("div",{children:[e.jsx(ee,{htmlFor:"dueDate",className:"text-sm font-medium",children:"Due Date"}),e.jsx(fe,{id:"dueDate",type:"datetime-local",value:a.dueDate,onChange:h=>l({...a,dueDate:h.target.value}),className:"mt-2 transition-smooth focus:ring-2 focus:ring-primary/20"})]})]}),i.length>0&&e.jsx("div",{children:e.jsx(Zr,{members:i,selectedIds:a.assignedTo,onSelectionChange:h=>l({...a,assignedTo:h})})}),e.jsxs("div",{className:"flex gap-3 pt-6 border-t",children:[e.jsx(P,{type:"submit",variant:"focus",className:"flex-1",children:t?"Update Task":"Create Task"}),e.jsx(P,{type:"button",variant:"outline",onClick:r,className:"hover-scale",children:"Cancel"})]})]})}export{Kt as A,ua as M,da as T,ma as a};
