import{c as H,r as b,aF as Se,aG as De,aH as Me,j as e,e as U,v as D,B as f,aI as Fe,p as P,aJ as Le,an as Ae,ao as Pe,ap as Ie,aq as ee,aK as Re,az as ze,k as Ee,n as ge,C as Y,U as $e,D as Oe,am as Be,z as _e,E as He,F as Ve,G as qe,S as je,aw as fe,V as ye,a2 as Ue,s as Ge,f as te,g as re,h as J,o as ie,m as w,aL as We,aM as Ke,A as Ye,ay as Je,l as Ze,aN as Qe,aD as Xe,aA as es,aO as ss,y as as,K as se,N as ts,a4 as rs,a6 as is,I as ls,t as ns,u as os,w as cs}from"./index-C20fHVmm.js";import{S as ce,a as de,b as me,c as xe,d as A}from"./select-DzEN2igF.js";import{s as ds,C as ms}from"./calendar-BvZK3pUK.js";import{D as xs,g as hs,F as us,a as ps,b as gs,c as js,h as fs,i as ys}from"./drawer-gB5Jcqpd.js";import{M as vs,S as ve,b as Ns,d as ws,e as bs,c as Cs,a as Ts,T as ks}from"./scoring-Pjt2sHeW.js";import{u as Ss,a as Ds}from"./useTouchGestures-CT4C-tcC.js";import{C as Ne,E as Ms,D as Fs}from"./DeleteConfirmationDialog-DqhjKW4I.js";import{S as Ls}from"./alert-dialog-CR5ji12a.js";import{F as we,A as As,C as Ps}from"./ContributionGraph-CkzfhOII.js";import{L as Is,D as Rs}from"./skeletons-Bb8mVUWj.js";import{T as be}from"./trending-up-Dc2fOQoQ.js";import{A as Ce}from"./award-agzPjywG.js";import{s as zs,f as ae}from"./format-CcypP5ZI.js";import{T as he}from"./target-BfCs93Dg.js";import"./subDays-BYudXbBI.js";import"./textarea-DJZO54Po.js";import"./send-5UL8mSPm.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]],$s=H("calendar-check-2",Es);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Bs=H("crown",Os);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=[["circle",{cx:"12",cy:"18",r:"3",key:"1mpf1b"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["path",{d:"M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9",key:"1uq4wg"}],["path",{d:"M12 12v3",key:"158kv8"}]],Hs=H("git-fork",_s);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ue=H("info",Vs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],Us=H("medal",qs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],Ws=H("puzzle",Gs),Ks=b.memo(function({task:s,onEdit:o,onDelete:g,onToggleStatus:l,onTogglePriority:z,onStartTimer:E,assignedProfiles:I=[]}){const[$,t]=b.useState(!1),[x,N]=b.useState(!1),{commentCounts:G}=Se(),{impact:h,notification:C}=Ds(),{trackingTask:v,startTracking:M,stopTracking:O,trackingSubtask:m}=De(),u=(v==null?void 0:v.id)===s.id,k=(m==null?void 0:m.taskId)===s.id,F=Ss({onSwipeLeft:()=>{h("medium"),t(!0)},onSwipeRight:()=>{h("light"),l(s.id)}},{threshold:60,velocityThreshold:.15,ignoreTapFromInteractive:!0}),c=s.dueDate&&new Date(s.dueDate)<new Date&&s.status!=="completed",d=s.status==="completed",j=Me(s),i=()=>{g(s.id),C("error"),t(!1)},V=n=>{const S=new Date(n),R=new Date,Q=S.getTime()-R.getTime(),T=Math.ceil(Q/(1e3*60*60*24));return T===0?"Today":T===1?"Tomorrow":T===-1?"Yesterday":T<0?`${Math.abs(T)} days ago`:`${T} days`},Z=n=>{const S=Math.floor(n/3600),R=Math.floor(n%3600/60);return S>0?`${S}h ${R}m`:`${R}m`},L=G[s.id]||0,W={high:"border-l-destructive",medium:"border-l-primary",low:"border-l-muted-foreground"};return e.jsxs(e.Fragment,{children:[e.jsxs(U,{ref:F,className:D("relative transition-all duration-200 touch-manipulation touch-pan-y z-10","shadow-md hover:shadow-lg border-l-4",c?"border-l-destructive":W[s.priority],d&&"opacity-75 bg-muted/50",c&&!d&&"bg-destructive/5",u&&"ring-2 ring-primary/50",k&&"ring-2 ring-primary/50",j&&"bg-blue-500/5","border border-border/50 rounded-xl"),children:[e.jsx("div",{className:"p-3",onClick:n=>{const S=n.target;(n.target===n.currentTarget||!S.closest('button, a, [role="menuitem"], [data-no-edit-on-click]'))&&o(s)},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(f,{onClick:n=>{n.stopPropagation(),l(s.id),h("light")},variant:"ghost",size:"sm",className:"p-0 h-9 w-9 min-w-[36px] shrink-0 rounded-full hover:bg-primary/10 transition-all",children:d?e.jsx(Ne,{className:"h-5 w-5 text-green-600"}):e.jsx(Fe,{className:"h-5 w-5 text-muted-foreground hover:text-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h3",{className:D("font-semibold text-sm leading-snug line-clamp-2",d&&"line-through text-muted-foreground"),children:s.title}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsxs(f,{onClick:n=>{n.stopPropagation(),N(!x),s.lastCommentedAt&&Le(s.id,s.lastCommentedAt),h("light")},variant:"ghost",size:"sm",className:"p-0 h-8 w-8 rounded-full relative",children:[e.jsx(vs,{className:"h-4 w-4 text-muted-foreground"}),L>0&&e.jsx(P,{variant:"secondary",className:"absolute -top-1 -right-1 h-4 min-w-[16px] justify-center p-0.5 text-[10px]",children:L}),j&&!x&&e.jsx("div",{className:"absolute top-0 right-0 w-2 h-2 bg-primary rounded-full"})]}),e.jsx(f,{onClick:n=>{n.stopPropagation(),z(s.id),h("light")},variant:"ghost",size:"sm",className:"p-0 h-8 w-8 rounded-full hover:bg-yellow-500/10 transition-all",children:s.priority==="high"?e.jsx(ve,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}):e.jsx(Ns,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs(Ae,{children:[e.jsx(Pe,{asChild:!0,children:e.jsx(f,{variant:"ghost",size:"sm",className:"p-0 h-8 w-8 rounded-full hover:bg-muted/50 transition-all",onClick:n=>{n.stopPropagation(),h("light")},children:e.jsx(Ms,{className:"h-4 w-4"})})}),e.jsxs(Ie,{align:"end",className:"w-52 shadow-lg",children:[e.jsxs(ee,{onClick:n=>{n.stopPropagation(),o(s)},children:[e.jsx(Ls,{className:"h-4 w-4 mr-3"}),"Edit Task"]}),e.jsx(ee,{onClick:n=>{n.stopPropagation(),u?O():M(s)},children:u?e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"h-4 w-4 mr-3"}),"Stop Timer"]}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-4 w-4 mr-3"}),"Start Timer"]})}),e.jsxs(ee,{onClick:n=>{n.stopPropagation(),t(!0)},className:"text-destructive",children:[e.jsx(Ee,{className:"h-4 w-4 mr-3"}),"Delete Task"]})]})]})]})]}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 leading-relaxed",children:s.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 text-xs mt-2",children:[s.dueDate&&e.jsxs(P,{variant:c?"destructive":"outline",className:"h-5 text-[10px] px-1.5 py-0.5",children:[e.jsx(ge,{className:"h-2.5 w-2.5 mr-1"}),V(s.dueDate)]}),typeof s.estimatedTime=="number"&&s.estimatedTime>0&&e.jsxs(P,{variant:"secondary",className:"h-5 text-[10px] px-1.5 py-0.5",children:[e.jsx(Y,{className:"h-2.5 w-2.5 mr-1"}),s.estimatedTime,"m"]}),typeof s.timeSpent=="number"&&e.jsxs(P,{variant:"outline",className:"h-5 text-[10px] px-1.5 py-0.5",children:[e.jsx(Y,{className:"h-2.5 w-2.5 mr-1"}),Z(s.timeSpent)]}),I.length>0&&e.jsxs(P,{variant:"outline",className:"h-5 text-[10px] px-1.5 py-0.5",children:[e.jsx($e,{className:"h-2.5 w-2.5 mr-1"}),I.length]})]})]})]})}),e.jsxs("div",{className:"px-3 pb-2 border-t border-border/30","data-no-edit-on-click":!0,children:[(!d||s.subtasks&&s.subtasks.length>0)&&e.jsx(ws,{task:s}),e.jsx(bs,{taskId:s.id,isExpanded:x,onToggleExpanded:()=>N(!x)})]}),u&&e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:"w-3 h-3 bg-primary rounded-full animate-pulse shadow-glow"})})]}),e.jsx(Fs,{open:$,onOpenChange:t,onConfirm:i,itemName:s.title})]})}),q=({icon:a,title:s,description:o,children:g})=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary/10 p-2 rounded-lg",children:e.jsx(a,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:s}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o})]})]}),e.jsx("div",{className:"pl-12 space-y-2",children:g})]}),p=({label:a,value:s,color:o})=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{children:a}),e.jsx(P,{variant:"secondary",className:D(o==="green"&&"text-green-600 bg-green-100 border-green-200",o==="red"&&"text-red-600 bg-red-100 border-red-200",o==="blue"&&"text-blue-600 bg-blue-100 border-blue-200"),children:s})]});function Ys(){return e.jsxs(Oe,{children:[e.jsx(Be,{asChild:!0,children:e.jsx(f,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:bg-accent",children:e.jsx(ue,{className:"h-4 w-4"})})}),e.jsxs(_e,{className:"sm:max-w-lg",children:[e.jsxs(He,{children:[e.jsxs(Ve,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5"}),"How Scoring Works"]}),e.jsx(qe,{children:"Your score is calculated based on task complexity, priority, timeliness, and streaks."})]}),e.jsx(je,{className:"h-[60vh] pr-4",children:e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs(q,{icon:Ws,title:"Task Complexity",description:"Points based on estimated time.",children:[e.jsx(p,{label:"Simple (< 30m)",value:"+10 pts"}),e.jsx(p,{label:"Standard (30-90m)",value:"+20 pts"}),e.jsx(p,{label:"Complex (> 90m)",value:"+30 pts"})]}),e.jsxs(q,{icon:ve,title:"Priority Bonus",description:"A multiplier applied to the base score.",children:[e.jsx(p,{label:"High Priority",value:"x 1.5",color:"red"}),e.jsx(p,{label:"Medium Priority",value:"x 1.0"}),e.jsx(p,{label:"Low Priority",value:"x 0.75"})]}),e.jsxs(q,{icon:$s,title:"Timeliness Factor",description:"Bonuses for early completion, penalties for being late.",children:[e.jsx(p,{label:"Early Bird (> 24h early)",value:"+20%",color:"green"}),e.jsx(p,{label:"On Track (< 24h early)",value:"+10%",color:"green"}),e.jsx(p,{label:"On Time (Due day)",value:"+0%"}),e.jsx(p,{label:"Slightly Late (< 24h late)",value:"-25%",color:"red"}),e.jsx(p,{label:"Delayed (1-3 days late)",value:"-50%",color:"red"}),e.jsx(p,{label:"Overdue (> 3 days late)",value:"0 pts",color:"red"})]}),e.jsxs(q,{icon:we,title:"Daily Streak Bonus",description:"Complete tasks on consecutive days for a score multiplier.",children:[e.jsx(p,{label:"Warm-up (2-3 days)",value:"+5%",color:"blue"}),e.jsx(p,{label:"In the Zone (4-6 days)",value:"+10%",color:"blue"}),e.jsx(p,{label:"On Fire (7+ days)",value:"+20%",color:"blue"})]}),e.jsx(q,{icon:Hs,title:"Progressive Tasks",description:"Earn credit for making progress on larger tasks.",children:e.jsxs("ul",{className:"text-sm text-muted-foreground list-disc pl-4 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Partial Credit:"})," Incomplete tasks earn points based on the percentage of subtasks you've finished."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Proportional Score:"})," Completed tasks with subtasks get a final score proportional to how many subtasks were also completed."]})]})})]})})]})]})}const Js=a=>a===0?e.jsx(Bs,{className:"h-5 w-5 text-yellow-400"}):a===1?e.jsx(Ce,{className:"h-5 w-5 text-gray-400"}):a===2?e.jsx(Us,{className:"h-5 w-5 text-orange-400"}):e.jsx("span",{className:"text-sm font-bold w-5 text-center",children:a+1}),Zs=a=>{if(a<60)return"~1m";const s=Math.floor(a/60),o=Math.floor(s/60);return o>0?`${o}h ${s%60}m`:`${s}m`};function Qs(){const{tasks:a,teamMembers:s,loading:o}=fe(),{userProfile:g}=ye(),[l,z]=b.useState("week"),[E,I]=b.useState(null),$=b.useMemo(()=>{const t=new Date;let x,N=Ue(t);return l==="day"?x=Ge(t):l==="week"?x=zs(t):x=ds(t),s.map(h=>{const C=a.filter(c=>c.createdBy===h.uid),v=Cs(C,x,N),M=C.filter(c=>{if(c.status!=="completed"||!c.completedAt)return!1;const d=new Date(c.completedAt);return d>=x&&d<=N}),O=M.length;let m=0;C.forEach(c=>{var d;(d=c.subtasks)==null||d.forEach(j=>{if(j.isCompleted&&j.completedAt){const i=new Date(j.completedAt);i>=x&&i<=N&&m++}})});const u=M.reduce((c,d)=>c+(d.timeSpent||0),0);let k=0;C.forEach(c=>{var d;(d=c.subtasks)==null||d.forEach(j=>{if(j.isCompleted&&j.completedAt){const i=new Date(j.completedAt);i>=x&&i<=N&&(k+=j.timeSpent||0)}})});const F=u+k;return{userId:h.uid,name:h.displayName||h.email,avatarUrl:h.photoURL,score:v,tasksCompleted:O+m,mainTasksCompleted:O,subtasksCompleted:m,totalTimeSpent:F}}).sort((h,C)=>C.score-h.score)},[a,s,l]);return o?e.jsx(Is,{}):s.length<=1?null:e.jsxs(U,{className:"shadow-elegant",children:[e.jsx(te,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5 text-primary"}),"Team Leaderboard"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ys,{}),e.jsx("div",{className:"flex items-center gap-1 p-1 bg-muted rounded-lg",children:["day","week","month"].map(t=>e.jsx(f,{size:"sm",variant:l===t?"default":"ghost",onClick:()=>z(t),className:"capitalize text-xs h-7 px-2",children:t},t))})]})]})}),e.jsx(J,{children:e.jsx(ie,{children:e.jsx(w.ul,{className:"space-y-1",initial:{opacity:0},animate:{opacity:1,transition:{staggerChildren:.07}},children:$.length>0?$.slice(0,5).map((t,x)=>e.jsx(We,{asChild:!0,open:E===t.userId,onOpenChange:()=>I(E===t.userId?null:t.userId),children:e.jsxs(w.li,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:D("rounded-lg transition-colors",t.userId===(g==null?void 0:g.uid)&&"bg-primary/10"),children:[e.jsx(Ke,{className:"w-full",children:e.jsxs("div",{className:"flex items-center gap-4 p-2 rounded-lg",children:[e.jsx("div",{className:"w-6 flex items-center justify-center",children:Js(x)}),e.jsxs(Ye,{className:"h-10 w-10 border-2 border-background shadow-sm",children:[e.jsx(Je,{src:t.avatarUrl}),e.jsx(Ze,{className:"bg-muted text-xs",children:t.name.split(" ").map(N=>N[0]).join("").toUpperCase()})]}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("p",{className:"font-medium text-sm truncate",children:t.name}),e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[e.jsxs("span",{children:[t.tasksCompleted," items"]}),t.totalTimeSpent>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground/50",children:"•"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"h-3 w-3"}),Zs(t.totalTimeSpent)]})]})]})]}),e.jsx(P,{variant:"secondary",className:"font-bold text-base px-3 py-1 rounded-full",children:t.score})]})}),e.jsx(Qe,{children:e.jsx(w.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"pl-12 pr-4 pb-2",children:e.jsxs("div",{className:"bg-muted/50 p-3 rounded-md border space-y-2",children:[e.jsx("h4",{className:"text-xs font-semibold text-muted-foreground",children:"Performance Breakdown"}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"h-4 w-4"})," Main Tasks"]}),e.jsx("span",{className:"font-bold",children:t.mainTasksCompleted})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"})," Subtasks"]}),e.jsx("span",{className:"font-bold",children:t.subtasksCompleted})]})]})})})]})},t.userId)):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{children:"No completed tasks for this period yet."})})},l)})})]})}const Xs={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},K={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}},_=({title:a,value:s,icon:o,colorClass:g,bgColorClass:l})=>e.jsx(w.div,{variants:K,children:e.jsx(U,{className:"shadow-elegant overflow-hidden",children:e.jsxs(J,{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:a}),e.jsx("p",{className:D("text-xl sm:text-2xl font-bold",g),children:s})]}),e.jsx("div",{className:D("h-10 w-10 sm:h-12 sm:w-12 rounded-lg flex items-center justify-center",l),children:e.jsx(o,{className:D("h-5 w-5 sm:h-6 sm:w-6",g)})})]})})}),pe=({filters:a,setFilters:s,isMobile:o,inDrawer:g=!1})=>e.jsxs("div",{className:D("grid gap-4",g?"grid-cols-1 p-4":"sm:grid-cols-2 lg:grid-cols-4"),children:[e.jsxs("div",{className:"relative",children:[e.jsx(is,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ls,{placeholder:"Search tasks...",value:a.search,onChange:l=>s({...a,search:l.target.value}),className:"pl-10"})]}),e.jsxs(ce,{value:a.status,onValueChange:l=>s({...a,status:l}),children:[e.jsx(de,{children:e.jsx(me,{placeholder:"Filter by status"})}),e.jsxs(xe,{children:[e.jsx(A,{value:"all",children:"All Status"}),e.jsx(A,{value:"todo",children:"To Do"}),e.jsx(A,{value:"in-progress",children:"In Progress"}),e.jsx(A,{value:"completed",children:"Completed"})]})]}),e.jsxs(ce,{value:a.priority,onValueChange:l=>s({...a,priority:l}),children:[e.jsx(de,{children:e.jsx(me,{placeholder:"Filter by priority"})}),e.jsxs(xe,{children:[e.jsx(A,{value:"all",children:"All Priority"}),e.jsx(A,{value:"low",children:"Low"}),e.jsx(A,{value:"medium",children:"Medium"}),e.jsx(A,{value:"high",children:"High"})]})]}),e.jsxs(ns,{children:[e.jsx(os,{asChild:!0,children:e.jsxs(f,{variant:"outline",className:D("justify-start text-left font-normal",!a.dateRange.from&&"text-muted-foreground"),children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),a.dateRange.from?a.dateRange.to?`${ae(a.dateRange.from,"LLL dd")} - ${ae(a.dateRange.to,"LLL dd")}`:ae(a.dateRange.from,"LLL dd, y"):e.jsx("span",{children:"Pick a date range"})]})}),e.jsx(cs,{className:"w-auto p-0",align:"start",children:e.jsx(ms,{initialFocus:!0,mode:"range",selected:a.dateRange,onSelect:l=>s({...a,dateRange:{from:l==null?void 0:l.from,to:l==null?void 0:l.to}}),numberOfMonths:o?1:2})})]})]});function ja(){const{tasks:a,teamMembers:s,setTaskFormActive:o,addTask:g,updateTask:l,deleteTask:z,toggleTaskStatus:E,toggleTaskPriority:I,getTotalTasksCount:$,getCompletedTasksCount:t,getActiveTasksCount:x,getCurrentStreak:N,getLongestStreak:G,loading:h}=fe(),{startTaskTimer:C}=es(),{user:v,userProfile:M,loading:O}=ye();ss();const m=as(),[u,k]=b.useState(null),[F,c]=b.useState(!1),[d,j]=b.useState(!1),[i,V]=b.useState({status:"all",priority:"all",dateRange:{from:void 0,to:void 0},search:""});b.useEffect(()=>(o(F||!!u),()=>o(!1)),[F,u,o]);const Z=h||O,L=$(),W=t(),n=x(),S=N(),R=G(),Q=L>0?Math.round(W/L*100):0,T=a.filter(r=>{var y;if(i.status!=="all"&&r.status!==i.status||i.priority!=="all"&&r.priority!==i.priority||i.search&&!r.title.toLowerCase().includes(i.search.toLowerCase())&&!((y=r.description)!=null&&y.toLowerCase().includes(i.search.toLowerCase())))return!1;if(i.dateRange.from||i.dateRange.to){const B=new Date(r.createdAt);if(i.dateRange.from&&B<i.dateRange.from||i.dateRange.to&&B>i.dateRange.to)return!1}return!0}),Te=r=>{const y={...r,createdBy:(v==null?void 0:v.uid)||null};y.estimatedTime===void 0&&delete y.estimatedTime,g(y),c(!1)},ke=r=>{u&&(l(u.id,r),k(null))},le=r=>{const y=a.find(B=>B.id===r);y&&C(y)},ne=()=>{V({status:"all",priority:"all",dateRange:{from:void 0,to:void 0},search:""}),m&&j(!1)},X=()=>{let r=0;return i.status!=="all"&&r++,i.priority!=="all"&&r++,i.search&&r++,i.dateRange.from&&r++,r},oe=r=>!r||r.length===0?[]:r.map(y=>s.find(B=>B.uid===y)).filter(y=>y!==void 0);return Z?e.jsx(Rs,{}):F||u?e.jsx("div",{className:"container max-w-2xl mx-auto p-4 sm:p-6",children:e.jsx(Ts,{task:u,onSubmit:u?ke:Te,onCancel:()=>{c(!1),k(null)},teamMembers:s})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"container max-w-7xl mx-auto p-4 md:p-6 space-y-6",children:[e.jsx(w.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"Dashboard"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Welcome back, ",(M==null?void 0:M.displayName)||(v==null?void 0:v.email),"!"]})]}),!m&&e.jsxs(f,{onClick:()=>c(!0),variant:"focus",className:"hover-scale",children:[e.jsx(se,{className:"h-4 w-4 mr-2"})," New Task"]})]})}),e.jsxs(w.div,{variants:Xs,initial:"hidden",animate:"visible",className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:[e.jsx(_,{title:"Total Tasks",value:L,icon:he,colorClass:"text-primary",bgColorClass:"bg-primary/10"}),e.jsx(_,{title:"Completed",value:W,icon:ts,colorClass:"text-success",bgColorClass:"bg-success/10"}),e.jsx(_,{title:"Active Tasks",value:n,icon:Y,colorClass:"text-focus",bgColorClass:"bg-focus/10"}),e.jsx(_,{title:"Completion Rate",value:`${Q}%`,icon:be,colorClass:"text-break",bgColorClass:"bg-break/10"}),e.jsx(_,{title:"Current Streak",value:`${S} ${S===1?"day":"days"}`,icon:we,colorClass:"text-orange-500",bgColorClass:"bg-orange-500/10"}),e.jsx(_,{title:"Longest Streak",value:`${R} ${R===1?"day":"days"}`,icon:Ce,colorClass:"text-purple-500",bgColorClass:"bg-purple-500/10"})]}),!m&&e.jsx(w.div,{variants:K,initial:"hidden",animate:"visible",children:e.jsxs(U,{className:"shadow-elegant",children:[e.jsx(te,{children:e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(As,{className:"h-5 w-5"}),"Activity Overview"]})}),e.jsx(J,{children:e.jsx(Ps,{})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(w.div,{variants:K,initial:"hidden",animate:"visible",className:"lg:col-span-2",children:e.jsxs(U,{className:"shadow-elegant",children:[e.jsx(te,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(re,{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5"}),"Task Management"]}),!m&&X()>0&&e.jsx(f,{variant:"outline",size:"sm",onClick:ne,className:"hover-scale",children:"Clear Filters"})]})}),e.jsxs(J,{className:"space-y-4 p-4 md:p-6",children:[m?e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 text-sm text-muted-foreground",children:["Showing ",T.length," of ",L," tasks"]}),e.jsxs(xs,{open:d,onOpenChange:j,children:[e.jsx(hs,{asChild:!0,children:e.jsxs(f,{variant:"outline",size:"sm",className:"shrink-0",children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Filters"}),X()>0&&e.jsx(P,{variant:"secondary",className:"ml-2 px-1.5 py-0.5 text-xs",children:X()})]})}),e.jsxs(ps,{children:[e.jsx(gs,{children:e.jsx(js,{children:"Filter Tasks"})}),e.jsx(pe,{inDrawer:!0,filters:i,setFilters:V,isMobile:m}),e.jsxs(fs,{className:"flex-row gap-2",children:[e.jsx(ys,{asChild:!0,children:e.jsx(f,{variant:"outline",className:"flex-1",children:"Close"})}),e.jsx(f,{onClick:ne,variant:"destructive",className:"flex-1",children:"Clear Filters"})]})]})]})]}):e.jsx(pe,{filters:i,setFilters:V,isMobile:m}),e.jsx(je,{className:"h-[500px]",children:T.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-12 px-4",children:[e.jsx(he,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground/30"}),e.jsx("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:"No tasks found"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4 max-w-xs",children:L===0?"Create your first task to get started.":"Try adjusting your filters or create a new task."}),e.jsxs(f,{onClick:()=>c(!0),variant:"focus",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Create Task"]})]}):e.jsx("div",{className:"space-y-3 pr-3",children:e.jsx(ie,{children:T.map(r=>e.jsx(w.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,transition:{duration:.2}},children:m?e.jsx(Ks,{task:r,onEdit:k,onDelete:z,onToggleStatus:E,onTogglePriority:I,onStartTimer:le,assignedProfiles:oe(r.assignedTo)},r.id):e.jsx(ks,{task:r,onEdit:k,onDelete:z,onToggleStatus:E,onTogglePriority:I,onStartTimer:le,assignedProfiles:oe(r.assignedTo)},r.id)},r.id))})})})]})]})}),e.jsx(w.div,{variants:K,initial:"hidden",animate:"visible",children:e.jsx(Qs,{})})]})]}),m&&e.jsx(ie,{children:!F&&!u&&e.jsx(w.div,{initial:{scale:0,y:100},animate:{scale:1,y:0},exit:{scale:0,y:100},transition:{type:"spring",stiffness:260,damping:20},className:"fixed bottom-6 right-6 z-50",children:e.jsxs(f,{onClick:()=>c(!0),variant:"focus",size:"icon",className:"h-14 w-14 rounded-full shadow-lg shadow-primary/30",children:[e.jsx(se,{className:"h-6 w-6"}),e.jsx("span",{className:"sr-only",children:"Create New Task"})]})})})]})}export{ja as default};
