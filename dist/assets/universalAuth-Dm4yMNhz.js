const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Coi4WSvr.js","assets/index-DtXyLFv9.css"])))=>i.map(i=>d[i]);
var l=Object.defineProperty;var c=(e,i,t)=>i in e?l(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t;var n=(e,i,t)=>c(e,typeof i!="symbol"?i+"":i,t);import{c0 as Capacitor,c1 as GoogleAuthProvider,c2 as signInWithCredential,c3 as auth,c4 as signInWithPopup,c5 as googleProvider,bm as __vitePreload}from"./index-Coi4WSvr.js";const isNative=()=>Capacitor.isNativePlatform();class UniversalGoogleAuth{static async initialize(){this.initialized||(isNative()&&console.log("Native platform detected - Google Auth plugin required for full functionality"),this.initialized=!0)}static async signIn(){if(await this.initialize(),isNative())try{return await this.signInNative()}catch(e){return console.warn("Native Google Auth not available, falling back to web auth:",e),await this.signInWeb()}else return this.signInWeb()}static async signInNative(){var e,i;try{if(!await this.checkPluginAvailability())throw new Error("Google Auth plugin not available - install @capacitor/google-auth for native authentication");const a=await this.loadGoogleAuthPlugin();if(!a)throw new Error("Google Auth plugin not installed");await a.initialize();const r=await a.signIn(),s=GoogleAuthProvider.credential(r.authentication.idToken),o=await signInWithCredential(auth,s);return console.log("Native Google Sign-In successful:",o.user.email),o}catch(t){throw console.error("Native Google Sign-In failed:",t),(e=t.message)!=null&&e.includes("User cancelled")?new Error("Sign-in was cancelled. Please try again."):(i=t.message)!=null&&i.includes("No account selected")?new Error("No Google account selected. Please try again."):t}}static async signInWeb(){var e;try{return typeof window<"u"&&window.sessionStorage&&Object.keys(window.sessionStorage).forEach(t=>{(t.startsWith("firebase:authUser:")||t.startsWith("firebase:redirectUser:"))&&window.sessionStorage.removeItem(t)}),await signInWithPopup(auth,googleProvider)}catch(i){throw console.error("Web Google Sign-In failed:",i),i.code==="auth/popup-closed-by-user"?new Error("Sign-in was cancelled. Please try again."):i.code==="auth/popup-blocked"?new Error("Popup was blocked by your browser. Please allow popups and try again."):i.code==="auth/cancelled-popup-request"?new Error("Another sign-in popup is already open. Please close it and try again."):(e=i.message)!=null&&e.includes("initial state")?(typeof window<"u"&&window.sessionStorage&&window.sessionStorage.clear(),new Error("Authentication state error. Please refresh the page and try again.")):i}}static async checkPluginAvailability(){try{const{Capacitor:e}=await __vitePreload(async()=>{const{Capacitor:i}=await import("./index-Coi4WSvr.js").then(t=>t.c6);return{Capacitor:i}},__vite__mapDeps([0,1]));return e.isPluginAvailable("GoogleAuth")}catch{return!1}}static async signOut(){if(isNative())try{const e=await this.loadGoogleAuthPlugin();e&&(await e.signOut(),console.log("Native Google sign out completed"))}catch(e){console.warn("Native Google sign out failed:",e)}}static async loadGoogleAuthPlugin(){try{const moduleName="@capacitor/google-auth",module=await eval(`import('${moduleName}')`).catch(()=>null);return(module==null?void 0:module.GoogleAuth)||null}catch(e){return console.warn("Failed to load Google Auth plugin:",e),null}}static async getStatus(){const e=await this.checkPluginAvailability();return{isNative:isNative(),isPluginAvailable:e,isInitialized:this.initialized}}}n(UniversalGoogleAuth,"initialized",!1);export{UniversalGoogleAuth};
