import{c as Be,aU as Ve,r as i,aW as ye,bh as Le,j as e,aR as be,aY as _e,bg as De,q as ie,F as ze,bH as He,a7 as le,a8 as de,L as F,e as _,h as D,A as G,aB as oe,k as J,ao as Pe,B as O,aA as me,m as j,U as he,l as Ye,f as W,g as X,z as $e,a9 as xe,aa as U,ab as A,ac as M,ad as B,I as z,ae as ue,n as k,bj as Ke,bI as Ge,aT as Je,X as Oe,a2 as we,a3 as H,bJ as We,a6 as Xe,bK as c}from"./index-BOMCLsi_.js";import{u as Qe}from"./index-CqAVEad7.js";import{S as pe}from"./separator-CMjyzDEp.js";import{S as fe,a as je,b as ge,c as Ne,d as w}from"./select-QNqOlXgW.js";import{C as Ze}from"./circle-alert-qborrgbw.js";import{S as es,G as ss}from"./shield-mt4kqRrh.js";import{U as ve}from"./user-plus-MUTCKdY9.js";import"./chevron-down-QVhbesXr.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],ts=Be("palette",as);var P="Switch",[rs,Ns]=Ve(P),[ns,cs]=rs(P),Se=i.forwardRef((t,a)=>{const{__scopeSwitch:n,name:u,checked:h,defaultChecked:E,required:g,disabled:p,value:N="on",onCheckedChange:l,form:x,...R}=t,[f,v]=i.useState(null),o=ye(a,b=>v(b)),y=i.useRef(!1),T=f?x||!!f.closest("form"):!0,[S,Y]=Le({prop:h,defaultProp:E??!1,onChange:l,caller:P});return e.jsxs(ns,{scope:n,checked:S,disabled:p,children:[e.jsx(be.button,{type:"button",role:"switch","aria-checked":S,"aria-required":g,"data-state":Re(S),"data-disabled":p?"":void 0,disabled:p,value:N,...R,ref:o,onClick:_e(t.onClick,b=>{Y(C=>!C),T&&(y.current=b.isPropagationStopped(),y.current||b.stopPropagation())})}),T&&e.jsx(Ee,{control:f,bubbles:!y.current,name:u,value:N,checked:S,required:g,disabled:p,form:x,style:{transform:"translateX(-100%)"}})]})});Se.displayName=P;var Ce="SwitchThumb",ke=i.forwardRef((t,a)=>{const{__scopeSwitch:n,...u}=t,h=cs(Ce,n);return e.jsx(be.span,{"data-state":Re(h.checked),"data-disabled":h.disabled?"":void 0,...u,ref:a})});ke.displayName=Ce;var is="SwitchBubbleInput",Ee=i.forwardRef(({__scopeSwitch:t,control:a,checked:n,bubbles:u=!0,...h},E)=>{const g=i.useRef(null),p=ye(g,E),N=Qe(n),l=De(a);return i.useEffect(()=>{const x=g.current;if(!x)return;const R=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(R,"checked").set;if(N!==n&&v){const o=new Event("click",{bubbles:u});v.call(x,n),x.dispatchEvent(o)}},[N,n,u]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...h,tabIndex:-1,ref:p,style:{...h.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Ee.displayName=is;function Re(t){return t?"checked":"unchecked"}var Te=Se,ls=ke;const qe=i.forwardRef(({className:t,...a},n)=>e.jsx(Te,{className:ie("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:n,children:e.jsx(ls,{className:ie("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));qe.displayName=Te.displayName;const ds=we({displayName:H().min(2,"Name must be at least 2 characters"),email:H().email("Invalid email address")}),os=we({notifications:We().optional(),theme:Xe(["light","dark","system"]).optional(),language:H().optional()});function vs(){var ee,se,ae,te,re,ne,ce;const{user:t,userProfile:a,updateUserProfile:n,sendVerificationEmail:u,sendTeamRequest:h,fetchReceivedTeamRequests:E,acceptTeamRequest:g,declineTeamRequest:p,fetchTeamMembers:N,loading:l}=ze(),{theme:x,setTheme:R}=He(),[f,v]=i.useState(!1),[o,y]=i.useState(""),[T,S]=i.useState([]),[Y,b]=i.useState([]),[C,Q]=i.useState(!1);i.useEffect(()=>{t&&($(),Z())},[t,a==null?void 0:a.teamId]);const $=async()=>{if(!t)return;const s=await E();S(s)},Z=async()=>{if(!t||!(a!=null&&a.teamId)){b([]);return}const s=await N();b(s)},V=async()=>{if(!o.trim())return;const s=o.split(",").map(r=>r.trim()).filter(r=>H().email().safeParse(r).success);if(s.length===0){c({title:"Invalid Email",description:"Please provide at least one valid email address.",variant:"destructive"});return}try{Q(!0);const r=await Promise.allSettled(s.map(m=>h(m))),d=r.filter(m=>m.status==="fulfilled").length,I=r.filter(m=>m.status==="rejected").length;d>0?c({title:"Team requests sent!",description:`Successfully sent ${d} request${d!==1?"s":""}${I>0?`. ${I} failed.`:"."}`}):c({title:"Failed to send requests",description:"Please check the email addresses and try again.",variant:"destructive"}),y("")}catch(r){console.error("Error sending team request:",r),c({title:"An error occurred",description:r.message||"Could not send team requests.",variant:"destructive"})}finally{Q(!1)}},Ie=async(s,r)=>{try{await g(s,r),await $(),await Z(),c({title:"Team request accepted!",description:"You've joined a new team."})}catch(d){console.error("Error accepting request:",d),c({title:"Error",description:d.message,variant:"destructive"})}},Fe=async s=>{try{await p(s),await $(),c({title:"Request declined."})}catch(r){console.error("Error declining request:",r),c({title:"Error",description:r.message,variant:"destructive"})}},L=le({resolver:de(ds),defaultValues:{displayName:(a==null?void 0:a.displayName)||"",email:(t==null?void 0:t.email)||""},values:{displayName:(a==null?void 0:a.displayName)||"",email:(t==null?void 0:t.email)||""}}),q=le({resolver:de(os),defaultValues:{notifications:((ee=a==null?void 0:a.preferences)==null?void 0:ee.notifications)??!0,theme:((se=a==null?void 0:a.preferences)==null?void 0:se.theme)||x||"system",language:((ae=a==null?void 0:a.preferences)==null?void 0:ae.language)||"en"},values:{notifications:((te=a==null?void 0:a.preferences)==null?void 0:te.notifications)??!0,theme:((re=a==null?void 0:a.preferences)==null?void 0:re.theme)||x||"system",language:((ne=a==null?void 0:a.preferences)==null?void 0:ne.language)||"en"}}),Ue=async s=>{try{await n({displayName:s.displayName}),v(!1),c({title:"Profile updated successfully!"})}catch(r){console.error("Error updating profile:",r),c({title:"Error",description:r.message,variant:"destructive"})}},Ae=async s=>{var r,d,I;try{s.theme&&R(s.theme);const m={notifications:s.notifications??((r=a==null?void 0:a.preferences)==null?void 0:r.notifications)??!0,theme:s.theme??((d=a==null?void 0:a.preferences)==null?void 0:d.theme)??"system",language:s.language??((I=a==null?void 0:a.preferences)==null?void 0:I.language)??"en"};await n({preferences:m}),c({title:"Preferences saved!"})}catch(m){console.error("Error updating preferences:",m),c({title:"Error",description:m.message,variant:"destructive"})}},Me=async()=>{try{await u(),c({title:"Verification email sent!",description:"Check your inbox to verify your email address."})}catch(s){console.error("Error sending verification email:",s),c({title:"Error",description:s.message,variant:"destructive"})}},K=(s,r)=>s&&s.trim()?s.split(" ").map(d=>d[0]).join("").toUpperCase().slice(0,2):r?r.split("@")[0].slice(0,2).toUpperCase():"??";return!t||!a?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(F,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsx("div",{className:"container mx-auto p-4 md:p-6 lg:p-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(_,{className:"shadow-elegant lg:col-span-1",children:e.jsxs(D,{className:"pt-6 flex flex-col items-center text-center",children:[e.jsxs(G,{className:"h-24 w-24 mb-4",children:[e.jsx(oe,{src:a.photoURL||"",alt:a.displayName||""}),e.jsx(J,{className:"text-3xl",children:K(a.displayName,a.email)})]}),e.jsx("h2",{className:"text-2xl font-semibold",children:a.displayName}),e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(Pe,{className:"h-3 w-3"}),a.email]}),e.jsx("div",{className:"mt-4",children:t.emailVerified?e.jsxs(O,{variant:"secondary",className:"border-green-500/50 bg-green-500/10 text-green-700 dark:text-green-400",children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),"Verified"]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs(O,{variant:"destructive",children:[e.jsx(Ze,{className:"h-3 w-3 mr-1"}),"Not Verified"]}),e.jsx(j,{variant:"link",className:"h-auto p-0 text-xs",onClick:Me,disabled:l,children:"Resend verification email"})]})}),e.jsx(pe,{className:"my-6"}),e.jsxs("div",{className:"w-full text-left space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-center mb-2 uppercase tracking-wider text-muted-foreground",children:"Account Status"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(he,{className:"h-4 w-4"})," Team Status"]}),e.jsx("span",{className:"font-medium",children:a.teamId?"In a Team":"No Team"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(es,{className:"h-4 w-4"})," Account"]}),e.jsx("span",{className:"font-medium",children:"Member"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ye,{className:"h-4 w-4"})," Joined"]}),e.jsx("span",{className:"font-medium",children:(ce=t.metadata)!=null&&ce.creationTime?new Date(t.metadata.creationTime).toLocaleDateString():"N/A"})]})]})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(_,{className:"shadow-elegant",children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5"}),"Basic Information"]}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>v(!f),children:f?"Cancel":"Edit"})]})}),e.jsx(D,{children:f?e.jsx(xe,{...L,children:e.jsxs("form",{onSubmit:L.handleSubmit(Ue),className:"space-y-4",children:[e.jsx(U,{control:L.control,name:"displayName",render:({field:s})=>e.jsxs(A,{children:[e.jsx(M,{children:"Display Name"}),e.jsx(B,{children:e.jsx(z,{placeholder:"Your name",...s})}),e.jsx(ue,{})]})}),e.jsx(U,{control:L.control,name:"email",render:({field:s})=>e.jsxs(A,{children:[e.jsx(M,{children:"Email Address"}),e.jsx(B,{children:e.jsx(z,{placeholder:"your@email.com",...s,disabled:!0})}),e.jsx(ue,{}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Email cannot be changed for security reasons."})]})}),e.jsx(j,{type:"submit",disabled:l,variant:"focus",children:l?e.jsx(F,{className:"h-4 w-4 mr-2 animate-spin"}):"Save Changes"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-sm font-medium",children:"Display Name"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.displayName||"Not set"})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-sm font-medium",children:"Email Address"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.email})]})]})})]}),e.jsxs(_,{className:"shadow-elegant",children:[e.jsx(W,{children:e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"h-5 w-5"}),"Preferences"]})}),e.jsx(D,{children:e.jsx(xe,{...q,children:e.jsxs("form",{onSubmit:q.handleSubmit(Ae),className:"space-y-6",children:[e.jsx(U,{control:q.control,name:"notifications",render:({field:s})=>e.jsxs(A,{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs(M,{className:"flex items-center gap-2 text-base",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Push Notifications"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive notifications for tasks and reminders."})]}),e.jsx(B,{children:e.jsx(qe,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(U,{control:q.control,name:"theme",render:({field:s})=>e.jsxs(A,{children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(ts,{className:"h-4 w-4"}),"Theme"]}),e.jsxs(fe,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(B,{children:e.jsx(je,{children:e.jsx(ge,{placeholder:"Select theme"})})}),e.jsxs(Ne,{children:[e.jsx(w,{value:"light",children:"Light"}),e.jsx(w,{value:"dark",children:"Dark"}),e.jsx(w,{value:"system",children:"System"})]})]})]})}),e.jsx(U,{control:q.control,name:"language",render:({field:s})=>e.jsxs(A,{children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(ss,{className:"h-4 w-4"}),"Language"]}),e.jsxs(fe,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(B,{children:e.jsx(je,{children:e.jsx(ge,{placeholder:"Select language"})})}),e.jsxs(Ne,{children:[e.jsx(w,{value:"en",children:"English"}),e.jsx(w,{value:"es",children:"Español"}),e.jsx(w,{value:"fr",children:"Français"}),e.jsx(w,{value:"de",children:"Deutsch"})]})]})]})}),e.jsx(j,{type:"submit",disabled:l,variant:"focus",children:l?e.jsx(F,{className:"h-4 w-4 mr-2 animate-spin"}):"Save Preferences"})]})})})]}),e.jsxs(_,{className:"shadow-elegant",children:[e.jsx(W,{children:e.jsxs(X,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5"}),"Team Collaboration"]})}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-6",children:[a!=null&&a.teamId?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-green-500/5 border border-green-500/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(me,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"font-medium text-green-600 dark:text-green-400",children:"You're part of a team!"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx(k,{className:"text-sm font-medium",children:"Team Members"}),e.jsx("div",{className:"mt-2 space-y-2",children:Y.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background/50 rounded-lg",children:[e.jsxs(G,{className:"h-8 w-8",children:[e.jsx(oe,{src:s.photoURL||""}),e.jsx(J,{className:"text-xs",children:K(s.displayName,s.email)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:s.displayName||"User"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.email})]}),s.uid===(t==null?void 0:t.uid)&&e.jsx(O,{variant:"secondary",className:"text-xs",children:"You"})]},s.uid))})]})})]}),e.jsx(pe,{}),e.jsxs("div",{children:[e.jsx(k,{htmlFor:"teamRequestEmail",className:"text-sm font-medium",children:"Invite More Members"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(z,{id:"teamRequestEmail",type:"text",placeholder:"colleague1@example.com, colleague2@example.com",value:o,onChange:s=>y(s.target.value),onKeyPress:s=>s.key==="Enter"&&V(),className:"flex-1"}),e.jsx(j,{onClick:V,disabled:!o.trim()||C,variant:"focus",className:"hover-scale",children:C?e.jsx(F,{className:"h-4 w-4 animate-spin"}):e.jsx(ve,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Send collaboration requests (separate multiple emails with commas)."})]})]}):e.jsxs("div",{children:[e.jsx(k,{htmlFor:"teamRequestEmail",className:"text-sm font-medium",children:"Invite Team Member"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(z,{id:"teamRequestEmail",type:"text",placeholder:"colleague1@example.com, colleague2@example.com",value:o,onChange:s=>y(s.target.value),onKeyPress:s=>s.key==="Enter"&&V(),className:"flex-1"}),e.jsx(j,{onClick:V,disabled:!o.trim()||C,variant:"focus",className:"hover-scale",children:C?e.jsx(F,{className:"h-4 w-4 animate-spin"}):e.jsx(ve,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Send a request to start a team or join an existing one."})]}),T.length>0&&e.jsxs("div",{children:[e.jsx(k,{className:"text-sm font-medium",children:"Pending Requests"}),e.jsx("div",{className:"mt-2 space-y-2",children:T.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{className:"h-8 w-8",children:e.jsx(J,{className:"text-xs",children:K(s.senderName,s.senderEmail)})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s.senderName||"User"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.senderEmail})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{size:"icon",variant:"outline",onClick:()=>Ie(s.id,s.senderId),disabled:l,className:"h-8 w-8 hover-scale text-green-500 hover:bg-green-500/10 hover:border-green-500/20",children:e.jsx(Je,{className:"h-4 w-4"})}),e.jsx(j,{size:"icon",variant:"outline",onClick:()=>Fe(s.id),disabled:l,className:"h-8 w-8 hover-scale text-red-500 hover:bg-red-500/10 hover:border-red-500/20",children:e.jsx(Oe,{className:"h-4 w-4"})})]})]},s.id))})]})]})})]})]})]})})}export{vs as default};
